<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>DRA&amp;PHO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="explore">
<meta property="og:type" content="website">
<meta property="og:title" content="DRA&amp;PHO">
<meta property="og:url" content="https://draapho.github.io/Blog/page/10/index.html">
<meta property="og:site_name" content="DRA&amp;PHO">
<meta property="og:description" content="explore">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="draapho">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/Blog/atom.xml" title="DRA&PHO" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/Blog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/Blog/css/style.css">

  
    
<link rel="stylesheet" href="/Blog/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/Blog/" id="logo">DRA&amp;PHO</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/Blog/" id="subtitle">thinking &amp; logging</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/Blog/">Home</a>
        
          <a class="main-nav-link" href="/Blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/Blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://draapho.github.io/Blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-1703-linux-command" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2017/01/19/1703-linux-command/" class="article-date">
  <time class="dt-published" datetime="2017-01-18T13:00:00.000Z" itemprop="datePublished">2017-01-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2017/01/19/1703-linux-command/">Unix/Linux 命令参考</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><em><strong>转载自 <a target="_blank" rel="noopener" href="https://linuxtoy.org/pages/download.html">Unix/Linux 命令速查表</a></strong></em></p>
<hr>
<h1 id="搜索指令-find-grep"><a href="#搜索指令-find-grep" class="headerlink" title="搜索指令 find grep"></a>搜索指令 <code>find</code> <code>grep</code></h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find -name april*                   <span class="comment"># 当前目录下查找以april开始的文件</span></span><br><span class="line">find -iname april*                  <span class="comment"># 忽略大小写</span></span><br><span class="line">find /home -size +512k              <span class="comment"># 查大于512k的文件</span></span><br><span class="line">find /home -size -512k              <span class="comment"># 查小于512k的文件</span></span><br><span class="line">find /home -links +2                <span class="comment"># 查硬连接数大于2的文件或目录</span></span><br><span class="line">find /home -perm 0700               <span class="comment"># 查权限为700的文件或目录</span></span><br><span class="line"></span><br><span class="line">find -name tom.txt -user kim        <span class="comment"># 查找名称为tom.txt且用户为kim的文件</span></span><br><span class="line">find -name ap* -or -name may*       <span class="comment"># 查找以ap或may开头的文件</span></span><br><span class="line">find -name wa* -not -<span class="built_in">type</span> l         <span class="comment"># 查找名为wa开头且类型不为符号链接的文件</span></span><br><span class="line">find -name wa* ! -<span class="built_in">type</span> l            <span class="comment"># 查找名为wa开头且类型不为符号链接的文件</span></span><br><span class="line"><span class="comment"># 对于 -type, 有 b=block, d=dictory, c=character, p=pipe, l=link, f=file</span></span><br><span class="line"></span><br><span class="line">find / -iname <span class="string">&quot;MyCProgram.c&quot;</span> -<span class="built_in">exec</span> md5sum &#123;&#125; \; <span class="comment"># 对所有找到的文件进行MD5验证</span></span><br><span class="line">find / -name filename -ok rm -rf &#123;&#125; \;          <span class="comment"># 确认删除找到的文件</span></span><br><span class="line">find . -mtime +3 | xargs rm -rf                 <span class="comment"># 删除3天以前的文件</span></span><br><span class="line">find . -size +3000k -<span class="built_in">exec</span> ls -ld &#123;&#125; \;          <span class="comment"># 查找大于3M的文件</span></span><br><span class="line">find . -size -3000k | xargs <span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt;./file.log <span class="comment"># 查找小于3M的文件并写入file.log</span></span><br><span class="line">find . -<span class="built_in">type</span> f | xargs grep <span class="string">&quot;hostname&quot;</span>          <span class="comment"># 在普通文件中搜索hostname这个词</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls -l | grep <span class="string">&#x27;^a&#x27;</span>                   <span class="comment"># 只显示以a开头的文件名。</span></span><br><span class="line">grep <span class="string">&#x27;test&#x27;</span> d*                      <span class="comment"># 显示所有以d开头的文件中包含test的行。</span></span><br><span class="line">grep <span class="string">&#x27;test&#x27;</span> aa bb cc                <span class="comment"># 显示在aa，bb，cc文件中匹配test的行。</span></span><br><span class="line">grep -i pattern files               <span class="comment"># 不区分大小写地搜索。默认情况区分大小写</span></span><br><span class="line">grep -l pattern files               <span class="comment"># 只列出匹配的文件名，</span></span><br><span class="line">grep -L pattern files               <span class="comment"># 列出不匹配的文件名，</span></span><br><span class="line">grep -w pattern files               <span class="comment"># 只匹配整个单词(如匹配‘magic’，而不是‘magical’)</span></span><br><span class="line">grep -C number pattern files        <span class="comment"># 匹配的上下文分别显示[number]行，</span></span><br><span class="line">grep pattern1 | pattern2 files      <span class="comment"># 显示匹配 pattern1 或 pattern2 的行，</span></span><br><span class="line">grep pattern1 files | grep pattern2 <span class="comment"># 显示既匹配 pattern1 又匹配 pattern2的行</span></span><br></pre></td></tr></table></figure>

<h1 id="常用命令表"><a href="#常用命令表" class="headerlink" title="常用命令表"></a>常用命令表</h1><table>
<thead>
<tr>
<th>文件命令</th>
<th>指令说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>ls</code></td>
<td>列出目录</td>
</tr>
<tr>
<td><code>ls -al</code></td>
<td>使用格式化列出隐藏文件</td>
</tr>
<tr>
<td><code>cd dir</code></td>
<td>更改目录到 dir</td>
</tr>
<tr>
<td><code>cd</code></td>
<td>更改到 home 目录</td>
</tr>
<tr>
<td><code>pwd</code></td>
<td>显示当前目录</td>
</tr>
<tr>
<td><code>mkdir dir</code></td>
<td>创建目录 dir</td>
</tr>
<tr>
<td><code>rm file</code></td>
<td>删除 file</td>
</tr>
<tr>
<td><code>rm -r dir</code></td>
<td>删除目录 dir</td>
</tr>
<tr>
<td><code>rm -f file</code></td>
<td>强制删除 file</td>
</tr>
<tr>
<td><code>rm -rf dir</code></td>
<td>强制删除整个目录 dir (小心使用)</td>
</tr>
<tr>
<td><code>cp file1 file2</code></td>
<td>将 file1 复制到 file2</td>
</tr>
<tr>
<td><code>cp -r dir1 dir2</code></td>
<td>将 dir1 复制到 dir2; 如果 dir2 不存在则创建它</td>
</tr>
<tr>
<td><code>mv file1 file2</code></td>
<td>将 file1 重命名或移动到 file2;</td>
</tr>
<tr>
<td><code>ln -s file link</code></td>
<td>创建 file 的符号连接 link</td>
</tr>
<tr>
<td><code>touch file</code></td>
<td>创建 file</td>
</tr>
<tr>
<td><code>cat &gt; file</code></td>
<td>将标准输入添加到 file</td>
</tr>
<tr>
<td><code>more file</code></td>
<td>查看 file 的内容</td>
</tr>
<tr>
<td><code>head file</code></td>
<td>查看 file 的前 10 行</td>
</tr>
<tr>
<td><code>tail file</code></td>
<td>查看 file 的后 10 行</td>
</tr>
<tr>
<td><code>tail -f file</code></td>
<td>从后 10 行开始查看 file 的内容</td>
</tr>
<tr>
<td><strong>进程管理</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>ps</code></td>
<td>显示当前的活动进程</td>
</tr>
<tr>
<td><code>top</code></td>
<td>显示所有正在运行的进程</td>
</tr>
<tr>
<td><code>kill pid</code></td>
<td>杀掉进程 id pid</td>
</tr>
<tr>
<td><code>killall proc</code></td>
<td>杀掉所有名为 proc 的进程 (小心使用)</td>
</tr>
<tr>
<td><code>bg</code></td>
<td>列出已停止或后台的作业</td>
</tr>
<tr>
<td><code>fg</code></td>
<td>将最近的作业带到前台</td>
</tr>
<tr>
<td><code>fg n</code></td>
<td>将作业 n 带到前台</td>
</tr>
<tr>
<td><strong>文件权限</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>chmod rwxrwxrwx file</code></td>
<td>更改 file 的权限</td>
</tr>
<tr>
<td><code>chmod 777</code></td>
<td>为所有用户添加 rwx 权限</td>
</tr>
<tr>
<td><code>chmod 755</code></td>
<td>为所有者添加 rwx 权限, 为组和其他用户添加 rx 权限</td>
</tr>
<tr>
<td><strong>SSH</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>ssh user@host</code></td>
<td>以 user 用户身份连接到 host</td>
</tr>
<tr>
<td><code>ssh -p port user@host</code></td>
<td>在端口 port 以 user 用户身份连接到 host</td>
</tr>
<tr>
<td><code>ssh-copy-id user@host</code></td>
<td>将密钥添加到 host 以实现无密码登录</td>
</tr>
<tr>
<td><strong>系统信息</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>date</code></td>
<td>显示当前日期和时间</td>
</tr>
<tr>
<td><code>cal</code></td>
<td>显示当月的日历</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td>显示系统从开机到现在所运行的时间</td>
</tr>
<tr>
<td><code>w</code></td>
<td>显示登录的用户</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>查看你的当前用户名</td>
</tr>
<tr>
<td><code>finger user</code></td>
<td>显示 user 的相关信息</td>
</tr>
<tr>
<td><code>uname -a</code></td>
<td>显示内核信息</td>
</tr>
<tr>
<td><code>cat /proc/cpuinfo</code></td>
<td>查看 cpu 信息</td>
</tr>
<tr>
<td><code>cat /proc/meminfo</code></td>
<td>查看内存信息</td>
</tr>
<tr>
<td><code>man command</code></td>
<td>显示 command 的说明手册</td>
</tr>
<tr>
<td><code>df</code></td>
<td>显示磁盘占用情况</td>
</tr>
<tr>
<td><code>du</code></td>
<td>显示目录空间占用情况</td>
</tr>
<tr>
<td><code>free</code></td>
<td>显示内存及交换区占用情况</td>
</tr>
<tr>
<td><strong>压缩</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>tar cf file.tar files</code></td>
<td>创建包含 files 的 tar 文件 file.tar</td>
</tr>
<tr>
<td><code>tar xf file.tar</code></td>
<td>从 file.tar 提取文件</td>
</tr>
<tr>
<td><code>tar czf file.tar.gz files</code></td>
<td>使用 Gzip 压缩创建 tar 文件</td>
</tr>
<tr>
<td><code>tar xzf file.tar.gz</code></td>
<td>使用 Gzip 提取 tar 文件</td>
</tr>
<tr>
<td><code>tar cjf file.tar.bz2</code></td>
<td>使用 Bzip2 压缩创建 tar 文件</td>
</tr>
<tr>
<td><code>tar xjf file.tar.bz2</code></td>
<td>使用 Bzip2 提取 tar 文件</td>
</tr>
<tr>
<td><code>gzip file</code></td>
<td>压缩 file 并重命名为 file.gz</td>
</tr>
<tr>
<td><code>gzip -d file.gz</code></td>
<td>将 file.gz 解压缩为 file</td>
</tr>
<tr>
<td><strong>网络</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>ping host</code></td>
<td>ping host 并输出结果</td>
</tr>
<tr>
<td><code>whois domain</code></td>
<td>获取 domain 的 whois 信息</td>
</tr>
<tr>
<td><code>dig domain</code></td>
<td>获取 domain 的 DNS 信息</td>
</tr>
<tr>
<td><code>dig -x host</code></td>
<td>逆向查询 host</td>
</tr>
<tr>
<td><code>wget file</code></td>
<td>下载 file</td>
</tr>
<tr>
<td><code>wget -c file</code></td>
<td>断点续传</td>
</tr>
<tr>
<td><strong>安装</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>./configure</code> <code>make</code> <code>make install</code></td>
<td>从源码安装</td>
</tr>
<tr>
<td><code>dpkg -i pkg.deb</code></td>
<td>安装包 (Debian)</td>
</tr>
<tr>
<td><code>rpm -Uvh pkg.rpm</code></td>
<td>安装包 (RPM)</td>
</tr>
<tr>
<td><code>yum install package</code></td>
<td>安装包 (CentOS)</td>
</tr>
<tr>
<td><code>sudo apt-get install package</code></td>
<td>安装包 (Ubuntu)</td>
</tr>
<tr>
<td><strong>快捷键</strong></td>
<td><strong>指令说明</strong></td>
</tr>
<tr>
<td><code>Ctrl+C</code></td>
<td>停止当前命令</td>
</tr>
<tr>
<td><code>Ctrl+Z</code></td>
<td>停止当前命令，并使用 fg 恢复</td>
</tr>
<tr>
<td><code>Ctrl+D</code></td>
<td>注销当前会话，与 exit 相似</td>
</tr>
<tr>
<td><code>Ctrl+W</code></td>
<td>删除当前行中的字</td>
</tr>
<tr>
<td><code>Ctrl+U</code></td>
<td>删除整行</td>
</tr>
<tr>
<td><code>!!</code></td>
<td>重复上次的命令</td>
</tr>
<tr>
<td><code>exit</code></td>
<td>注销当前会话</td>
</tr>
</tbody></table>
<hr>
<p><em><strong>转载自 <a target="_blank" rel="noopener" href="https://linuxtoy.org/pages/download.html">Unix/Linux 命令速查表</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2017/01/19/1703-linux-command/" data-id="cklzzbo9y002l3wqo0mupaz1s" data-title="Unix/Linux 命令参考" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/cheat-sheet/" rel="tag">cheat sheet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/embedded/" rel="tag">embedded</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1702-linux-hard" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2017/01/18/1702-linux-hard/" class="article-date">
  <time class="dt-published" datetime="2017-01-17T13:00:00.000Z" itemprop="datePublished">2017-01-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/embedded-linux/">embedded linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2017/01/18/1702-linux-hard/">Embedded Linux 入门有感</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Embedded Linux 是自我学习过程中, 走的最不顺的一条路.<br>而学习android和python时, 基本自学一个月左右, 就能开始独立做项目了.<br>应该说, Embedded Linux的入门确实比较困难一点.</p>
<p>自己是从底层往上走的, 系统的学过硬件, 嵌入式, 操作系统,<br>但在没有具体项目要求的情况下, 学习Embedded Linux的过程充满了痛苦和不解, 始终没有坚持下来.</p>
<p>如今, 打算再次开始系统的学习Embedded Linux, 因而在此记录一下之前的学习感受, 分析一下困难之所在, 并制定好学习规则和方式.</p>
<h1 id="为何困难"><a href="#为何困难" class="headerlink" title="为何困难"></a>为何困难</h1><h2 id="linux上手困难"><a href="#linux上手困难" class="headerlink" title="linux上手困难"></a>linux上手困难</h2><p>对新手而言, linux的学习曲线很陡峭. 相信刚上手的话, 如何安装软件, 如何使用编辑器都是问题!</p>
<p>一个, 二个问题或者一层二层问题, 还能较为容易的解决. 但面对蜂拥而至的疑问和困惑, 能坚持下去就很不容易了, 何况途中还充满了陷阱和争论.</p>
<p>随便举几个例子:</p>
<ol>
<li><p>用哪个版本的linux好? Ubuntu? Feroda? Redhat? CentOS? 服务器版? 桌面版? 然后图形界面居然还分 KDE/Gnome…<br>为了弄清上面这个问题, 看看文章, 翻翻论坛, 结果就是更迷糊了… 甚至忘了初衷是要奔着 <code>Embedded Linux</code> 去的啊!</p>
</li>
<li><p>我的硬盘分区呢? 去哪里找文件呢? 文件权限的概念等等. (linux下一切皆文件!)</p>
</li>
<li><p>用哪个文本编辑器好? 大家都会说Vim, 然后和vim斗就能斗你一个月, 结果还是自己败下阵来, 回归熟悉的文本编辑器!</p>
</li>
<li><p><code>bash shell</code> 是精华啊, 不能不学! 得, 捧着鸟哥的私房菜, 随便翻翻也得几星期才知道个大概吧…<br>(学习指令时, 需要有<code>工作路径</code>这么一个概念. 知道这个指令现在在哪里工作, 是非常重要的一个概念!)</p>
</li>
<li><p>唉呀妈呀, 好不容易装好了虚拟机, 装好了精挑细选的linux版本. 尝试装软件了! 一阵搜索, 还算顺利. 突然出了个依赖关系错误…<br>耐着性子google, 百度, 似乎略微看懂了一二, 就是在装这个软件之前, 需要另外一个软件的特定版本么.<br>尝试用安装指令装另外一个软件, 居然这个软件不存在了!!! 继续? 还是放弃?<br>我继续过, 翻墙, 找到软件源码. 还要自己编译? 编译还要装编译软件… 彻底放弃…</p>
</li>
</ol>
<h2 id="缺乏合适的入门书籍"><a href="#缺乏合适的入门书籍" class="headerlink" title="缺乏合适的入门书籍"></a>缺乏合适的入门书籍</h2><p>市面上大多数的Embedded Linux入门教程只讲应该如何做, 不说基础知识, 不讲前因后果.<br>读起来枯燥无味, 索然无趣. 学起来一头雾水, 不知其所以然.</p>
<p>譬如很多教程会详细的写出, 第一步, 第二步, 第三步… 但经常的, 只要系统环境稍微变化一点点(如linux版本不同, 软件版本不同), 上述的步骤就会失效.<br>喜欢刨根问底的我就开始纠结这些第一步, 第二步, 第三步到底再干吗? 为什么按照自己的理解在新的环境下就不工作了?<br>而遇到这些具体的困难时, 如何解决困难真的是一头雾水. 教程书籍类基本不会讲你可能遇到的问题! 基本只能到网络上去找解决办法…然后就是进一步的困惑…</p>
<p>而更专业的书籍根本不适合入门者去阅读, 那都是对特定领域进行深入分析学习的! 过早的接触自己完全不懂的东西, 只会打击学习的积极性.<br>譬如推崇度很高的鸟哥的私房菜, 实际是一本很好的运维方面的书籍, 用它来初学<code>bash shell</code>就太重了.<br>可以看一下鸟哥自己的经历, 就能明白了 <a target="_blank" rel="noopener" href="http://linux.vbird.org/new_linux.php">Linux 的學習曲線，一個老人家的建議！</a><br>体验最深的就是这句了: <strong>只要一出现问题, 自己完全无法解决时, 只好重新安装, 选择设定与书本教的内容完全一模一样, 不过即使如此, 很多时候仍然会遇到问题</strong></p>
<p>因此, 建议自己通过网络和书籍总结归纳一下最基本的指令和用法, 加之自己的理解, 做成笔记. 一来帮助记忆, 二来便于日后查阅.<br>但不用刻意的去背这些东西, 要用的时候知道去哪里查阅就可以了, 用多了既然就记住了.<br>在真正深入学习后, 觉得有需要自然会更有针对性的选择专业书籍来看!</p>
<p>这样, 才能避免淹死在知识的海洋里!</p>
<h2 id="缺乏硬性目标"><a href="#缺乏硬性目标" class="headerlink" title="缺乏硬性目标:"></a>缺乏硬性目标:</h2><p>之前都是跟着教程的自学, 属于漫无目的的囫囵吞枣, 学到哪忘到哪.<br>然后, <strong>缺乏硬性目标最大的问题就是: 容易放弃!</strong><br>因为遇到的困难太多了, 在没有硬性目标的情况下, 不断的打击最终导致的就是放弃!</p>
<p>如果能定一个最终目标, 譬如基于开发板做一款视频识别系统, 那在学习过程中就会有侧重点.<br>这样对问题的处理就能起到抓大放小, 不纠结于所有的细节. 在解决实际问题的过程中, 逐步深入学习linux.</p>
<h1 id="解决之道"><a href="#解决之道" class="headerlink" title="解决之道"></a>解决之道</h1><p>个人认为, 学习linux, embedded linux的终极解决之道就是定下一个<strong>硬性目标</strong>, 有这么一个压力在的话, 在学习过程中不断试错, 一知半解都不是问题!</p>
<p>正所谓有压力才有动力! 回到鸟哥的个人经历, 见<a target="_blank" rel="noopener" href="http://linux.vbird.org/new_linux.php">Linux 的學習曲線，一個老人家的建議！</a>.<br>正是有项目压力的情况下, 才能忍受无数次的重装系统, 才能忍无可忍痛下决心系统的学习linux(此时已经不是初学者了, 知道了很多基础, 也知道自己想解决什么问题!)<br>在此压力下, 搭建环境的过程就不会过于纠结我到底在干吗? 为什么要这么做?的困惑; 使用编辑器时, 也会直接挑个最顺手的用着再说; shell的使用也会因为时间压力只学最基本的.</p>
<p>初期, 在一定要完成这个硬性目标, 在不求甚解, 能用就好的心态下, 至少能帮助自己摸一遍linux, 知道一个大概的流程和遇到的问题.<br>这样也能很大程度上避免自己陷入到底用哪个linux版本好, 用哪个桌面系统好, 用哪种编辑好的争论中! 在不知道具体需求的情况下, 这些都是无意义之事!<br>这个时期, 坚持学下来, 用下来, 就是胜利! 工具的选择上, 顺手的, 上手快的就是好的!</p>
<p>然后, 在完成一二个项目后, 虽然心中的疑惑越积越多, 但潜移默化中, 已经对linux有了相当程度的理解, 常用指令也都会用了!<br>此时, 再根据自己的具体疑惑去查阅更专业的书籍, 更系统的学习, 其效果会远好于上来就拿着本专业书籍看!</p>
<h1 id="自我要求"><a href="#自我要求" class="headerlink" title="自我要求"></a>自我要求</h1><p>我目前的情况也不能算linux初学者, 但也确实没有在embedded linux下开发的经验.<br>自己的感觉是, 虽然对某些方面还一知半解, 但背景知识的储备已经够了, 是时候定个小目标, 完成系统的学习了!<br>毕业已10年, 我学习linux的初学期和倦怠期也着实太长了一点… 好在, 任何时候开始都不晚么.</p>
<p>陆续了解过的背景知识有: linux基础概念, ubuntu的基础使用, bash shell, 硬件原理图, 嵌入式C开发, 操作系统原理, 阅读linux0.11源码.<br>总的来说, 感觉自己就差临门一脚… 能坚持做一二个项目后, 自己就有能力做嵌入式linux开发了.</p>
<ul>
<li>定个小目标: 跟着教程, 在2440开发板上, 完成音视频对讲功能. 细分为实现摄像头功能, 搭建服务器, 实现可视对讲功能.</li>
<li>开发环境搭建: 最困难的就是环境搭建, 走了很多弯路, 不过目前已经走通了.</li>
<li>不求甚解: 学习过程中, 注意连续性, 有些专业知识先不求甚解, 有个基础概念, 简单做下笔记即可. 如makefile的书写, 编译器原理等等.</li>
<li>勤做笔记: 好记性不如烂笔头. 我相信即便linux高度使用者, 能记住的也就几条常用指令. 自己做好笔记就便于日后查阅, 做笔记的同时也加深了印象!</li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2017/01/18/1702-linux-hard/" data-id="cklzzbo9x002i3wqohfvw9k4i" data-title="Embedded Linux 入门有感" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/embedded-linux/" rel="tag">embedded linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1701-python-list-dict" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2017/01/03/1701-python-list-dict/" class="article-date">
  <time class="dt-published" datetime="2017-01-02T13:00:00.000Z" itemprop="datePublished">2017-01-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2017/01/03/1701-python-list-dict/">Python 列表和字典的常见操作</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="list"><a href="#list" class="headerlink" title="list []"></a>list <code>[]</code></h1><p>list是一种有序的集合，可以随时添加和删除其中的元素。 形式和特性都像C语言的数组</p>
<h2 id="赋值修改及取值"><a href="#赋值修改及取值" class="headerlink" title="赋值修改及取值"></a>赋值修改及取值</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># list 赋值</span></span><br><span class="line">l = <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>,<span class="number">2</span>)   <span class="comment"># l = [1,3,5,7]      9是不包含在里面的</span></span><br><span class="line">l = [<span class="number">1</span>,<span class="number">3</span>]*<span class="number">3</span>        <span class="comment"># l = [1,3,1,3,1,3]  *表示重复次数</span></span><br><span class="line">l = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用切片 (同字符串用法)</span></span><br><span class="line">l[<span class="number">0</span>]        <span class="comment"># 1                 显示第一个元素</span></span><br><span class="line">l[-<span class="number">1</span>]       <span class="comment"># 5                 显示最后一个元素</span></span><br><span class="line">l[<span class="number">0</span>:<span class="number">2</span>]      <span class="comment"># [1, 2]            显示0,1两个元素</span></span><br><span class="line">l[-<span class="number">2</span>:]      <span class="comment"># [4, 5]            显示最后二个元素</span></span><br><span class="line">l[::-<span class="number">1</span>]     <span class="comment"># [5, 4, 3, 2, 1]   步进-1, 就是倒序了</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用切片修改元素</span></span><br><span class="line">l[<span class="number">0</span>] = <span class="number">3</span>        <span class="comment"># [3, 2, 3, 4, 5]       修改l[0]的值</span></span><br><span class="line"><span class="comment"># l[1] = [7,8]  # [3, [7, 8], 3, 4, 5]  修改为list表, 存储其指针. 注意和 l[1:2] = [7,8] 的本质区别!</span></span><br><span class="line">l[<span class="number">1</span>:<span class="number">2</span>] = [<span class="number">7</span>,<span class="number">8</span>]  <span class="comment"># [3, 7, 8, 3, 4, 5]    将l[1]修改为元素[7,8]</span></span><br><span class="line">l[<span class="number">1</span>:<span class="number">3</span>] = []     <span class="comment"># [3, 2, 3, 4, 5]       删除1-2的元素</span></span><br><span class="line">l[<span class="number">1</span>:<span class="number">1</span>] = [<span class="number">7</span>,<span class="number">8</span>,<span class="number">2</span>]<span class="comment"># [3, 7, 8, 2, 3, 4, 5] 在l[1]处插入元素[7,8,2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取长度</span></span><br><span class="line"><span class="built_in">len</span>(l)      <span class="comment"># 7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">l.sort()    <span class="comment"># l=[2, 3, 3, 4, 5, 7, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取元素出现的个数</span></span><br><span class="line">l.count(<span class="number">3</span>)  <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for循环取索引和值, 使用enumerate</span></span><br><span class="line"><span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(l):</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i, x)         <span class="comment"># i为index, x为list的值</span></span><br></pre></td></tr></table></figure>


<h2 id="增减元素"><a href="#增减元素" class="headerlink" title="增减元素"></a>增减元素</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l = [<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增减元素</span></span><br><span class="line">l.append(<span class="string">&#x27;Adam&#x27;</span>)    <span class="comment"># 追加元素到末尾,    l=[&#x27;John&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line">l.insert(<span class="number">1</span>, <span class="string">&#x27;Jack&#x27;</span>) <span class="comment"># 在索引1处插入元素, l=[&#x27;John&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line">l[<span class="number">1</span>:<span class="number">1</span>]=[<span class="string">&quot;Jack&quot;</span>]     <span class="comment"># 在索引1处插入元素, l=[&#x27;John&#x27;, &#x27;Jack&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删减元素</span></span><br><span class="line">l.remove(<span class="string">&quot;Jack&quot;</span>)    <span class="comment"># 删除第一次出现的该元素, l=[&#x27;John&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line">l.pop()             <span class="comment"># 返回并删除末尾的元素,   l=[&#x27;John&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">l.pop(<span class="number">1</span>)            <span class="comment"># 返回并删除索引1的元素,  l=[&#x27;John&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line"><span class="keyword">del</span> l[<span class="number">0</span>]            <span class="comment"># 删除索引0的元素,       l=[&#x27;Bob&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line"><span class="keyword">del</span> l[<span class="number">0</span>:<span class="number">2</span>]          <span class="comment"># 删除多个元素,          l=[]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表扩展/叠加</span></span><br><span class="line">l1=[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]; l2=[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">l=<span class="built_in">list</span>(<span class="built_in">set</span>(l1+l2))  <span class="comment"># l=[1,2,3,4,5], 避免了重复元素, 但会丢失原有的排序!</span></span><br><span class="line">l=l1+l2             <span class="comment"># l=[3,2,1,3,4,5], 简单的叠加, 非常直观!</span></span><br></pre></td></tr></table></figure>


<h2 id="拷贝-浅拷贝-深拷贝"><a href="#拷贝-浅拷贝-深拷贝" class="headerlink" title="拷贝(浅拷贝, 深拷贝)"></a>拷贝(浅拷贝, 深拷贝)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l = [[<span class="string">&#x27;a&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], [<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 别名及浅拷贝</span></span><br><span class="line">l1 = l              <span class="comment"># l1为l的别名/指针, 指向相同的地址. (l is l1 = True)</span></span><br><span class="line">l1 = l[:]           <span class="comment"># 浅拷贝(只拷贝一维的数据). (l is l1 = False. l[0] is l1[0] = True)</span></span><br><span class="line"><span class="comment"># 在此例中, 由于是浅拷贝, 因此修改元素如 l[0][0]=&#x27;z&#x27; 后, l1显示内容会和l一样.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝</span></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">l1 = copy.deepcopy(l)   <span class="comment"># 深拷贝(遇到指针类型继续深挖). (l is l1 = False. l[0] is l1[0] = False)</span></span><br><span class="line"><span class="comment"># 在此例中, l1 和 l 再无任何关联</span></span><br></pre></td></tr></table></figure>


<h1 id="tuple"><a href="#tuple" class="headerlink" title="tuple ()"></a>tuple <code>()</code></h1><p>理解为list的常量形式即可, 赋值后就不可增减和修改</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 赋值</span></span><br><span class="line">t = (<span class="number">1</span>,<span class="number">2</span>)   <span class="comment"># 赋值2个元素</span></span><br><span class="line">t = (<span class="number">1</span>,)    <span class="comment"># 赋值1个元素时, 必须加上逗号, 避免误解</span></span><br><span class="line">t = (<span class="number">1</span>,<span class="number">3</span>)*<span class="number">3</span>        <span class="comment"># t = (1,3,1,3,1,3)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取值, 使用切片即可</span></span><br><span class="line">t[-<span class="number">1</span>]       <span class="comment"># 取最后一个值, 3</span></span><br><span class="line">t[<span class="number">0</span>::<span class="number">2</span>]     <span class="comment"># 跳着取值, (1,1,1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取长度</span></span><br><span class="line"><span class="built_in">len</span>(t)      <span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取元素出现的个数</span></span><br><span class="line">t.count(<span class="number">1</span>)  <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># list 与 tuple 互相转换</span></span><br><span class="line">l = <span class="built_in">list</span>(t) <span class="comment"># 把tuple变为list</span></span><br><span class="line">t = <span class="built_in">tuple</span>(l)<span class="comment"># 把list变为tuple</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拷贝的问题同list</span></span><br></pre></td></tr></table></figure>



<h1 id="dict"><a href="#dict" class="headerlink" title="dict {}"></a>dict <code>&#123;&#125;</code></h1><p>dict全称dictionary，在其他语言中也称为map，使用键-值（key-value）存储，具有极快的查找速度。</p>
<h2 id="赋值及取值"><a href="#赋值及取值" class="headerlink" title="赋值及取值"></a>赋值及取值</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># dict 赋值</span></span><br><span class="line">d = &#123;<span class="string">&#x27;Michael&#x27;</span>: <span class="number">95</span>, <span class="string">&#x27;Bob&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;Tracy&#x27;</span>: <span class="number">85</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取值</span></span><br><span class="line">d[<span class="string">&#x27;Thomas&#x27;</span>]             <span class="comment"># 不存在会报错</span></span><br><span class="line">d.get(<span class="string">&#x27;Thomas&#x27;</span>, -<span class="number">1</span>)     <span class="comment"># 不存在返回设定的默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断键值</span></span><br><span class="line"><span class="string">&#x27;Michael&#x27;</span> <span class="keyword">in</span> d          <span class="comment"># in方法即可, 返回True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 键值个数</span></span><br><span class="line"><span class="built_in">len</span>(d)                  <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取key和value</span></span><br><span class="line">d.keys()                <span class="comment"># 关键字列表, [&#x27;Bob&#x27;, &#x27;Michael&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">d.values()              <span class="comment"># 字典值列表, [75, 95, 85]</span></span><br><span class="line">d.items()               <span class="comment"># 转换为列表, [(&#x27;Bob&#x27;, 75), (&#x27;Michael&#x27;, 95), (&#x27;Tracy&#x27;, 85)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for循环取索引和值, 使用iteritems</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> d.iteritems():</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#123;&#125;: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(k, v)         <span class="comment"># k为key, v为value值</span></span><br></pre></td></tr></table></figure>

<h2 id="增减及修改字典"><a href="#增减及修改字典" class="headerlink" title="增减及修改字典"></a>增减及修改字典</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = &#123;<span class="string">&#x27;Michael&#x27;</span>: <span class="number">95</span>, <span class="string">&#x27;Bob&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;Tracy&#x27;</span>: <span class="number">85</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改值 (如果key不存在, 变成增加元素)</span></span><br><span class="line">d[<span class="string">&#x27;Michael&#x27;</span>] = <span class="number">88</span>       <span class="comment"># d=&#123;&#x27;Bob&#x27;: 75, &#x27;Michael&#x27;: 88, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加值</span></span><br><span class="line">d[<span class="number">0</span>] = <span class="number">0</span>                <span class="comment"># d=&#123;0: 0, &#x27;Bob&#x27;: 75, &#x27;Michael&#x27;: 88, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除一个键值</span></span><br><span class="line">d.pop(<span class="number">0</span>)                <span class="comment"># 返回value并删除键值    d=&#123;&#x27;Bob&#x27;: 75, &#x27;Michael&#x27;: 95, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line">d.popitem()             <span class="comment"># 返回value并删除首键值  d=&#123;&#x27;Michael&#x27;: 95, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line"><span class="keyword">del</span> d[<span class="number">0</span>]                <span class="comment"># 删除键值              d=&#123;&#x27;Michael&#x27;: 95, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> d: <span class="keyword">del</span> d[<span class="number">0</span>]     <span class="comment"># 避免报错的写法         d=&#123;&#x27;Michael&#x27;: 95, &#x27;Tracy&#x27;: 85&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除整个字典</span></span><br><span class="line">d.clear()               <span class="comment"># 清空字典, d变成空字典   d=&#123;&#125;</span></span><br><span class="line"><span class="keyword">del</span> d                   <span class="comment"># 删除了d这个字典</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并字典</span></span><br><span class="line">x = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;; y = &#123;<span class="string">&#x27;b&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">4</span>&#125;</span><br><span class="line">z = x.copy()            <span class="comment"># 字典拷贝              z = &#123;&#x27;a&#x27;: 1, &#x27;b&#x27;: 2&#125;</span></span><br><span class="line">z.update(y)             <span class="comment"># 字典合并(新值覆盖旧值)  z = &#123;&#x27;a&#x27;: 1, &#x27;c&#x27;: 4, &#x27;b&#x27;: 3&#125;</span></span><br><span class="line"><span class="comment"># z = &#123;**x, **y&#125;        # python 3.5以上, 可以直接使用</span></span><br></pre></td></tr></table></figure>


<h2 id="拷贝-浅拷贝-深拷贝-1"><a href="#拷贝-浅拷贝-深拷贝-1" class="headerlink" title="拷贝(浅拷贝, 深拷贝)"></a>拷贝(浅拷贝, 深拷贝)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = &#123;<span class="number">0</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="number">1</span>:&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意, d.update(), d.copy() 都是浅拷贝!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 别名及浅拷贝</span></span><br><span class="line">d1 = d                  <span class="comment"># l1为l的别名/指针, 指向相同的地址. (d is d1 = True)</span></span><br><span class="line">d1 = d.copy()           <span class="comment"># 浅拷贝(只拷贝一维的数据). (d is d1 = False. d[0] is d1[0] = True)</span></span><br><span class="line"><span class="comment"># 设置 d[0][0] = 3; d[1][&quot;k2&quot;]=2 后, 会发现d1的值也跟着变了. 因为浅拷贝值拷贝一维的数据(指针).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝</span></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">d1 = copy.deepcopy(d)   <span class="comment"># 深拷贝(遇到指针类型继续深挖). (d is d1 = False. d[0] is d1[0] = False)</span></span><br><span class="line"><span class="comment"># d 和 d1 再无任何瓜葛</span></span><br></pre></td></tr></table></figure>


<h1 id="set-set"><a href="#set-set" class="headerlink" title="set {} set([])"></a>set <code>&#123;&#125;</code> <code>set([])</code></h1><p>set即集合, 是一组key的集合，但不存储value。由于key不能重复，所以，在set中，没有重复的key。<br>集合不可放入可变对象, 如list(报<code>unhashable type</code>的错)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 赋值</span></span><br><span class="line">s = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;               <span class="comment"># s = set([1, 2, 3])</span></span><br><span class="line">s = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>&#125;      <span class="comment"># s = set([1, 2, 3]), 重复元素会被过滤掉</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查元素是否存在</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">in</span> s                      <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加元素</span></span><br><span class="line">s.add(<span class="number">4</span>)                    <span class="comment"># s = set([1, 2, 3, 4])</span></span><br><span class="line">s.add(<span class="number">4</span>)                    <span class="comment"># 重复增加不会报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除元素</span></span><br><span class="line">s.remove(<span class="number">4</span>)                 <span class="comment"># s = set([1, 2, 3])</span></span><br><span class="line"><span class="keyword">if</span> <span class="number">4</span> <span class="keyword">in</span> s: s.remove(<span class="number">4</span>)      <span class="comment"># 避免报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 集合的运算符号</span></span><br><span class="line">s1 = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;; s2 = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">s1 &amp; s2                     <span class="comment"># 交集    set([2, 3])</span></span><br><span class="line">s1 | s2                     <span class="comment"># 并集    set([1, 2, 3, 4])</span></span><br><span class="line">s1 ^ s2                     <span class="comment"># 补集    set([1, 4])</span></span><br><span class="line">s1 - s2                     <span class="comment"># 减法    set([1])</span></span><br><span class="line">s2 - s1                     <span class="comment"># 减法    set([4])</span></span><br></pre></td></tr></table></figure>



<h1 id="collections模块的使用"><a href="#collections模块的使用" class="headerlink" title="collections模块的使用"></a>collections模块的使用</h1><h2 id="numedtuple-给tuple命名"><a href="#numedtuple-给tuple命名" class="headerlink" title="numedtuple 给tuple命名"></a>numedtuple 给tuple命名</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Point = collections.namedtuple(<span class="string">&#x27;Point&#x27;</span>, [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Point(<span class="number">1.0</span>, <span class="number">2.0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.x; p.y; p             <span class="comment"># 也可以使用p[0], p[1]</span></span><br><span class="line"><span class="number">1.0</span></span><br><span class="line"><span class="number">2.0</span></span><br><span class="line">Point(x=<span class="number">1.0</span>, y=<span class="number">2.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = p._replace(x = <span class="number">1.5</span>, y= <span class="number">1.1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p[<span class="number">0</span>]; p[<span class="number">1</span>]              <span class="comment"># 等同于 p.x; p.y</span></span><br><span class="line"><span class="number">1.5</span></span><br><span class="line"><span class="number">1.1</span></span><br></pre></td></tr></table></figure>

<h2 id="deque-双向队列"><a href="#deque-双向队列" class="headerlink" title="deque 双向队列"></a>deque 双向队列</h2><p>英文全称 <code>Double-ended queue</code>, 特性近似于双向链表, 适用于队列和栈</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q = collections.deque([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="number">1</span>)             <span class="comment"># q=deque([&#x27;a&#x27;, &#x27;c&#x27;, 1])</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.appendleft(<span class="number">2</span>)         <span class="comment"># q=deque([2, &#x27;a&#x27;, &#x27;c&#x27;, 1])</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.extend([<span class="number">3</span>, <span class="number">4</span>])        <span class="comment"># q=deque([2, &#x27;a&#x27;, &#x27;c&#x27;, 1, 3, 4])</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.extendleft([<span class="number">5</span>, <span class="number">6</span>])    <span class="comment"># q=deque([6, 5, 2, &#x27;a&#x27;, &#x27;c&#x27;, 1, 3, 4])</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pop()                 <span class="comment"># q=deque([6, 5, 2, &#x27;a&#x27;, &#x27;c&#x27;, 1, 3])</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.popleft()             <span class="comment"># q=deque([5, 2, &#x27;a&#x27;, &#x27;c&#x27;, 1, 3])</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.rotate(<span class="number">1</span>)             <span class="comment"># q=deque([3, 5, 2, &#x27;a&#x27;, &#x27;c&#x27;, 1])</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.rotate(-<span class="number">2</span>)            <span class="comment"># q=deque([2, &#x27;a&#x27;, &#x27;c&#x27;, 1, 3, 5])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 限长的双向队列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>last_three = collections.deque([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], maxlen=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>last_three</span><br><span class="line">que([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], maxlen=<span class="number">3</span>)    <span class="comment"># 队列长度最多为3.</span></span><br></pre></td></tr></table></figure>

<h2 id="defaultdict-带默认键值的dict"><a href="#defaultdict-带默认键值的dict" class="headerlink" title="defaultdict 带默认键值的dict"></a>defaultdict 带默认键值的dict</h2><p>使用<code>dict</code>时，如果引用的Key不存在，就会抛出<code>KeyError</code>。如果希望key不存在时，返回一个默认值，就可以用<code>defaultdict</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 普通字典</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = <span class="built_in">dict</span>()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">KeyError: <span class="string">&#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认字典</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = collections.defaultdict(<span class="built_in">int</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = collections.defaultdict(<span class="built_in">str</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = collections.defaultdict(<span class="keyword">lambda</span>: <span class="string">&#x27;N/A&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;N/A&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="OrderedDict-可排序的dict"><a href="#OrderedDict-可排序的dict" class="headerlink" title="OrderedDict 可排序的dict"></a>OrderedDict 可排序的dict</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 普通字典, key是无需的</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = <span class="built_in">dict</span>([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可排序字典, 按照key插入的顺序排序</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od = collections.OrderedDict([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od</span><br><span class="line">OrderedDict([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)])</span><br></pre></td></tr></table></figure>


<p>实现一个FIFO（先进先出）的dict，当容量超出限制时，先删除最早添加的Key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FifoDict</span>(<span class="params">OrderedDict</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, capacity</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(LastUpdatedOrderedDict, self).__init__()</span><br><span class="line">        self._capacity = capacity</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span>(<span class="params">self, key, value</span>):</span></span><br><span class="line">        containsKey = <span class="number">1</span> <span class="keyword">if</span> key <span class="keyword">in</span> self <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self) - containsKey &gt;= self._capacity:</span><br><span class="line">            last = self.popitem(last=<span class="literal">False</span>)</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;remove:&#x27;</span>, last</span><br><span class="line">        <span class="keyword">if</span> containsKey:</span><br><span class="line">            <span class="keyword">del</span> self[key]</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;set:&#x27;</span>, (key, value)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;add:&#x27;</span>, (key, value)</span><br><span class="line">        OrderedDict.__setitem__(self, key, value)</span><br></pre></td></tr></table></figure>

<h2 id="Counter-计数类"><a href="#Counter-计数类" class="headerlink" title="Counter 计数类"></a>Counter 计数类</h2><p><code>Counter</code>实际上是<code>dict</code>的一个子类, 是一个简单的计数器.</p>
<h3 id="应用一-多重集合-显示元素个数"><a href="#应用一-多重集合-显示元素个数" class="headerlink" title="应用一: 多重集合(显示元素个数)"></a>应用一: 多重集合(显示元素个数)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A = collections.Counter([<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B = collections.Counter([<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A; B</span><br><span class="line">Counter(&#123;<span class="number">2</span>: <span class="number">2</span>, <span class="number">1</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A | B</span><br><span class="line">Counter(&#123;<span class="number">2</span>: <span class="number">2</span>, <span class="number">1</span>: <span class="number">1</span>, <span class="number">3</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A &amp; B</span><br><span class="line">Counter(&#123;<span class="number">2</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A + B</span><br><span class="line">Counter(&#123;<span class="number">2</span>: <span class="number">4</span>, <span class="number">1</span>: <span class="number">1</span>, <span class="number">3</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A - B</span><br><span class="line">Counter(&#123;<span class="number">1</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B - A</span><br><span class="line">Counter(&#123;<span class="number">3</span>: <span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="应用二-统计最常出现的元素"><a href="#应用二-统计最常出现的元素" class="headerlink" title="应用二: 统计最常出现的元素"></a>应用二: 统计最常出现的元素</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>A = collections.Counter(<span class="built_in">list</span>(<span class="string">&quot;hello&quot;</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A</span><br><span class="line">Counter(&#123;<span class="string">&#x27;l&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;h&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;e&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;o&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A.most_common(<span class="number">1</span>)</span><br><span class="line">[(<span class="string">&#x27;l&#x27;</span>, <span class="number">2</span>)]</span><br></pre></td></tr></table></figure>


<h1 id="高阶应用"><a href="#高阶应用" class="headerlink" title="高阶应用"></a>高阶应用</h1><h2 id="list-加入索引值"><a href="#list-加入索引值" class="headerlink" title="list 加入索引值"></a>list 加入索引值</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>seasons = [<span class="string">&#x27;Spring&#x27;</span>, <span class="string">&#x27;Summer&#x27;</span>, <span class="string">&#x27;Fall&#x27;</span>, <span class="string">&#x27;Winter&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">enumerate</span>(seasons))</span><br><span class="line">[(<span class="number">0</span>, <span class="string">&#x27;Spring&#x27;</span>), (<span class="number">1</span>, <span class="string">&#x27;Summer&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;Fall&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;Winter&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">enumerate</span>(seasons, start=<span class="number">1</span>))</span><br><span class="line">[(<span class="number">1</span>, <span class="string">&#x27;Spring&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;Summer&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;Fall&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;Winter&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<h2 id="list的压缩和解压-以及转换为dict"><a href="#list的压缩和解压-以及转换为dict" class="headerlink" title="list的压缩和解压, 以及转换为dict"></a>list的压缩和解压, 以及转换为dict</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]; b = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z = <span class="built_in">zip</span>(a, b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z</span><br><span class="line">[(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dict</span>(z)     <span class="comment"># 转换为dict</span></span><br><span class="line">&#123;<span class="number">1</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;c&#x27;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">zip</span>(*z)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<h2 id="list相邻元素压缩器-升维"><a href="#list相邻元素压缩器-升维" class="headerlink" title="list相邻元素压缩器, 升维"></a>list相邻元素压缩器, 升维</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Using iterators / 使用迭代器</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent = <span class="keyword">lambda</span> a, k: <span class="built_in">zip</span>(*([<span class="built_in">iter</span>(a)] * k))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">3</span>)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">2</span>)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">4</span>), (<span class="number">5</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">1</span>)</span><br><span class="line">[(<span class="number">1</span>,), (<span class="number">2</span>,), (<span class="number">3</span>,), (<span class="number">4</span>,), (<span class="number">5</span>,), (<span class="number">6</span>,)]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Using slices / 使用切片</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> islice</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent = <span class="keyword">lambda</span> a, k: <span class="built_in">zip</span>(*(islice(a, i, <span class="literal">None</span>, k) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)))</span><br><span class="line"><span class="comment"># 该lambda函数展开形式如下:</span></span><br><span class="line"><span class="comment"># def n_grams(a, n):</span></span><br><span class="line"><span class="comment">#     z = (islice(a, i, None) for i in range(n))</span></span><br><span class="line"><span class="comment">#     return zip(*z)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">3</span>)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">2</span>)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">4</span>), (<span class="number">5</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>group_adjacent(a, <span class="number">1</span>)</span><br><span class="line">[(<span class="number">1</span>,), (<span class="number">2</span>,), (<span class="number">3</span>,), (<span class="number">4</span>,), (<span class="number">5</span>,), (<span class="number">6</span>,)]</span><br></pre></td></tr></table></figure>

<h2 id="list展开-降维"><a href="#list展开-降维" class="headerlink" title="list展开, 降维"></a>list展开, 降维</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 推荐使用 itertools.chain.from_iterable</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(itertools.chain.from_iterable(a))</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不推荐使用 sum</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sum</span>(a, [])</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># for 循环</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x <span class="keyword">for</span> l <span class="keyword">in</span> a <span class="keyword">for</span> x <span class="keyword">in</span> l]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], [[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x <span class="keyword">for</span> l1 <span class="keyword">in</span> a <span class="keyword">for</span> l2 <span class="keyword">in</span> l1 <span class="keyword">for</span> x <span class="keyword">in</span> l2]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>], [[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flatten = <span class="keyword">lambda</span> x: [y <span class="keyword">for</span> l <span class="keyword">in</span> x <span class="keyword">for</span> y <span class="keyword">in</span> flatten(l)] <span class="keyword">if</span> <span class="built_in">type</span>(x) <span class="keyword">is</span> <span class="built_in">list</span> <span class="keyword">else</span> [x]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flatten(a)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure>

<h2 id="快速查找list的若干最值"><a href="#快速查找list的若干最值" class="headerlink" title="快速查找list的若干最值"></a>快速查找list的若干最值</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> heapq, random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [random.randint(<span class="number">0</span>, <span class="number">100</span>) <span class="keyword">for</span> __ <span class="keyword">in</span> xrange(<span class="number">100</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>heapq.nsmallest(<span class="number">5</span>, a)</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>]             <span class="comment"># a中最小的5个数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>heapq.nlargest(<span class="number">5</span>, a)</span><br><span class="line">[<span class="number">100</span>, <span class="number">100</span>, <span class="number">99</span>, <span class="number">98</span>, <span class="number">95</span>]      <span class="comment"># a中最大的5个数</span></span><br></pre></td></tr></table></figure>

<h2 id="dict和list互换"><a href="#dict和list互换" class="headerlink" title="dict和list互换"></a>dict和list互换</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># dict-&gt;list</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.keys()</span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.values()</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.items()</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># list-&gt;dict</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>l=[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">4</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dict</span>(l)</span><br><span class="line">&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>]; scores = [<span class="number">95</span>, <span class="number">75</span>, <span class="number">85</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">zip</span>(names, scores)</span><br><span class="line">[(<span class="string">&#x27;Michael&#x27;</span>, <span class="number">95</span>), (<span class="string">&#x27;Bob&#x27;</span>, <span class="number">75</span>), (<span class="string">&#x27;Tracy&#x27;</span>, <span class="number">85</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dict</span>(<span class="built_in">zip</span>(names, scores))</span><br><span class="line">&#123;<span class="string">&#x27;Bob&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;Michael&#x27;</span>: <span class="number">95</span>, <span class="string">&#x27;Tracy&#x27;</span>: <span class="number">85</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="dict内key和value互换"><a href="#dict内key和value互换" class="headerlink" title="dict内key和value互换"></a>dict内key和value互换</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># using zip</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">zip</span>(m.values(), m.keys())</span><br><span class="line">[(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;d&#x27;</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dict</span>(<span class="built_in">zip</span>(m.values(), m.keys()))</span><br><span class="line">&#123;<span class="number">1</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;d&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># using a dictionary comprehension</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.items()</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">4</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> m.items()&#125;</span><br><span class="line">&#123;<span class="number">1</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;d&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="快速生成规律性字典"><a href="#快速生成规律性字典" class="headerlink" title="快速生成规律性字典"></a>快速生成规律性字典</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;x: x ** <span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)&#125;</span><br><span class="line">&#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">1</span>, <span class="number">2</span>: <span class="number">4</span>, <span class="number">3</span>: <span class="number">9</span>, <span class="number">4</span>: <span class="number">16</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;x: <span class="string">&#x27;A&#x27;</span> + <span class="built_in">str</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;</span><br><span class="line">&#123;<span class="number">0</span>: <span class="string">&#x27;A0&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;A1&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;A2&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;A3&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;A4&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;A5&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;A6&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;A7&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;A8&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;A9&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字符串与列表字典的互换"><a href="#字符串与列表字典的互换" class="headerlink" title="字符串与列表字典的互换"></a>字符串与列表字典的互换</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 字符串-&gt;列表 (去掉引号)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;[1,2,3]&quot;</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 如果输入数据不安全, 使用ast.literal_eval(), eval的替代品, 更安全</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串-&gt;字典 (去掉引号)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;&#123;&#x27;one&#x27;:1, &#x27;two&#x27;:2&#125;&quot;</span>)</span><br><span class="line">&#123;<span class="string">&#x27;two&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;one&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="comment"># 如果输入数据不安全, 使用ast.literal_eval(), eval的替代品, 更安全</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串-&gt;列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = <span class="built_in">list</span>(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst</span><br><span class="line">[<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表-&gt;字符串</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join(lst)</span><br><span class="line"><span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串-&gt;列表 (指定分隔符, 如空格, 逗号)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>season = <span class="string">&#x27;spring, summer, autumn, winter&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>season.split (<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;spring&#x27;</span>, <span class="string">&#x27; summer&#x27;</span>, <span class="string">&#x27; autumn&#x27;</span>, <span class="string">&#x27; winter&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表-&gt;字符串</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="string">&quot;spring&quot;</span>, <span class="string">&quot;summer&quot;</span>, <span class="string">&quot;autumn&quot;</span>, <span class="string">&quot;winter&quot;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;, &#x27;</span>.join(lst)</span><br><span class="line"><span class="string">&#x27;spring, summer, autumn, winter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整数列表-&gt;字符串</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(e) <span class="keyword">for</span> e <span class="keyword">in</span> lst)</span><br><span class="line"><span class="string">&#x27;123&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="参考和资料"><a href="#参考和资料" class="headerlink" title="参考和资料"></a>参考和资料</h1><ul>
<li><a target="_blank" rel="noopener" href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001411031239400f7181f65f33a4623bc42276a605debf6000">廖雪峰的官方网站之python教程</a></li>
<li><a target="_blank" rel="noopener" href="http://sahandsaba.com/thirty-python-language-features-and-tricks-you-may-not-know.html">30 Python Language Features and Tricks You May Not Know About</a></li>
<li><a target="_blank" rel="noopener" href="http://codingpy.com/article/the-idiomatic-way-to-merge-dicts-in-python/">怎样合并字典最符合Python语言习惯？</a></li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2017/01/03/1701-python-list-dict/" data-id="cklzzbo9w002e3wqobxfkcgtx" data-title="Python 列表和字典的常见操作" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/collections/" rel="tag">collections</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/dict/" rel="tag">dict</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/list/" rel="tag">list</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/set/" rel="tag">set</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/tuple/" rel="tag">tuple</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1628-soft-regular" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/18/1628-soft-regular/" class="article-date">
  <time class="dt-published" datetime="2016-12-17T13:00:00.000Z" itemprop="datePublished">2016-12-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/software/">software</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/18/1628-soft-regular/">正则表达式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul>
<li><a href="https://draapho.github.io/2016/12/18/1628-soft-regular/">正则表达式</a></li>
<li><a href="https://draapho.github.io/2017/09/19/1726-soft-easyre/">人人都看得懂的正则表达式教程</a></li>
<li><a href="https://draapho.github.io/2017/10/07/1727-soft-reexample/">最全的常用正则表达式大全</a></li>
</ul>
<p>本文详细介绍了正则表达式的基础内容</p>
<h1 id="正则表达式基础内容"><a href="#正则表达式基础内容" class="headerlink" title="正则表达式基础内容"></a>正则表达式基础内容</h1><table>
<thead>
<tr>
<th>RE 字符/范例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>\</code></td>
<td>跳脱/转义字符</td>
</tr>
<tr>
<td><strong>占位符</strong></td>
<td>表示一个字符</td>
</tr>
<tr>
<td><code>^word</code></td>
<td><code>^</code>表<strong>行首</strong>, 待匹配的字符串<code>word</code>在行首！</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;^#&#39; re.txt</code></td>
<td>显示行首为 <code>#</code> 的行</td>
</tr>
<tr>
<td><code>word$</code></td>
<td><code>$</code>表<strong>行尾</strong>, 待匹配的字符串<code>word</code>在行尾！</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;!$&#39; re.txt</code></td>
<td>显示行尾为 <code>!</code> 的行</td>
</tr>
<tr>
<td><code>.</code></td>
<td>代表<strong>任意一个</strong>字符, 必须有一个字符</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;e.e&#39; re.txt</code></td>
<td>结果为 <code>eve</code> <code>eee</code> <code>e e</code>, 但不能是 <code>ee</code></td>
</tr>
<tr>
<td><code>[]</code></td>
<td>字符集合. <strong>除<code>^</code> <code>\</code> <code>-</code>外, 其它特殊字符在中括号被认为是普通字符</strong>. 系统字符集可以包含其中如<code>[\d]</code></td>
</tr>
<tr>
<td><code>[^]</code></td>
<td>中括号内的第一个<code>^</code>表示补集, <del>而不是行尾</del>, 也可以理解为非. 非第一个则为普通字符</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;[(+*)]&#39; re.txt</code></td>
<td>匹配 <code>(</code> <code>+</code> <code>*</code> <code>)</code> 中的一个字符.</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;[0-9]&#39; re.txt</code></td>
<td>搜寻含有任意数字的那一行.  中括号内的<code>-</code>表连续(由编码决定),</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;oo[^0-9]&#39; re.txt</code></td>
<td>排除结果 <code>oo0-oo9</code>, 可以是 <code>ooa</code> <code>oog</code>等等</td>
</tr>
<tr>
<td><strong>数量符</strong></td>
<td>跟在一个字符或组的后面, 重复该RE字符或组若干次</td>
</tr>
<tr>
<td><code>*</code></td>
<td><strong>零个或多个</strong>的前一RE字符</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;ess*&#39; re.py</code></td>
<td>结果为 <code>es</code>(0次s), <code>ess</code>, <code>esss</code></td>
</tr>
<tr>
<td>…… <code>.*</code></td>
<td>表示任意字符</td>
</tr>
<tr>
<td><code>&#123;m,n&#125;</code></td>
<td><strong>连续m到n个</strong>的前一RE字符</td>
</tr>
<tr>
<td>…… <code>&#123;m,&#125;</code></td>
<td><strong>连续m个及以上</strong>的前一RE字符</td>
</tr>
<tr>
<td>…… <code>&#123;m&#125;</code></td>
<td><strong>连续m个</strong>的前一RE字符</td>
</tr>
<tr>
<td>…… <code>grep -n &#39;go\&#123;2,3\&#125;g&#39; re.txt</code></td>
<td>结果为 <code>goog</code>(2次o), <code>gooog</code>(3次o).</td>
</tr>
<tr>
<td><code>?</code></td>
<td><strong>零个或一个</strong>的前一RE字符, 等同于<code>&#123;0,1&#125;</code></td>
</tr>
<tr>
<td>…… <code>egrep -n &#39;go?d&#39; re.txt</code></td>
<td>只能匹配<code>gd</code>和<code>god</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td>重复<strong>一个或以上</strong>的前一RE字符, 等同于<code>&#123;1,&#125;</code></td>
</tr>
<tr>
<td>…… <code>egrep -n &#39;go+d&#39; re.txt</code></td>
<td>匹配<code>god</code> <code>good</code>等, <del>但不能匹配<code>gd</code></del></td>
</tr>
<tr>
<td><code>*?</code> <code>+?</code> <code>??</code> <code>&#123;m,n&#125;?</code></td>
<td>让 <code>*</code> <code>+</code> <code>?</code> <code>&#123;m,n&#125;</code> 变得非贪婪, 即匹配尽可能少的字符</td>
</tr>
<tr>
<td>…… <code>&lt;.*&gt;</code>匹配<code>&#39;&lt;H1&gt;title&lt;/H1&gt;&#39;</code></td>
<td>会得到 <code>&#39;&lt;H1&gt;title&lt;/H1&gt;&#39;</code> 整个字符串, <del>而不是预想的<code>&#39;&lt;H1&gt;&#39;</code></del></td>
</tr>
<tr>
<td>…… <code>&lt;.*?&gt;</code>匹配<code>&#39;&lt;H1&gt;title&lt;/H1&gt;&#39;</code></td>
<td><code>*?</code>变得非贪婪, 会得到 <code>&#39;&lt;H1&gt;&#39;</code> 字符串</td>
</tr>
<tr>
<td><strong>逻辑分组</strong></td>
<td>对字符进行分组和判断</td>
</tr>
<tr>
<td><code>()</code></td>
<td>分组字符串</td>
</tr>
<tr>
<td>…… <code>egrep &#39;A(xyz)+C&#39;</code></td>
<td>匹配A开头, C结尾, 中间有一个以上”xyz”的字符串, 如 <code>AxyzC</code> <code>AxyzxyzxyzC</code></td>
</tr>
<tr>
<td><code>\number</code></td>
<td>反向引用, 引用编号为<code>number</code>的分组<code>()</code>匹配到字符串</td>
</tr>
<tr>
<td>…… <code>(\d)abc\1</code></td>
<td>匹配结果 <code>1abc1</code> 或 <code>5abc5</code></td>
</tr>
</tbody></table>
<ul>
<li><code>|</code> 理解为或即可, 用来隔开多个正则表达式.</li>
<li>譬如 <code>egrep -n &#39;gd|good&#39; re.txt</code>   只能匹配<code>gd</code>和<code>good</code></li>
<li>譬如 <code>egrep -n &#39;g(la|oo)d&#39; re.txt</code> 只能匹配<code>glad</code>和<code>good</code></li>
</ul>
<h1 id="正则表达式的兼容性问题"><a href="#正则表达式的兼容性问题" class="headerlink" title="正则表达式的兼容性问题"></a>正则表达式的兼容性问题</h1><h2 id="PCRE"><a href="#PCRE" class="headerlink" title="PCRE"></a>PCRE</h2><p>即 Perl Compatible Regular Expression<br>常见的正则表达式记法,其实都源于Perl.<br>实际上，正则表达式是从Perl衍生出一个显赫的流派, 称为PCRE<br><code>\d</code> <code>\w</code> <code>\s</code> 之类的记法，就是这个流派的特征.</p>
<p>Python 的re库就是使用的PCRE. 其系统字符集如下:</p>
<table>
<thead>
<tr>
<th>系统字符集</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>\d</code></td>
<td>digital, 数字字符, <code>[0-9]</code></td>
</tr>
<tr>
<td><code>\D</code></td>
<td>非数字字符, <code>[^\d]</code></td>
</tr>
<tr>
<td><code>\s</code></td>
<td>space, 空白字符, <code>[ \t\r\n\f\v]</code></td>
</tr>
<tr>
<td><code>\S</code></td>
<td>非空白字符, <code>[^\s]</code></td>
</tr>
<tr>
<td><code>\w</code></td>
<td>word, 单词字符, <code>[A-Za-z0-9_]</code></td>
</tr>
<tr>
<td><code>\W</code></td>
<td>非单词字符, <code>[^\w]</code></td>
</tr>
<tr>
<td><code>\A</code></td>
<td>仅匹配字符串开头</td>
</tr>
<tr>
<td><code>\Z</code></td>
<td>仅匹配字符串结尾</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>提取指定的<code>\w</code>串</td>
</tr>
<tr>
<td>… <code>\bfoo\b</code></td>
<td>匹配 <code>foo</code> <code>foo.</code> <code>(foo)</code> <code>b foo z</code>, <del>不匹配 <code>foobar</code></del></td>
</tr>
<tr>
<td><code>\B</code></td>
<td><code>[^\b]</code>, 指定部分内容提取<code>\w</code>串</td>
</tr>
<tr>
<td>… <code>py\B</code></td>
<td>匹配 <code>python</code> <code>py3</code>, <del>不匹配 <code>py</code> <code>py.</code> <code>py!</code></del></td>
</tr>
</tbody></table>
<h2 id="POSIX"><a href="#POSIX" class="headerlink" title="POSIX"></a>POSIX</h2><p>linux是遵循POSIX标准的, 因此在linux下使用正则表达式时, 系统字符集如下:</p>
<table>
<thead>
<tr>
<th>系统字符集</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>[:alnum:]</code></td>
<td>单词字符, <code>[A-Za-z0-9_]</code></td>
</tr>
<tr>
<td><code>[:alpha:]</code></td>
<td>字母字符, <code>[A-Za-z]</code></td>
</tr>
<tr>
<td><code>[:ascii:]</code></td>
<td>ASCII字符, <code>[\x00-\x7F]</code></td>
</tr>
<tr>
<td><code>[:blank:]</code></td>
<td>空格字符, <code>[ \t]</code></td>
</tr>
<tr>
<td><code>[:cntrl:]</code></td>
<td>控制键字符, <code>[\x00-\x1F\x7F]</code></td>
</tr>
<tr>
<td><code>[:digit:]</code></td>
<td>数字字符, <code>[0-9]</code></td>
</tr>
<tr>
<td><code>[:graph:]</code></td>
<td>非空字符, <code>[\x21-\x7E]</code>, <code>[:blank:]</code>的补集</td>
</tr>
<tr>
<td><code>[:lower:]</code></td>
<td>小写字母, <code>[a-z]</code></td>
</tr>
<tr>
<td><code>[:print:]</code></td>
<td>可被打印的字符, <code>[\x20-\x7E]</code></td>
</tr>
<tr>
<td><code>[:punct:]</code></td>
<td>所有标点符号, <code>[][!&quot;#$%&amp;&#39;()*+,./:;&lt;=&gt;?@\</code>^_{}~-]丨`</td>
</tr>
<tr>
<td><code>[:upper:]</code></td>
<td>大写字母 <code>[A-Z]</code></td>
</tr>
<tr>
<td><code>[:space:]</code></td>
<td>空白字符 <code>[ \t\r\n\v\f]</code></td>
</tr>
<tr>
<td><code>[:word:]</code></td>
<td>字母字符 <code>[A-Za-z_]</code></td>
</tr>
<tr>
<td><code>[:xdigit:]</code></td>
<td>16进制类型 <code>[0-9A-Fa-f]</code></td>
</tr>
</tbody></table>
<h2 id="BRE-基础RE"><a href="#BRE-基础RE" class="headerlink" title="BRE, 基础RE"></a>BRE, 基础RE</h2><p>即, Basic Regular Expression<br>BRE只定义了6组元字符：</p>
<ul>
<li><code>[]</code>, 用于在多个字符中选定一个字符进行匹配</li>
<li><code>.</code>,  用于匹配任意字符</li>
<li><code>^</code>,  用于匹配时表示“非”的含义，还有一个用法是匹配行首</li>
<li><code>$</code>,  用于匹配行尾</li>
<li><code>*</code>,  零个或多个的前一RE字符</li>
<li><code>\</code>,  跳脱/转义字符</li>
</ul>
<p>在Linux/Unix常用工具中, grep vi sed都属于BRE这一派,<br>为了向前兼容并使用RE的一些新特性, 导致它的语法看起来比较奇怪. <code>()</code> <code>&#123;&#125;</code> 需要使用 <code>\</code> 转义后才有特殊含义.<br>如果直接使用 <code>a&#123;1,2&#125;</code>, 只能去匹配 <code>a&#123;1,2&#125;</code> 字符串. 只有使用 <code>a\&#123;1,2\&#125;</code> 才能匹配为 <code>a</code>和<code>aa</code>.<br>另外, BRE一般不支持 <del><code>+</code> <code>?</code> <code>(...|...)</code> <code>\number</code></del></p>
<h2 id="ERE-扩展RE"><a href="#ERE-扩展RE" class="headerlink" title="ERE, 扩展RE"></a>ERE, 扩展RE</h2><p>即, Extention Regular Expression<br>ERE在BRE上增加了3组元字符的定义：</p>
<ul>
<li><code>&#123;&#125;</code> 用于表示重复匹配的次数. BRE中将<code>&#123;&#125;</code>当作普通字符对待，必须加<code>\</code>进行转义, 即<code>\&#123;\&#125;</code></li>
<li><code>()</code>, 用于分组。BRE中只将<code>()</code>当作普通字符对待，必须加<code>\</code>进行转义，即<code>\(\)</code></li>
<li><code>|</code>, 完全为ERE新增的多项匹配能力定义的，BRE无多项匹配能力，只将<code>|</code>作普通字符对待</li>
<li><code>\number</code>, ERE没有明确规定需要支持反向引用, 但不少工具都支持此功能</li>
</ul>
<h2 id="linux-unix下的RE表达式汇总"><a href="#linux-unix下的RE表达式汇总" class="headerlink" title="linux/unix下的RE表达式汇总"></a>linux/unix下的RE表达式汇总</h2><table>
<thead>
<tr>
<th>PCRE记法</th>
<th>vi/vim</th>
<th>grep</th>
<th>egrep</th>
<th>awk</th>
<th>sed</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td><code>\+</code></td>
<td><code>\+</code></td>
<td><code>+</code></td>
<td><code>+</code></td>
<td><code>\+</code></td>
</tr>
<tr>
<td><code>?</code></td>
<td><code>\=</code></td>
<td><code>\?</code></td>
<td><code>?</code></td>
<td><code>?</code></td>
<td><code>\?</code></td>
</tr>
<tr>
<td><code>&#123;m,n&#125;</code></td>
<td><code>\&#123;m,n&#125;</code></td>
<td><code>\&#123;m,n\&#125;</code></td>
<td><code>&#123;m,n&#125;</code></td>
<td><code>&#123;m,n&#125;</code></td>
<td><code>\&#123;m,n\&#125;</code></td>
</tr>
<tr>
<td><code>\b</code></td>
<td><code>\&lt;</code> <code>\&gt;</code></td>
<td><code>\&lt;</code> <code>\&gt;</code></td>
<td><code>\&lt;</code> <code>\&gt;</code></td>
<td><code>\&lt;</code> <code>\&gt;</code></td>
<td><code>\y</code> <code>\&lt;</code> <code>\&gt;</code></td>
</tr>
<tr>
<td><code>(…)</code></td>
<td><code>\(…\)</code></td>
<td><code>\(…\)</code></td>
<td><code>(…)</code></td>
<td><code>(…)</code></td>
<td><code>(…)</code></td>
</tr>
<tr>
<td><code>\1</code> <code>\2</code></td>
<td><code>\1</code> <code>\2</code></td>
<td><code>\1</code> <code>\2</code></td>
<td><code>\1</code> <code>\2</code></td>
<td>不支持</td>
<td><code>\1</code> <code>\2</code></td>
</tr>
</tbody></table>
<p>注意:</p>
<ul>
<li>PCRE中常用<code>\b</code>来表示<strong>单词的起始或结束位</strong>,</li>
<li>Linux工具中, 通常用<code>\&lt;</code>来匹配<strong>单词的起始位置</strong>, 用<code>\&gt;</code>来匹配<strong>单词的结束位置</strong></li>
<li><code>sed</code>中的<code>\y</code>可以同时匹配这两个位置。</li>
</ul>
<h1 id="与bash-shell的一些容易弄混的区别"><a href="#与bash-shell的一些容易弄混的区别" class="headerlink" title="与bash shell的一些容易弄混的区别"></a>与bash shell的一些容易弄混的区别</h1><table>
<thead>
<tr>
<th>特殊字符</th>
<th>bash shell中的含义</th>
<th>RE中的含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td>零个到多个任意字符</td>
<td>重复零个或多个前一RE字符</td>
</tr>
<tr>
<td><code>?</code></td>
<td>一个任意字符</td>
<td>重复零个或一个前一RE字符</td>
</tr>
<tr>
<td><code>.</code></td>
<td>运行代码 <code>source</code></td>
<td>一个任意字符</td>
</tr>
<tr>
<td><code>[0-9a-z]</code></td>
<td>list内的一个字符</td>
<td>list内的一个字符</td>
</tr>
<tr>
<td><code>[0-9]</code>的补集</td>
<td><code>[!0-9]</code> ()</td>
<td><code>[^range]</code> (<code>!</code>在RE里是普通字符)</td>
</tr>
<tr>
<td><code>&#123;&#125;</code></td>
<td><code>&#123;123,abc&#125;</code> 字符串匹配</td>
<td><code>&#123;m,n&#125;</code> 重复m到n个前一RE字符</td>
</tr>
</tbody></table>
<ul>
<li>匹配<code>a</code>开头的任意文件<ul>
<li>bash下 <code>ls a*</code></li>
<li>re下 <code>ls | grep &quot;^a.*&quot;</code></li>
</ul>
</li>
<li>匹配string1或string2或更多之一字符串<ul>
<li>bash下 <code>&#123;string1,string2,string3&#125;</code>. 如 <code>touch a&#123;xyz,123&#125;.txt</code>, 结果为 <code>axyz.txt</code> <code>a123.txt</code></li>
<li>re下 <code>(string1|string2|string3)</code>. 如 <code>ls | egrep &#39;g(la|oo)d&#39;</code>, 结果为 <code>glad</code> <code>good</code></li>
</ul>
</li>
<li>连续字符匹配<ul>
<li>bash下, 有两种连续字符表示法 <code>&#123;0..9&#125;</code> 和 <code>[0-9]</code>, 支持<code>[1-3a-z]</code>, <del>不支持<code>&#123;1..3a..z&#125;</code></del>, </li>
<li>bash下 <code>touch &#123;ex&#123;1..3&#125;,ex4&#125;.sh</code>或<code>touch &#123;ex&#123;1..3&#125;,ex4&#125;.sh</code>, 结果为 <code>ex1.sh</code> <code>ex2.sh</code> <code>ex3.sh</code> <code>ex4.sh</code> </li>
<li>re下 <code>ls | egrep &quot;(ex[1-3]|ex4).sh&quot;</code>, 结果为 <code>ex1.sh</code> <code>ex2.sh</code> <code>ex3.sh</code> <code>ex4.sh</code></li>
</ul>
</li>
<li>简单总结, RE的功能远比bash自带的匹配符功能强大. 特别容易弄混的也就是 <code>*</code> <code>?</code> <code>[^range]</code></li>
</ul>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a target="_blank" rel="noopener" href="http://python.usyiyi.cn/documents/python_278/library/re.html">python标准库 7.2 re — 正则表达式操作</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/huxi/archive/2010/07/04/1771073.html">Python正则表达式指南</a></li>
<li><a target="_blank" rel="noopener" href="http://linux.vbird.org/linux_basic/0330regularex.php">鸟哥的私房菜 第十一章、正規表示法與文件格式化處理</a></li>
<li><a target="_blank" rel="noopener" href="http://www.infoq.com/cn/news/2011/07/regular-expressions-6-POSIX">Linux/Unix工具与正则表达式的POSIX规范</a></li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/18/1628-soft-regular/" data-id="cklzzbo9v002b3wqo6fu9du0u" data-title="正则表达式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/cheat-sheet/" rel="tag">cheat sheet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/regular/" rel="tag">regular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/software/" rel="tag">software</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1627-linux-cmd-bash" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/17/1627-linux-cmd-bash/" class="article-date">
  <time class="dt-published" datetime="2016-12-16T13:00:00.000Z" itemprop="datePublished">2016-12-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/17/1627-linux-cmd-bash/">Bash Shell及环境变量</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="入门教程"><a href="#入门教程" class="headerlink" title="入门教程"></a>入门教程</h1><p>推荐 <a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/shell/">C语言中文网-Shell教程</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/6998.html">第一个shell脚本</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/6999.html">shell变量</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2739.html">shell特殊变量</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2737.html">shell替换</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2736.html">shell运算符</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7000.html">shell注释</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7001.html">shell字符串</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7002.html">shell数组</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7003.html">shell echo命令</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/1499.html">shell printf命令</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7005.html">shell if else语句</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7006.html">shell case esac语句</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7007.html">shell for循环</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7008.html">shell while循环</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7009.html">shell until循环</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7010.html">shell跳出循环</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/7011.html">shell函数</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2491.html">shell函数参数</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2738.html">shell输入输出重定向</a></li>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2740.html">shell文件包含</a></li>
</ul>
<h1 id="Bash-Shell基础操作"><a href="#Bash-Shell基础操作" class="headerlink" title="Bash Shell基础操作"></a>Bash Shell基础操作</h1><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>[Tab]</code></td>
<td>指令或文件名自动补齐</td>
</tr>
<tr>
<td><code>[Tab][Tab]</code></td>
<td>连按两下[Tab], 列出所有可补齐的指令或档案</td>
</tr>
<tr>
<td><code>[ctrl]-c</code></td>
<td>中断指令</td>
</tr>
<tr>
<td><code>[ctrl]-d</code></td>
<td>EOF,表示输入结束</td>
</tr>
<tr>
<td><code>[↑]</code> <code>[↓]</code></td>
<td>浏览历史指令</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>stty</code></td>
<td>查看和设置终端按键参数</td>
</tr>
<tr>
<td>…… <strong><code>stty -a</code></strong></td>
<td>查看终端所有的按键参数</td>
</tr>
<tr>
<td><code>history</code></td>
<td>查询历史指令, 建议将其设置别名<code>alias h=’history’</code></td>
</tr>
<tr>
<td><code>!</code></td>
<td>执行历史指令, 后接数字或字母</td>
</tr>
<tr>
<td>…… <strong><code>!!</code></strong></td>
<td>执行上一个指令</td>
</tr>
<tr>
<td>…… <strong><code>!al</code></strong></td>
<td>执行以al为开头的最后一个指令</td>
</tr>
<tr>
<td>…… <strong><code>!12</code></strong></td>
<td>执行第12条历史指令(先用history查看历史指令号)</td>
</tr>
<tr>
<td><code>alias cmd=’command’</code></td>
<td>设置指令别名, command为指令字符串</td>
</tr>
<tr>
<td>…… <strong><code>alias h=history</code></strong></td>
<td>设置指令history的别名为h.不用引号,单双引号皆可</td>
</tr>
<tr>
<td><code>unalias cmd</code></td>
<td>取消指令别名</td>
</tr>
<tr>
<td><code>type -a command</code></td>
<td>查询指令类型(file外部指令; alias别名指令;builtin内建指令)</td>
</tr>
<tr>
<td><code>command --help</code></td>
<td>获取command内置的帮助信息,较为简短</td>
</tr>
<tr>
<td><code>man command</code></td>
<td>获取command的帮助文件. <code>j</code> <code>k</code>上下移动, <code>q</code>退出</td>
</tr>
<tr>
<td><code>sh file</code></td>
<td>创建一个子shell, 执行file内的指令</td>
</tr>
<tr>
<td><code>source file</code></td>
<td>在当前shell内,执行file内的指令</td>
</tr>
<tr>
<td><code>. file</code></td>
<td>等同于source file</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>su -l user</code></td>
<td>切换用户, -l表示环境变量一起变</td>
</tr>
<tr>
<td>…… <strong><code>su</code></strong></td>
<td>切换为管理员账户</td>
</tr>
<tr>
<td><code>sudo command</code></td>
<td>赋予用户临时的管理员权限 (<code>/etc/sudoers</code>决定是否支持)</td>
</tr>
<tr>
<td><code>exit</code></td>
<td>退出当前用户的终端环境</td>
</tr>
<tr>
<td><code>shutdown -h now</code></td>
<td>立刻关机</td>
</tr>
<tr>
<td><code>sync; sync; shutdown -r now</code></td>
<td>立刻重启, 重启前需要存储一下数据</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>date</code></td>
<td>时间</td>
</tr>
<tr>
<td><code>cal</code></td>
<td>日期</td>
</tr>
<tr>
<td><code>bc</code></td>
<td>计算器, 输入quit退出</td>
</tr>
<tr>
<td><code>apt-get</code></td>
<td>ubuntu deb包软件管理</td>
</tr>
<tr>
<td>…… <strong><code>sudo apt-get install packagename</code></strong></td>
<td>安装指定软件包</td>
</tr>
<tr>
<td>…… <strong><code>sudo apt-get autoremovepackagename</code></strong></td>
<td>删除指定软件包 (包括配置文件)</td>
</tr>
</tbody></table>
<h1 id="变量与环境变量"><a href="#变量与环境变量" class="headerlink" title="变量与环境变量"></a>变量与环境变量</h1><ul>
<li>系统变量一般大写, 如MAIL</li>
<li>用户变量一般小写, 如myhome</li>
<li>普通变量(也称shell变量)作用范围: 当前的shell</li>
<li>环境变量(也称用户变量)作用范围: 当前的shell及其子shell</li>
<li>环境变量开机设置文档<ul>
<li><code>~/.bashrc</code>, <code>~/.profile</code>, <code>/etc/profile</code>, <code>/etc/bash.bashrc</code>,等等</li>
<li>首先读取 <code>/etc/profile</code>, 最后读取 <code>~/.bashrc</code></li>
<li>个人设定建议放在<code>~/.bashrc</code>内,并做如下修改:</li>
<li>修改<code>HISTSIZE=50</code>  (减少记录的历史指令,安全)</li>
<li>加入<code>alias h=&#39;history&#39;</code></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>myhome=/home/my/</code></td>
<td>无空格字符串,注意等号左右不要有空格</td>
</tr>
<tr>
<td><code>myhome=’/home/my/’</code></td>
<td>单引号内可包含任意字符串, 无特殊含义</td>
</tr>
<tr>
<td><code>myname=”my name is”</code></td>
<td>双引号内某些字符有特殊作用, 如 $</td>
</tr>
<tr>
<td><code>read variable</code></td>
<td>键盘输入变量, 回车表示结束输入</td>
</tr>
<tr>
<td>…… <strong><code>read -p “Input name:” -t 30 myname</code></strong></td>
<td>提示输入变量给myname, 30秒输入时间</td>
</tr>
<tr>
<td><code>echo $myhome</code></td>
<td>变量名前加上$, 即可读取该变量的值</td>
</tr>
<tr>
<td><code>echo “$myhome”</code></td>
<td>“$变量名”,无歧义. 注意不能单引号</td>
</tr>
<tr>
<td><code>echo $&#123;myhome&#125;</code></td>
<td>${变量名},无歧义</td>
</tr>
<tr>
<td><code>unset myhome</code></td>
<td>删除变量</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>let val=10*10</code></td>
<td>加上let后, val值为100,而非10*10. 用的比declare多!</td>
</tr>
<tr>
<td><code>readonly VAL=’read only’</code></td>
<td>将VAL为只读变量,不可更改和unset (等同 declare -r)</td>
</tr>
<tr>
<td><code>declare -ai array</code></td>
<td>将array声明为整数数组 (不加参数a,效果一样)</td>
</tr>
<tr>
<td><code>array[1]=10*10</code></td>
<td>数组的赋值, array定义为整数,因此array[1]值为100</td>
</tr>
<tr>
<td><code>echo $&#123;array[1]&#125;</code></td>
<td>使用”$array[1]”没用.若无{}, 会认为是”$array”[1]</td>
</tr>
<tr>
<td><code>unset array</code></td>
<td>将array数组变量删除</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>PATH=/home:$PATH</code></td>
<td>新增”/home:”在PATH变量最前面</td>
</tr>
<tr>
<td><code>PATH=”$PATH””:/home”</code></td>
<td>前后都加”双引号”,无歧义. 建议这样书写</td>
</tr>
<tr>
<td><code>PATH=$&#123;PATH&#125;’:/home’</code></td>
<td>变量名用{大括号}指明,无歧义. 新增变量也可用’单引号’</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>echo $?</code></td>
<td>?为特殊变量,为上一指令传回的值. 0成功, !0失败</td>
</tr>
<tr>
<td><code>echo $$</code></td>
<td>获取并显示当前shell的 PID (process ID)</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>#</code> <code>##</code> <code>%</code> <code>%%</code> <code>/</code> <code>//</code></td>
<td>变量的截取和替换. 以<code>myhome=/home/test/test.sh</code>为例</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome#/*/&#125;</code></strong></td>
<td><code>test/test.sh</code>,从头比较, 单次删除,故<del><code>/home/</code></del></td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome##/*/&#125;</code></strong></td>
<td><code>test.sh</code>, 从头比较, 全部删除,获得文件名</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome%/*&#125;</code></strong></td>
<td><code>/home/test</code>,从尾比较, 单次删除,获得路径</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome%%/*&#125;</code></strong></td>
<td>从尾比较, 全部删除,故全部被删掉</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome/test/TEST&#125;</code></strong></td>
<td><code>/home/TEST/test.h</code>, 从头比较, 单次替换</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;myhome//test/TEST&#125;</code></strong></td>
<td><code>/home/TEST/TEST.h</code>,从头比较, 全部替换</td>
</tr>
<tr>
<td><code>-</code> <code>:-</code> <code>+</code> <code>:+</code> <code>=</code> <code>:=</code> <code>?</code> <code>:?</code></td>
<td>变量的比较和判断. 常用于判断和确保变量有效</td>
</tr>
<tr>
<td>…… <strong><code>var=$&#123;str-expr&#125;</code></strong></td>
<td>var为目标变量, str为已有变量, expr为变量值</td>
</tr>
<tr>
<td>…… <strong><code>myname=$&#123;myname:-root&#125;</code></strong></td>
<td>若myname不存在或为空,则myname=root</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>env</code></td>
<td>enviroment, 显示当前环境变量,用的最多!</td>
</tr>
<tr>
<td><code>set</code></td>
<td>显示所有变量(环境变量,普通变量)</td>
</tr>
<tr>
<td><code>export</code></td>
<td>显示已成为当前环境变量的普通变量</td>
</tr>
<tr>
<td>…… <strong><code>export variable</code></strong></td>
<td>将variable设为环境变量, 等同 <code>declare -x variable</code></td>
</tr>
<tr>
<td><code>locale</code></td>
<td>查看当前语言的环境变量</td>
</tr>
<tr>
<td>…… <strong><code>locale -a</code></strong></td>
<td>查看系统支持的语言</td>
</tr>
</tbody></table>
<h1 id="Bash-Shell特殊符号"><a href="#Bash-Shell特殊符号" class="headerlink" title="Bash Shell特殊符号"></a>Bash Shell特殊符号</h1><table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td>万用字符, 表示0或多个字符</td>
</tr>
<tr>
<td><code>?</code></td>
<td>万用字符, 表示一个字符</td>
</tr>
<tr>
<td><code>!</code></td>
<td>逻辑非, 通常在<code>[中括号]</code>内使用</td>
</tr>
<tr>
<td><code>\</code></td>
<td>转义字符, 需要转义的字符 <code>&quot;</code> <code>&#39;</code> <code>$</code> <code>\</code> <code> </code> `</td>
</tr>
<tr>
<td>…… <strong><code>\n</code></strong></td>
<td>换行</td>
</tr>
<tr>
<td>…… <strong><code>\r</code></strong></td>
<td>回车</td>
</tr>
<tr>
<td>…… <strong><code>\t</code></strong></td>
<td>水平制表符</td>
</tr>
<tr>
<td>…… <strong><code>\v</code></strong></td>
<td>垂直制表符</td>
</tr>
<tr>
<td>…… <strong><code>\b</code></strong></td>
<td>后退</td>
</tr>
<tr>
<td>…… <strong><code>\a</code></strong></td>
<td>蜂鸣</td>
</tr>
<tr>
<td>…… <strong><code>\077</code></strong></td>
<td>八进制字符</td>
</tr>
<tr>
<td>…… <strong><code>\xff</code></strong></td>
<td>十六进制</td>
</tr>
<tr>
<td><code>#</code></td>
<td>批注</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>$variable</code></td>
<td>变量名</td>
</tr>
<tr>
<td><code>$&#123;variable&#125;</code></td>
<td>大括号. 中间为命令区块组合,限定变量名范围</td>
</tr>
<tr>
<td>…… <strong><code>echo $&#123;array[1]&#125;</code></strong></td>
<td>显示<code>array[1]</code> 变量值, array为数组,需用<code>&#123;大括号&#125;</code>包含变量名</td>
</tr>
<tr>
<td><code>[a-f], [35], [!a-z]</code></td>
<td>中括号. 中间为字符组合, <code>[仅代表一个字符]</code></td>
</tr>
<tr>
<td>…… <strong><code>ls -d ~/*[0-9]*</code></strong></td>
<td>列出用户home目录下所有包含数字的文件和目录</td>
</tr>
<tr>
<td><code>$(command)</code></td>
<td>小括号. 中间为子shell,此命令等同于`command`</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>&#39;$string&#39;</code></td>
<td>单引号, 特殊符号无效,变量不置换, 显示为$string</td>
</tr>
<tr>
<td><code>&quot;$variable&quot;</code></td>
<td>双引号, 特殊符号有用,变量置换</td>
</tr>
<tr>
<td>`command`</td>
<td>`(键盘1左边的字符),需要优先执行的指令</td>
</tr>
<tr>
<td>…… <strong>cd /usr/src/linux-headers-`uname -r`</strong></td>
<td>进入当前linux的内核源码目录</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>cmd1 l cmd2 和 cm1 ll cmd2</td>
<td>hexo解析问题, 无法再表格中正确显示<code>丨</code>, <strong>故放到表格的最后</strong></td>
</tr>
<tr>
<td><code>cut</code> <code>grep</code> <code>split</code></td>
<td>截取分割, 通常配合 <code>pipe</code>使用</td>
</tr>
<tr>
<td><code>sort</code> <code>wc</code> <code>uniq</code></td>
<td>排序命令, 通常配合 <code>pipe</code>使用</td>
</tr>
<tr>
<td><code>tr</code> <code>col</code> <code>join</code> <code>paste</code> <code>expand</code></td>
<td>字符转换, 通常配合 <code>pipe</code>使用</td>
</tr>
<tr>
<td><code>cmd1;cmd2; cmd3</code></td>
<td>可以一行写多个指令</td>
</tr>
<tr>
<td><code>cmd1 &amp;&amp; cmd2</code></td>
<td>cmd1执行正确($?为0),则继续执行cmd2, 否则不执行</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>&gt;</code> <code>2&gt;</code> <code>&gt;&gt;</code> <code>2&gt;&gt;</code></td>
<td>输出到文件 (&gt;写入, &gt;&gt;累加, 2错误信息)</td>
</tr>
<tr>
<td>…… <strong><code>ll &gt; list.txt</code></strong></td>
<td>将当前目录下的文件详细信息存储到list.txt文件中</td>
</tr>
<tr>
<td>…… <strong><code>ls / &gt;&gt; list.txt</code></strong></td>
<td>将根目录下的文件信息追加到list.txt文件中</td>
</tr>
<tr>
<td>…… <strong><code>find /home -name test &gt; ok 2&gt; error</code></strong></td>
<td>将正确信息写到ok中,错误的写到error中</td>
</tr>
<tr>
<td>…… <strong><code>find /home -name test &gt; list 2&gt;&amp;1</code></strong></td>
<td>将所有信息都写到list中 (&amp;1是数字一)</td>
</tr>
<tr>
<td>…… <strong><code>find /home -name test &gt; /dev/null 2&gt; err</code></strong></td>
<td><code>/dev/null</code>相当于黑洞.只将错误写到err中</td>
</tr>
<tr>
<td><code>&lt;</code> <code>&lt;&lt;</code></td>
<td>输入信息(&lt;从文件获取, &lt;&lt;结束的输入字符)</td>
</tr>
<tr>
<td>…… <strong><code>cat &gt; catfile</code></strong></td>
<td>从键盘获取文本并写到catfile中 (键盘按[ctrl]+d结束输入)</td>
</tr>
<tr>
<td>…… <strong><code>cat &gt; catfile &lt;&lt; end</code></strong></td>
<td>从键盘获取文本并写到catfile中(键盘输入end结束输入)</td>
</tr>
<tr>
<td>…… <strong><code>cat &gt; catfile &lt; input</code></strong></td>
<td>导入input文件信息再写到catfile中</td>
</tr>
</tbody></table>
<ul>
<li><code>cmd1 | cmd2</code>  <code>pipe</code>管线命令,将cmd1的处理结果传给cmd2继续处理</li>
<li>譬如 <code>ll | more</code>  将ll获得的数据传给more进一步处理</li>
<li><code>cmd1 || cmd2</code>  cmd1执行错误($?为!0),则继续执行cmd2, 否则不执行</li>
<li>譬如 <code>ls /tmp/test &amp;&amp; echo &quot;exist&quot; || echo &quot;nofile&quot;</code> 如果<code>/tmp/test</code>存在显示<code>exist</code>,否则<code>nofile</code></li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/17/1627-linux-cmd-bash/" data-id="cklzzbo9u00273wqo6pux22xc" data-title="Bash Shell及环境变量" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/shell/" rel="tag">shell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1626-linux-cmd-file" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/16/1626-linux-cmd-file/" class="article-date">
  <time class="dt-published" datetime="2016-12-15T13:00:00.000Z" itemprop="datePublished">2016-12-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/16/1626-linux-cmd-file/">linux文件与目录相关指令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="linux-文件基础"><a href="#linux-文件基础" class="headerlink" title="linux 文件基础"></a>linux 文件基础</h1><h2 id="特殊符号代表的目录"><a href="#特殊符号代表的目录" class="headerlink" title="特殊符号代表的目录:"></a>特殊符号代表的目录:</h2><table>
<thead>
<tr>
<th>特殊符号</th>
<th>目录</th>
</tr>
</thead>
<tbody><tr>
<td><code>.</code></td>
<td>代表此层目录</td>
</tr>
<tr>
<td><code>..</code></td>
<td>代表上一层目录</td>
</tr>
<tr>
<td><code>~</code></td>
<td>代表<strong>目前使用者</strong>所在的家目录</td>
</tr>
<tr>
<td><code>~account</code></td>
<td>代表<strong>account</strong>这个使用者的家目录</td>
</tr>
<tr>
<td><code>~+</code></td>
<td>当前的工作目录, 等同于<code>pwd</code></td>
</tr>
<tr>
<td><code>~-</code></td>
<td>上次的工作目录</td>
</tr>
</tbody></table>
<h2 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h2><table>
<thead>
<tr>
<th>bit9</th>
<th>8</th>
<th>7</th>
<th>6</th>
<th>5</th>
<th>4</th>
<th>3</th>
<th>2</th>
<th>1</th>
<th>0</th>
</tr>
</thead>
<tbody><tr>
<td>-</td>
<td>r</td>
<td>w</td>
<td>x</td>
<td>r</td>
<td>-</td>
<td>x</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>bit</th>
<th>字母</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>9</td>
<td></td>
<td>文件类型</td>
</tr>
<tr>
<td></td>
<td><code>d</code></td>
<td>目录(dir)</td>
</tr>
<tr>
<td></td>
<td><code>-</code></td>
<td>文件</td>
</tr>
<tr>
<td></td>
<td><code>l</code></td>
<td>链接文件(link)</td>
</tr>
<tr>
<td></td>
<td><code>b</code></td>
<td>块设备文件(block)</td>
</tr>
<tr>
<td></td>
<td><code>c</code></td>
<td>字符设备文件(character)</td>
</tr>
<tr>
<td></td>
<td><code>s</code></td>
<td>网络接口文件(sockets)</td>
</tr>
<tr>
<td></td>
<td><code>p</code></td>
<td>管道文件(FIFO, pipe)</td>
</tr>
<tr>
<td>876</td>
<td><code>rwx</code></td>
<td>拥有人的权限, r为可读, w为可写, x为可执行</td>
</tr>
<tr>
<td>543</td>
<td><code>r-x</code></td>
<td>同群组的权限, r为可读, -为不可写, x为可执行</td>
</tr>
<tr>
<td>210</td>
<td><code>---</code></td>
<td>其它群组权限, 不可读, 不可写, 不可执行</td>
</tr>
</tbody></table>
<h1 id="文件与目录常用指令"><a href="#文件与目录常用指令" class="headerlink" title="文件与目录常用指令"></a>文件与目录常用指令</h1><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>cd</code></td>
<td><strong>Change Directory</strong>, 变换目录</td>
</tr>
<tr>
<td><code>pwd</code></td>
<td><strong>Print Working Directory</strong>, 显示目前的目录</td>
</tr>
<tr>
<td>…… <strong><code>pwd -P</code></strong></td>
<td>显示真实路径, 而非link路径</td>
</tr>
<tr>
<td><code>mkdir dir</code></td>
<td>Make Directory, 建立一个新的目录</td>
</tr>
<tr>
<td>…… <strong><code>mkdir -p dir1/dir2</code></strong></td>
<td>递归建立所有目录</td>
</tr>
<tr>
<td>…… <strong><code>mkdir -m 711 dir</code></strong></td>
<td>建立目录时,设定权限</td>
</tr>
<tr>
<td><code>rmdir dir</code></td>
<td><strong>Remove Directory</strong>, 删除一个空的目录</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ls</code></td>
<td><strong>List Files</strong>, 显示文件与目录</td>
</tr>
<tr>
<td>…… <strong><code>ls -h</code></strong></td>
<td>以KB,GB显示容量.</td>
</tr>
<tr>
<td>…… <strong><code>ls -R</code></strong></td>
<td>Recursive, 递归显示子目录信息</td>
</tr>
<tr>
<td>…… <strong><code>ls -t</code></strong></td>
<td>以时间排序</td>
</tr>
<tr>
<td>…… <strong><code>ls -S</code></strong></td>
<td>以容量大小排序</td>
</tr>
<tr>
<td>…… <strong><code>ll</code></strong></td>
<td><code>ls –al</code>, List All, 显示所有文件及信息</td>
</tr>
<tr>
<td><code>cp src dst</code></td>
<td>copy</td>
</tr>
<tr>
<td>…… <strong><code>cp -a src dst</code></strong></td>
<td>即<code>cp -pdr</code>, 递归复制目录.不会改变属性和权限</td>
</tr>
<tr>
<td>…… <strong><code>cp -f src dst</code></strong></td>
<td>Force, 强制复制,不询问使用者</td>
</tr>
<tr>
<td>…… <strong><code>cp -u src dst</code></strong></td>
<td>若 src比dst新,才进行复制工作,多用于备份</td>
</tr>
<tr>
<td>…… <strong><code>cp src1 src2 src3 dir</code></strong></td>
<td>将多个原文件拷贝到指定目录</td>
</tr>
<tr>
<td><code>mv src dst</code></td>
<td><strong>move</strong>, 移动目录和文件</td>
</tr>
<tr>
<td><code>rm file_dir</code></td>
<td><strong>remove</strong>, 移除文件</td>
</tr>
<tr>
<td>…… <strong><code>rm -fr dir</code></strong></td>
<td>强制递归删除dir下的所有文件和目录</td>
</tr>
<tr>
<td><code>ln -s src dst</code></td>
<td><strong>Symbolic Link</strong>, 创建一个符号链接</td>
</tr>
<tr>
<td>…… <strong><code>ln file hardLink</code></strong></td>
<td>实际链接, 仅支持同区块下的文件,不占用inode</td>
</tr>
<tr>
<td>…… <strong><code>ln -s dir symbolicLink</code></strong></td>
<td>符号链接, 同快捷方式,为一个文件,占用inode</td>
</tr>
<tr>
<td><code>basename /dir/dir/file</code></td>
<td>结果为<code>file</code>, 路径中取得文件名称</td>
</tr>
<tr>
<td><code>dirname /dir/dir/file</code></td>
<td>结果为<code>/dir/dir</code>, 路径中取得目录名称</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>cat file</code></td>
<td><strong>Concatenate</strong> (连续), 连续显示文件内容</td>
</tr>
<tr>
<td>…… <strong><code>cat -n file</code></strong></td>
<td>在前面加上行号</td>
</tr>
<tr>
<td>…… <strong><code>cat -A</code></strong></td>
<td>即 <code>cat -vET</code>, 可显示一些特殊符号</td>
</tr>
<tr>
<td><code>more</code> <code>less</code> <code>head</code> <code>tail</code></td>
<td>都用于显示文件内容, <code>less</code>功能最强大</td>
</tr>
<tr>
<td><code>od -t x1 file</code></td>
<td>按1byte 十六进制显示文件.若x2则为2byte.</td>
</tr>
<tr>
<td><code>touch file</code></td>
<td>建立一个空文件, 修改文件时间(mtime和atime)</td>
</tr>
<tr>
<td><code>file file</code></td>
<td>读取文件类型</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>umask</code></td>
<td>读取和设置当前默认权限, 数字是被取消的默认权限</td>
</tr>
<tr>
<td>…… <strong><code>umask 022</code></strong></td>
<td>新建文档权限为 777-022 = 755权限</td>
</tr>
<tr>
<td><code>chgrp -R group file_dir</code></td>
<td>递归改变file_dir文件/目录的群组(group必须存在)</td>
</tr>
<tr>
<td><code>chown owner file_dir</code></td>
<td>改变文件或目录的所有者(owner必须存在)</td>
</tr>
<tr>
<td>…… <strong><code>chown -R owner:group dir</code></strong></td>
<td>递归改变dir的所有者和组群</td>
</tr>
<tr>
<td>…… <strong><code>chmod -R 755 file_dir</code></strong></td>
<td>递归改名文件或目录的权限 (7=0b111=rwx)</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>which -a cmd</code></td>
<td>搜索执行文件完整路径</td>
</tr>
<tr>
<td><code>whereis file</code></td>
<td>快速搜索文件(用数据库),实测下来没啥用</td>
</tr>
<tr>
<td><code>find dir -name file</code></td>
<td>搜索文件(整个硬盘),很强大的一个指令</td>
</tr>
<tr>
<td>…… <strong><code>-name</code></strong></td>
<td>表示按文件名搜索. 类似的参数有很多.有需要在查.</td>
</tr>
<tr>
<td><code>grep pattern files</code></td>
<td>在files中寻找 pattern项,支持正则表达式</td>
</tr>
<tr>
<td>…… <strong><code>grep -r “hello” ./*</code></strong></td>
<td>在当前文件夹下的所有文件下搜索 “hello”</td>
</tr>
<tr>
<td>…… <strong><code>grep -n “Test” *</code></strong></td>
<td>在当前文件夹下搜索 “hello”, 并显示行号</td>
</tr>
<tr>
<td>…… <strong><code>grep -i “Bye” *</code></strong></td>
<td>在当前文件夹下忽略大小写搜索 ”Bye”</td>
</tr>
<tr>
<td>…… <strong><code>grep -w “Test” aa bb</code></strong></td>
<td>在aa, bb文件内,只匹配整个单词搜索 “Test”</td>
</tr>
<tr>
<td>…… <strong><code>grep -nd skip 100ask24x0 *</code></strong></td>
<td>仅在当前目录查找, 不显示子目录信息</td>
</tr>
<tr>
<td><code>find ./ -name &quot;*&quot; l(竖杠) xargs grep --color &quot;key&quot;</code></td>
<td>在当前文件夹下查找包含 “key” 内容的文件</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><code>tar -cvf file.tar /dir</code></td>
<td>将/dir打包为file.tar,没有压缩</td>
</tr>
<tr>
<td><code>tar -zcvf file.tar.gz /dir</code></td>
<td>将/dir打包为file.tar.gz,用gzip压缩</td>
</tr>
<tr>
<td><code>tar -jcvf file.tar.bz2 /dir</code></td>
<td>将/dir打包为file.tar.gz2,用bzip2压缩</td>
</tr>
<tr>
<td><code>tar -xvf file.tar</code></td>
<td>还原file.tar到当前目录</td>
</tr>
<tr>
<td><code>tar -zxvf file.tar.gz</code></td>
<td>解压file.tar.gz到当前目录</td>
</tr>
<tr>
<td><code>tar -jxvf file.tar.bz2</code></td>
<td>解压file.tar.bz2到当前目录</td>
</tr>
<tr>
<td><code>tar -N ‘2005/06/01’ -zcvffile.tar.gz /dir</code></td>
<td>将/dir下比2005/06/01新的文件备份</td>
</tr>
<tr>
<td><code>cpio</code></td>
<td>文件/设备的输入输出, 多配合find进行备份</td>
</tr>
</tbody></table>
<ul>
<li><strong><code>find ./ -name &quot;*&quot; | xargs grep --color &quot;key&quot;</code></strong> 在当前文件夹下查找包含 “key” 内容的文件</li>
<li><strong><code>find / -print | cpio -covB &gt; /dev/st0</code></strong> , 将系统数据全部写入磁带机</li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/16/1626-linux-cmd-file/" data-id="cklzzbo9u00243wqo06q90jju" data-title="linux文件与目录相关指令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/command/" rel="tag">command</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1625-linux-cmd-disk" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/15/1625-linux-cmd-disk/" class="article-date">
  <time class="dt-published" datetime="2016-12-14T13:00:00.000Z" itemprop="datePublished">2016-12-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/15/1625-linux-cmd-disk/">linux 系统文件及磁盘指令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="linux-系统文件简要说明"><a href="#linux-系统文件简要说明" class="headerlink" title="linux 系统文件简要说明"></a>linux 系统文件简要说明</h1><p>FHS是Filesystem Hierarchy Standard的简称.FHS定义了两层规范:<br>第一层是/目录下各个主要目录应该放什么文件数据, 例如/etc应该放配置文件,/bin与/sbin则应该放置可执行文件等.<br>第二层则是针对/usr和/var这两个目录的子目录来定义,例如/var/log放置系统登录文件,/usr/share放置共享数据等.<br>单一文件或目录的最大允许文件名为255个字符,包含完整路径的文件名或目录名最大允许为4096个字符.</p>
<table>
<thead>
<tr>
<th>目录</th>
<th>说明</th>
<th>文件内容</th>
</tr>
</thead>
<tbody><tr>
<td><code>/</code></td>
<td>root, 根目录</td>
<td>一般建议只有目录,不要直接放文件. <code>/etc</code> <code>/bin</code> <code>/sbin</code> <code>/dev</code> <code>/lib</code> 必须与 <code>/</code> 同一分区</td>
</tr>
<tr>
<td><code>/bin</code>, <code>/usr/bin</code>, <code>/usr/local/bin</code></td>
<td>Essential command <strong>bin</strong>aries, 普通用户可执行的二进制文件</td>
<td>如 <code>ls</code> <code>mv</code> <code>cat</code> 等指令</td>
</tr>
<tr>
<td><code>/boot</code></td>
<td>Static files of the <strong>boot</strong> loader,  启动时用到的文件</td>
<td>包括 vmlinuz (就是kernel), grub (开机管理)</td>
</tr>
<tr>
<td><code>/dev</code></td>
<td><strong>Dev</strong>ice files, 设备文件</td>
<td>任何设备与接口都是以文件的型态存放在此目录下. 分为<code>字符设备</code>和<code>块设备</code></td>
</tr>
<tr>
<td></td>
<td><code>/dev/null</code></td>
<td>空设备</td>
</tr>
<tr>
<td></td>
<td><code>/dev/tty*</code></td>
<td>串口设备</td>
</tr>
<tr>
<td></td>
<td><code>/dev/hd[a-d][1-63]</code></td>
<td>IDE 硬盘</td>
</tr>
<tr>
<td></td>
<td><code>/dev/sd[a-p][1-20]</code></td>
<td>SCSI硬盘,U盘</td>
</tr>
<tr>
<td></td>
<td><code>/dev/cdrom</code></td>
<td>CDROM</td>
</tr>
<tr>
<td></td>
<td><code>/dev/fd[0-1]</code></td>
<td>软盘</td>
</tr>
<tr>
<td></td>
<td><code>/dev/lp[0-2]</code></td>
<td>并口打印机</td>
</tr>
<tr>
<td></td>
<td><code>/dev/mouse</code></td>
<td>鼠标</td>
</tr>
<tr>
<td></td>
<td>常见<code>sda1-3</code>(主分区),<del><code>sda4</code></del>(扩展分区),<code>sda5..</code>(逻辑分区)</td>
<td>分析:硬盘支持4个主分区,1个扩展分区(占用主分区),16个逻辑分区(SCSI硬盘). 扩展分区文件名不显示.</td>
</tr>
<tr>
<td><code>/etc</code></td>
<td><strong>Etc</strong>etera, 杂项都在此处! 偏系统设置</td>
<td>系统启动(<code>/etc/init</code> <code>/etc/init.d</code>), 账号密码(<code>/etc/passwd</code> <code>/etc/shadow</code>), 开机预设值(<code>/etc/sysconfig/*</code>)</td>
</tr>
<tr>
<td><code>/home</code></td>
<td>User <strong>home</strong> directories, 用户的家目录</td>
<td>放置用户自有的数据, 如音乐图片等</td>
</tr>
<tr>
<td><code>/lib</code> <code>/usr/lib</code> <code>/usr/local/lib</code></td>
<td>Essential shared <strong>lib</strong>raries and kernel modules, 系统使用的函式库的目录</td>
<td><code>/lib/modules</code> 放着kernel的相关模块</td>
</tr>
<tr>
<td><code>/lost+found</code></td>
<td>系统异常时,会将一些遗失的片段放于此目录</td>
<td></td>
</tr>
<tr>
<td><code>/mnt</code></td>
<td><strong>Mount</strong> point for mounting a file system temporarily, 默认挂载点文件的目录</td>
<td>通常软盘挂在<code>/mnt/floppy</code>下,光盘挂在<code>/mnt/cdrom</code>下</td>
</tr>
<tr>
<td><code>/media</code></td>
<td>Contains mount points for replaceable <strong>media</strong></td>
<td><code>/media</code>目录功能与<code>/mnt</code>类似</td>
</tr>
<tr>
<td><code>/opt</code></td>
<td>Add-on application software packages, 主机自行安装软件默认放置的目录</td>
<td>以前较多情况放置在<code>/usr/local</code>目录下</td>
</tr>
<tr>
<td><code>/proc</code></td>
<td>Virtual directory for system information, 虚拟档案系统. 数据都在内存当中,不占用硬盘空间.</td>
<td>主要包括系统核心,接口设备状态,网络状态. 比较重要的档案例: <code>/proc/cpuinfo</code> <code>/proc/dma</code> <code>/proc/interrupts</code> <code>/proc/ioports</code> <code>/proc/net/*</code> 等</td>
</tr>
<tr>
<td><code>/root</code></td>
<td>Home directory for the <strong>root</strong> user 系统管理员的家目录。</td>
<td>一般与根目录<code>/</code>在同一分区下</td>
</tr>
<tr>
<td><code>/sbin</code>, <code>/usr/sbin</code>, <code>/usr/local/sbin</code></td>
<td>Essential system binaries,<strong>S</strong>uper user <strong>bin</strong>aries, 放置系统管理员才会动用到的执行指令</td>
<td>如： <code>fdisk</code> <code>mke2fs</code> <code>fsck</code> <code>mkswap</code> <code>mount</code> 等</td>
</tr>
<tr>
<td><code>/sys</code></td>
<td>Virtual directory for system information (2.6 kernels)</td>
<td></td>
</tr>
<tr>
<td><code>/srv</code></td>
<td>Data for <strong>services</strong> provided by the system, 一些服务启动之后，这些服务所需要取用的数据目录</td>
<td>如WWW 服务器需要的网页就可放在<code>/srv/www</code>内</td>
</tr>
<tr>
<td><code>/tmp</code></td>
<td><strong>Temp</strong>orary files, 这是让一般用户或是正在执行的程序暂时放置文件的目录</td>
<td>这个目录任何人都能够存取的，所以需要定期清理</td>
</tr>
<tr>
<td><code>/usr</code></td>
<td><strong>U</strong>nix <strong>S</strong>hared <strong>R</strong>esources</td>
<td>此目录下包含系统的主要程序,图形界面文件,额外的函式库、本机自行安装的软件，以及共享的目录与文件等</td>
</tr>
<tr>
<td></td>
<td><code>/usr/bin,/usr/sbin</code></td>
<td>可执行的档案放置目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/include</code></td>
<td>c/c++等程序语言的头文件放置目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/lib</code></td>
<td>各应用软件的函数库档案放置目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/local</code></td>
<td>本机自行安装及升级软件默认放置的目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/local/bin</code></td>
<td>自行安装及升级软件后的可执行文件目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/share</code></td>
<td>共享文件放置的目录, 如帮助文档(doc,man)</td>
</tr>
<tr>
<td></td>
<td><code>/usr/src</code></td>
<td>Linux系统相关的程序代码放置目录</td>
</tr>
<tr>
<td></td>
<td><code>/usr/src/linux</code></td>
<td>为Linux Kernel的源码</td>
</tr>
<tr>
<td></td>
<td><code>/usr/X11R6</code></td>
<td>X Window System 所需的执行文件放置目录</td>
</tr>
<tr>
<td><code>/var</code></td>
<td><strong>Var</strong>iable data</td>
<td>主要放置系统执行过程中经常变化的文件</td>
</tr>
<tr>
<td></td>
<td><code>/var/cache</code></td>
<td>程序文件在运作过程中的一些缓存数据</td>
</tr>
<tr>
<td></td>
<td><code>/var/lib</code></td>
<td>程序执行中，使用到的数据库文件放置的目录</td>
</tr>
<tr>
<td></td>
<td><code>/var/log</code></td>
<td>登录文件放置的目录(如/var/log/messages)</td>
</tr>
<tr>
<td></td>
<td><code>/var/run</code></td>
<td>某些程序或是服务启动后,会放置PID在此处</td>
</tr>
<tr>
<td></td>
<td><code>/var/spool</code></td>
<td>是一些数据队列存放的目录,作用为缓冲</td>
</tr>
</tbody></table>
<p><img src="https://draapho.github.io/images/1625/LinuxFileSystem.jpg" alt="LinuxFileSystem"></p>
<h1 id="linux系统分区建议"><a href="#linux系统分区建议" class="headerlink" title="linux系统分区建议"></a>linux系统分区建议</h1><table>
<thead>
<tr>
<th>挂载目录</th>
<th>说明</th>
<th>类型</th>
<th>台式机</th>
<th>嵌入式</th>
</tr>
</thead>
<tbody><tr>
<td><code>/boot</code></td>
<td>启动程序等</td>
<td>ext4</td>
<td>100MB</td>
<td>50MB</td>
</tr>
<tr>
<td><code>/</code></td>
<td>根目录</td>
<td>ext4</td>
<td>1GB-5GB</td>
<td>150-250MB</td>
</tr>
<tr>
<td><code>swap</code></td>
<td>虚拟内存</td>
<td>swap</td>
<td>0/2*ram</td>
<td>看情况</td>
</tr>
<tr>
<td><code>/usr</code></td>
<td>放置系统应用程序</td>
<td>ext4</td>
<td>5GB-20GB</td>
<td>1-5GB</td>
</tr>
<tr>
<td><code>/opt</code></td>
<td>放置大型或测试软件, <strong>建议用户软件都放此处</strong></td>
<td>ext4</td>
<td>10-50GB</td>
<td>使用<code>/usr/local</code></td>
</tr>
<tr>
<td><code>/tmp</code></td>
<td>临时文件</td>
<td>ext4</td>
<td>500M</td>
<td>50-100M</td>
</tr>
<tr>
<td><code>/var</code></td>
<td>放置经常变化的文件</td>
<td>ext4</td>
<td>1GB</td>
<td>300-500M</td>
</tr>
<tr>
<td><code>/home</code></td>
<td>用户家目录</td>
<td>ext4</td>
<td>100G/自定义</td>
<td>看情况</td>
</tr>
</tbody></table>
<h1 id="linux磁盘常用指令"><a href="#linux磁盘常用指令" class="headerlink" title="linux磁盘常用指令"></a>linux磁盘常用指令</h1><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>df</code></td>
<td><strong>disk free</strong>, 查看磁盘相关信息</td>
</tr>
<tr>
<td>…… <strong><code>df -Th</code></strong></td>
<td>查看磁盘容量信息</td>
</tr>
<tr>
<td>…… <strong><code>df -iTh</code></strong></td>
<td>查看磁盘inode信息</td>
</tr>
<tr>
<td><code>du</code></td>
<td><strong>disk usage</strong>, 查看磁盘文件使用情况</td>
</tr>
<tr>
<td>…… <strong><code>du -h</code></strong></td>
<td>列出当前文件夹下所有文件的容量</td>
</tr>
<tr>
<td>…… <strong><code>du -sh file_dir</code></strong></td>
<td>列出指定文件的容量</td>
</tr>
<tr>
<td><code>fdisk</code></td>
<td><strong>format disk</strong>, 磁盘查看及分区</td>
</tr>
<tr>
<td>…… <strong><code>fdisk -l</code></strong></td>
<td>查看整个系统的分区情况</td>
</tr>
<tr>
<td>…… <strong><code>fdisk /dev/sda6</code></strong></td>
<td>对指定磁盘进行配置(进入fdisk命令行模式)</td>
</tr>
<tr>
<td><code>mkfs</code></td>
<td><strong>make filesystem</strong>, 分区格式化</td>
</tr>
<tr>
<td>…… <strong><code>mkfs -t ext4 /dev/sda6</code></strong></td>
<td>格式化sda6分区格式为ext4</td>
</tr>
<tr>
<td><code>fsck</code></td>
<td><strong>filesystem check</strong>, 分区检验和修复</td>
</tr>
<tr>
<td>…… <strong><code>unmount /dev/sda6</code></strong></td>
<td>要检查的分区必须先umount</td>
</tr>
<tr>
<td>…… <strong><code>fsck -y -t ext4 /dev/sda6</code></strong></td>
<td>对sda6分区进行检验和修复</td>
</tr>
<tr>
<td><code>mount</code></td>
<td><strong>mount</strong> 查看和挂载分区</td>
</tr>
<tr>
<td>…… <strong><code>mkdir /mnt/sda_data</code></strong></td>
<td>必须先创建挂载点文件夹</td>
</tr>
<tr>
<td>…… <strong><code>mount -t ext4 /dev/sda6 /mnt/sda_data</code></strong></td>
<td>挂载指定设备sda6到文件夹</td>
</tr>
<tr>
<td><code>umount</code></td>
<td><strong>umount</strong>, 取消挂载点</td>
</tr>
<tr>
<td>…… **<code>umount /dev/sda6</code> **</td>
<td>两种写法都可以</td>
</tr>
<tr>
<td>…… <strong><code>umount /mnt/sda_data</code></strong></td>
<td>两种写法都可以</td>
</tr>
<tr>
<td><code>quato</code></td>
<td><strong>quato</strong>, 管理普通用户的分区配额,多用于服务器.</td>
</tr>
</tbody></table>
<h1 id="mount常见用法及开机自动挂载"><a href="#mount常见用法及开机自动挂载" class="headerlink" title="mount常见用法及开机自动挂载"></a>mount常见用法及开机自动挂载</h1><h2 id="挂载U盘"><a href="#挂载U盘" class="headerlink" title="挂载U盘"></a>挂载U盘</h2><ul>
<li>插入U盘, 用 <code>fdisk -l</code> 或 <code>ll /dev/</code> 下查看U盘的硬件名称, 如 <code>sda11</code></li>
<li>在mnt下建立usb目录 <code>mkdir /mnt/usb</code></li>
<li>挂载U盘  <code>mount -t vfat /dev/sda11 /mnt/usb</code></li>
<li>卸载U盘  <code>umount /mnt/usb</code></li>
<li>拔出U盘</li>
<li>删除mnt目录  <code>rm -fr /mnt/usb</code></li>
</ul>
<h2 id="挂载fat32分区"><a href="#挂载fat32分区" class="headerlink" title="挂载fat32分区"></a>挂载fat32分区</h2><p><code>mount -t vfat -o iocharset=cp936 /dev/sda6 /mnt/fat32</code></p>
<h2 id="挂载ntfs分区"><a href="#挂载ntfs分区" class="headerlink" title="挂载ntfs分区"></a>挂载ntfs分区</h2><p><code>mount -t ntfs -o iocharset=uft8 /dev/sda6 /mnt/ntfs</code></p>
<h2 id="挂载光驱"><a href="#挂载光驱" class="headerlink" title="挂载光驱"></a>挂载光驱</h2><p><code>mount -t iso9660 /dev/hdc /mnt/cdrom</code></p>
<h2 id="重载分区为可读写"><a href="#重载分区为可读写" class="headerlink" title="重载分区为可读写"></a>重载分区为可读写</h2><p>将根目录改为可读写,系统维护时使用<br><code>mount -n -o remount,rw /</code></p>
<h2 id="自动挂载分区"><a href="#自动挂载分区" class="headerlink" title="自动挂载分区"></a>自动挂载分区</h2><p>通过修改 <code>/etc/fstab</code> 实现. 根据规则自行添加行即可.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># &lt;file system&gt;   &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;</span><br><span class="line"># &lt;分区&gt;           &lt;挂载点&gt;      &lt;类型&gt;  &lt;配置&gt;     &lt;备份&gt;  &lt;检查&gt;</span><br><span class="line"></span><br><span class="line"># 以下是通过分区唯一的uuid进行挂载,优点是可绑定指定分区</span><br><span class="line"># 获取uuid指令: &#96;ll &#x2F;dev&#x2F;disk&#x2F;by-uuid&#x2F;&#96;</span><br><span class="line">  UUID&#x3D;xxxx-xxxx  &#x2F;             ext4   errors&#x3D;..  0     1</span><br><span class="line">  UUID&#x3D;xxxx-xxxx  &#x2F;boot         ext4   defaults   0     2</span><br><span class="line">  UUID&#x3D;xxxx-xxxx  &#x2F;home         ext4   defaults   0     2</span><br><span class="line"></span><br><span class="line"># 以下是通过设备文件名进行挂载,优点是直观</span><br><span class="line"># 查看设备文件名指令: &#96;sudo fdisk -l&#96;  (sudo,获取管理员权限)</span><br><span class="line">  &#x2F;dev&#x2F;sda5       &#x2F;mnt&#x2F;data     ext4   defaults   0     2</span><br></pre></td></tr></table></figure>







<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/15/1625-linux-cmd-disk/" data-id="cklzzbo9s001z3wqoh4uf45r2" data-title="linux 系统文件及磁盘指令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/command/" rel="tag">command</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1624-android-ipc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/14/1624-android-ipc/" class="article-date">
  <time class="dt-published" datetime="2016-12-13T13:00:00.000Z" itemprop="datePublished">2016-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/android/">android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/14/1624-android-ipc/">Android中Activity、Service和线程之间的通信</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><em><strong>转载自<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_3fe961ae0100xkyt.html">Android中Activity、Service和线程之间的通信</a></strong></em></p>
<hr>
<h1 id="我的说明"><a href="#我的说明" class="headerlink" title="我的说明"></a>我的说明</h1><p>很全面的总结了几种通讯方式. 是Android深入学习的必经阶段.<br>其实 Activity 和 Activity 间也就下面一些通讯方式,<br>只是从软件结构上讲, 较为复杂的通讯机制是分层的, 一般采用 Activity 纯显示UI, Service后台处理及开线程, Broadcast辅助通讯.</p>
<p>先转载此文作为备忘, 有时间自己在总结一下范例.</p>
<h1 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h1><p>Activity、Service和线程应该是Android编程中最常见的几种类了，几乎大多数应用程序都会涉及到这几个类的编程，<br>自然而然的，也就会涉及到三者之间的相互通信，本文就试图简单地介绍一下这三者通信的方式。</p>
<p>想写这篇文章的起因是，笔者跟几个同学在做一个Android上的应用，起初代码写得很凌乱，因为我在Activity中直接创建了线程，去执行某些任务。<br>但是我们知道线程可能需要运行的时间比较长，而Android在内存不足的时候，会将一些Activity销毁，<br>这样线程就会失去了管理的对象，从而使程序发生意想不到的结果。<br>此外，在Activity中创建线程，线程跟Activity的通信也比较麻烦，一般借助Handler类来进行通信</p>
<p>与Activity相比，Service一般“默默”地运行在后台，生命周期比较长，所以它更合适去为主程序提供某些服务，创建线程并管理线程。<br>因此，笔者将原程序改成三层架构，从高到低分别为：Activity层–Service层–Thread层。<br>Activity将需要的服务“告诉”Service层，Service层创建Thread去完成服务。<br>Thread将任务的进度、状态、错误信息反馈给Service，Service将这些消息反馈给相关的Activity，<br>并且还可以利用Notification更新通知栏消息。大体的结构就是这样。</p>
<h1 id="Activity和Service之间的通信"><a href="#Activity和Service之间的通信" class="headerlink" title="Activity和Service之间的通信"></a>Activity和Service之间的通信</h1><h2 id="利用Handler通信"><a href="#利用Handler通信" class="headerlink" title="利用Handler通信"></a>利用Handler通信</h2><p>参考 <a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_3fe961ae0100mvc5.html">Android在子线程中更新Activity中UI的方法</a></p>
<h2 id="Activity调用startService"><a href="#Activity调用startService" class="headerlink" title="Activity调用startService"></a>Activity调用startService</h2><p>Activity调用startService (Intent service)方法，将消息添加到Intent对象中，<br>这样Service对象可以在调用onStartCommand (Intent intent, int flags, int startId)的时候可以得到这些消息。<br>这种方法很简单，但如果有大量的信息要传递的话，就很麻烦了。因为Service端还要判断一下消息是什么，才能作进一步的动作。</p>
<h2 id="Activity调用bindService"><a href="#Activity调用bindService" class="headerlink" title="Activity调用bindService"></a>Activity调用bindService</h2><p>Activity调用bindService (Intent service, ServiceConnection conn, int flags)方法，<br>得到Service对象的一个引用，这样Activity可以直接调用到Service中的方法。<br>参考 <a target="_blank" rel="noopener" href="http://blog.csdn.net/liuhe688/article/details/6623924">Notification使用详解之三：通过服务更新进度通知&amp;在Activity中监听服务进度</a></p>
<h2 id="Service发送广播通知Activity"><a href="#Service发送广播通知Activity" class="headerlink" title="Service发送广播通知Activity"></a>Service发送广播通知Activity</h2><p>Service向Activity发送消息，除了可以利用Handler外，还可以使用广播，当然Activity要注册相应的接收器<br>比如Service要向多个Activity发送同样的消息的话，用这种方法就更好。具体方法可以看一下这篇文章：<br>参考 <a target="_blank" rel="noopener" href="http://blog.csdn.net/liuhe688/article/details/6641806">Notification使用详解之四：由后台服务向Activity发送进度信息</a></p>
<h1 id="Service跟Thread之间的通信"><a href="#Service跟Thread之间的通信" class="headerlink" title="Service跟Thread之间的通信"></a>Service跟Thread之间的通信</h1><p>Service创建Thread后，如果要对线程进行控制（启动，暂停，停止等），那么Service中应该保留线程的引用，这不用多说。<br>那么有了这个引用，Service就可以直接调用Thread的其它方法了。运行的线程要向Service发送消息的话，通常使用Handler就可以了：<br>参考 <a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_3fe961ae0100mvc5.html">Android在子线程中更新Activity中UI的方法</a></p>
<h1 id="Activity和Thread之间的通信"><a href="#Activity和Thread之间的通信" class="headerlink" title="Activity和Thread之间的通信"></a>Activity和Thread之间的通信</h1><p>不用多想了，直接使用Handler吧。不推荐Activity直接去创建线程，因为不好管理线程。</p>
<hr>
<p><em><strong>转载自<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_3fe961ae0100xkyt.html">Android中Activity、Service和线程之间的通信</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/14/1624-android-ipc/" data-id="cklzzbo9s001w3wqo0bv30kkq" data-title="Android中Activity、Service和线程之间的通信" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/android/" rel="tag">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/ipc/" rel="tag">ipc</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1623-python-debug" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/12/13/1623-python-debug/" class="article-date">
  <time class="dt-published" datetime="2016-12-12T13:00:00.000Z" itemprop="datePublished">2016-12-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/12/13/1623-python-debug/">Python 调试及测试</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>常用的方法有:</p>
<ul>
<li>print, 仅作临时测试, 而且还要删除.</li>
<li>assert, 同print, 无明显优势.</li>
<li>logging, 推荐使用. 可选级别, 可选输出方式, 适用于各种情况的调试.</li>
<li>pdb 以及 基于pdb的图形化工具.</li>
<li>python的IDE, 如PyCharm(推荐), eclipse+PyDev</li>
</ul>
<h2 id="logging"><a href="#logging" class="headerlink" title="logging"></a>logging</h2><h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;默认日志输出为终端, 设置日志等级, DEBUG=LEVEL10, 优先级最低&#x27;&#x27;&#x27;</span></span><br><span class="line">    logging.basicConfig(level=logging.DEBUG)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;更多设置&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># logging.basicConfig(level=logging.DEBUG,</span></span><br><span class="line">    <span class="comment">#                     format=&#x27;%(asctime)s %(filename)-s[%(lineno)d] %(levelname)-8s: %(message)s&#x27;)</span></span><br><span class="line"></span><br><span class="line">    logging.debug(<span class="string">&#x27;DEBUG message&#x27;</span>)</span><br><span class="line">    logging.info(<span class="string">&#x27;INFO message&#x27;</span>)</span><br><span class="line">    logging.warn(<span class="string">&#x27;WARN message&#x27;</span>)</span><br><span class="line">    logging.error(<span class="string">&#x27;ERROR message&#x27;</span>)</span><br><span class="line">    logging.critical(<span class="string">&#x27;CRITICAL message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="自定义显示格式"><a href="#自定义显示格式" class="headerlink" title="自定义显示格式"></a>自定义显示格式</h3><p>日志输出到 <code>logger.log</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;设置显示格式, 日志输出到文件&#x27;&#x27;&#x27;</span></span><br><span class="line">    logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">                        <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s %(filename)-s[%(lineno)d] %(levelname)-8s: %(message)s&#x27;</span>,</span><br><span class="line">                        filename=<span class="string">&#x27;logger.log&#x27;</span>,</span><br><span class="line">                        filemode=<span class="string">&#x27;w&#x27;</span>) <span class="comment"># default is &#x27;a&#x27;=append, &#x27;w&#x27;=overwrite</span></span><br><span class="line"></span><br><span class="line">    logging.debug(<span class="string">&#x27;This is debug message&#x27;</span>)</span><br><span class="line">    logging.info(<span class="string">&#x27;This is info message&#x27;</span>)</span><br><span class="line">    logging.warning(<span class="string">&#x27;This is warning message&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p>日志输出到 <code>logger.log</code> 以及终端</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">                        <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s %(filename)s[%(lineno)d] %(levelname)-8s: %(message)s&#x27;</span>,</span><br><span class="line">                        filename=<span class="string">&#x27;logger.log&#x27;</span>,</span><br><span class="line">                        filemode=<span class="string">&#x27;w&#x27;</span>) <span class="comment"># default is &#x27;a&#x27;=append, &#x27;w&#x27;=overwrite</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    定义一个StreamHandler，将INFO级别或更高的日志信息打印到标准错误，并将其添加到当前的日志处理对象</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    console = logging.StreamHandler()</span><br><span class="line">    console.setLevel(logging.INFO)</span><br><span class="line">    formatter = logging.Formatter(<span class="string">&#x27;%(levelname)-8s: %(message)s&#x27;</span>)</span><br><span class="line">    console.setFormatter(formatter)</span><br><span class="line">    logging.getLogger(<span class="string">&#x27;&#x27;</span>).addHandler(console)</span><br><span class="line"></span><br><span class="line">    logging.debug(<span class="string">&#x27;This is debug message&#x27;</span>)</span><br><span class="line">    logging.info(<span class="string">&#x27;This is info message&#x27;</span>)</span><br><span class="line">    logging.warning(<span class="string">&#x27;This is warning message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="使用文件配置"><a href="#使用文件配置" class="headerlink" title="使用文件配置"></a>使用文件配置</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#logging.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line">[loggers]</span><br><span class="line">keys=root</span><br><span class="line"></span><br><span class="line">[logger_root]</span><br><span class="line">level=DEBUG</span><br><span class="line">handlers=hand01,hand02</span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line">[handlers]</span><br><span class="line">keys=hand01,hand02,hand03</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入终端</span></span><br><span class="line">[handler_hand01]</span><br><span class="line">class=StreamHandler</span><br><span class="line">level=DEBUG</span><br><span class="line">formatter=form01</span><br><span class="line">args=(sys.stderr,)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入文件, &#x27;w&#x27;覆写, &#x27;a&#x27;追加</span></span><br><span class="line">[handler_hand02]</span><br><span class="line">class=FileHandler</span><br><span class="line">level=INFO</span><br><span class="line">formatter=form01</span><br><span class="line">args=(<span class="string">&#x27;logging.log&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最多备份5个日志文件，每个日志文件最大10M</span></span><br><span class="line">[handler_hand03]</span><br><span class="line">class=handlers.RotatingFileHandler</span><br><span class="line">level=INFO</span><br><span class="line">formatter=form01</span><br><span class="line">args=(<span class="string">&#x27;logging.log&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">10</span>*<span class="number">1024</span>*<span class="number">1024</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line">[formatters]</span><br><span class="line">keys=form01</span><br><span class="line"></span><br><span class="line">[formatter_form01]</span><br><span class="line"><span class="built_in">format</span>=%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)-8s: %(message)s</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">from</span> logging.config <span class="keyword">import</span> fileConfig</span><br><span class="line">    fileConfig(<span class="string">&quot;logging.conf&quot;</span>)</span><br><span class="line"></span><br><span class="line">    logging.debug(<span class="string">&#x27;This is debug message&#x27;</span>)</span><br><span class="line">    logging.info(<span class="string">&#x27;This is info message&#x27;</span>)</span><br><span class="line">    logging.warning(<span class="string">&#x27;This is warning message&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="更多应用参考手册"><a href="#更多应用参考手册" class="headerlink" title="更多应用参考手册"></a>更多应用参考手册</h3><ul>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/3.1/library/logging.html">15.6. logging — Logging facility for Python</a><ul>
<li>15.6.11. Sending and receiving logging events across a network</li>
<li>15.6.20.2. Configuration file format</li>
<li>15.6.20.3. Configuration server example</li>
<li>15.6.21. More examples</li>
</ul>
</li>
</ul>
<h2 id="pdb"><a href="#pdb" class="headerlink" title="pdb"></a>pdb</h2><p>进入调试模式 <code>python -m pdb example.py</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python -m pdb example.py</span></span><br><span class="line">(Pdb)</span><br></pre></td></tr></table></figure>

<p>pdb 常用命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 断点</span><br><span class="line">(Pdb) b 10          # 断点设置在当前文件的第10行</span><br><span class="line">(Pdb) tbreak 10     # temp  break, 临时断点, 执行后会自动删除</span><br><span class="line">(Pdb) b my.py:20    # 断点设置到 my.py第20行</span><br><span class="line">(Pdb) b             # break, 查看断点编号</span><br><span class="line">(Pdb) cl 2          # clear, 删除第2个断点</span><br><span class="line">(Pdb) disable 2     # 禁用第2个断点</span><br><span class="line">(Pdb) enable 2      # 使能第2个断点</span><br><span class="line">(Pdb) ignore 2 10   # 略过第2个断点10次, 循环调试特别有用!</span><br><span class="line">(Pdb) condition 2 (i&gt;10)    # 条件为真时,使能断点</span><br><span class="line"></span><br><span class="line"># 运行</span><br><span class="line">(Pdb) n             # next, 单步运行</span><br><span class="line">(Pdb) s             # step, 进入方法</span><br><span class="line">(Pdb) r             # return, 返回上级方法</span><br><span class="line">(Pdb) c             # continue, 跳到下个断点</span><br><span class="line"></span><br><span class="line"># 查看</span><br><span class="line">(Pdb) p param       # print, 查看当前 变量值</span><br><span class="line">(Pdb) l             # list, 查看运行到某处代码</span><br><span class="line">(Pdb) a             # args, 查看全部栈内变量</span><br><span class="line">(Pdb) w             # where, 堆栈信息</span><br><span class="line"></span><br><span class="line"># 其它</span><br><span class="line">(Pdb) h             # help, 帮助</span><br><span class="line">(Pdb) q             # quit, 退出调试</span><br></pre></td></tr></table></figure>

<p>使用alias设置别名, 可大大提高调试速度!<br><strong>将下述文件存储为 <code>.pdbrc</code>, 然后放在系统目录 <code>~</code> 或 项目目录下, pdb会自动加载.</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># name it as &quot;.pdbrc&quot;, then put into ~ or project folder</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print a dictionary, sorted. %1 is the dict, %2 is the prefix for the names.</span></span><br><span class="line">alias p_ <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">sorted</span>(%<span class="number">1.</span>keys()): <span class="built_in">print</span> <span class="string">&quot;%s%-15s= %-80.80s&quot;</span> % (<span class="string">&quot;%2&quot;</span>,k,<span class="built_in">repr</span>(%<span class="number">1</span>[k]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the instance variables of a thing.</span></span><br><span class="line">alias pi p_ %<span class="number">1.</span>__dict__ %<span class="number">1.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the instance variables of self.</span></span><br><span class="line">alias ps pi self</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the locals.</span></span><br><span class="line">alias pl p_ <span class="built_in">locals</span>() local:</span><br><span class="line"></span><br><span class="line"><span class="comment"># Next and list, and step and list.</span></span><br><span class="line">alias nl n;;l</span><br><span class="line">alias sl s;;l</span><br><span class="line"></span><br><span class="line"><span class="comment"># go to line</span></span><br><span class="line">alias gl tbreak %*;;c %*;;l</span><br><span class="line"></span><br><span class="line"><span class="comment"># go to next</span></span><br><span class="line">alias g1 n;;l</span><br><span class="line">alias g2 n;;n;;l</span><br><span class="line">alias g3 n;;n;;n;;l</span><br><span class="line">alias g4 n;;n;;n;;n;;l</span><br><span class="line">alias g5 n;;n;;n;;n;;n;;l</span><br><span class="line">alias g6 n;;n;;n;;n;;n;;n;;nl</span><br><span class="line">alias g7 n;;n;;n;;n;;n;;n;;n;;l</span><br><span class="line">alias g8 n;;n;;n;;n;;n;;n;;n;;n;;l</span><br><span class="line">alias g9 n;;n;;n;;n;;n;;n;;n;;n;;n;;l</span><br><span class="line"></span><br><span class="line"><span class="comment"># Short cuts for walking up and down the stack</span></span><br><span class="line">alias uu u;;u</span><br><span class="line">alias uuu u;;u;;u</span><br><span class="line">alias uuuu u;;u;;u;;u</span><br><span class="line">alias uuuuu u;;u;;u;;u;;u</span><br><span class="line">alias dd d;;d</span><br><span class="line">alias ddd d;;d;;d</span><br><span class="line">alias dddd d;;d;;d;;d</span><br><span class="line">alias ddddd d;;d;;d;;d;;d</span><br></pre></td></tr></table></figure>


<h2 id="查看函数调用"><a href="#查看函数调用" class="headerlink" title="查看函数调用"></a>查看函数调用</h2><p>使用如下的装饰器, 即可观察该函数被调用的情况</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findcaller</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">import</span> sys</span><br><span class="line">        f = sys._getframe()</span><br><span class="line">        filename = f.f_back.f_code.co_filename</span><br><span class="line">        lineno = f.f_back.f_lineno</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;######################################&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;&#123;&#125;, args: &#123;&#125;, &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(func, args, kwargs)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;called by &#123;&#125;, line &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(filename, lineno)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;######################################&#x27;</span></span><br><span class="line">        func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># example</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@findcaller</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name=<span class="string">&#x27;world&#x27;</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;hello&quot;</span>, name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    hello(<span class="string">&#x27;DRA&amp;PHO&#x27;</span>)</span><br></pre></td></tr></table></figure>


<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><h2 id="doctest"><a href="#doctest" class="headerlink" title="doctest"></a>doctest</h2><p>简单的函数测试个人比较喜欢使用doctest, 因为一举两得, 即可以做测试案例, 又是极好的代码注释和范例<br>输出和预期一致时, 没有任何提醒. 输出和预期不一致时, 就会弹出错误.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name=<span class="string">&#x27;world&#x27;</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; hello()</span></span><br><span class="line"><span class="string">    hello world</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; hello(&#x27;DRA&amp;PHO&#x27;)</span></span><br><span class="line"><span class="string">    hello, DRA&amp;PHO</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;hello&quot;</span>, name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> doctest</span><br><span class="line">    doctest.testmod()</span><br></pre></td></tr></table></figure>

<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/00140137128705556022982cfd844b38d050add8565dcb9000">unittest</a>, 更专业的一种测试方法, 可批量执行</li>
<li><a target="_blank" rel="noopener" href="http://pythonguidecn.readthedocs.io/zh/latest/writing/tests.html">Python指南-测试你的代码</a><ul>
<li>单元测试(unittest)</li>
<li>文档测试(doctest)</li>
<li>测试工具: py.test, nose, tox, Unittest2, mock</li>
</ul>
</li>
</ul>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><p><a target="_blank" rel="noopener" href="http://blog.csdn.net/yatere/article/details/6655445">python 的日志logging模块学习</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/feb86c06c4f4">python logging模块使用教程</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.python.org/3.1/library/logging.html">15.6. logging — Logging facility for Python</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://pythonconquerstheuniverse.wordpress.com/category/python-debugger/">Debugging in Python</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.onlamp.com/pub/a/python/2005/09/01/debugger.html">Interactive Debugging in Python</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/00140137128705556022982cfd844b38d050add8565dcb9000">廖雪峰的官方网站-单元测试</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://pythonguidecn.readthedocs.io/zh/latest/writing/tests.html">Python 指南-测试你的代码</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/ae5bc6093337">python笔记_查看函数调用栈的一个小技巧</a></p>
</li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/12/13/1623-python-debug/" data-id="cklzzbo9r001t3wqoad5q0j2b" data-title="Python 调试及测试" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/debug/" rel="tag">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1622-python-time" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2016/11/28/1622-python-time/" class="article-date">
  <time class="dt-published" datetime="2016-11-27T13:00:00.000Z" itemprop="datePublished">2016-11-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/Blog/2016/11/28/1622-python-time/">python 延时及超时</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="实用的例子"><a href="#实用的例子" class="headerlink" title="实用的例子"></a>实用的例子</h1><h2 id="time-sleep-单线程阻塞延时"><a href="#time-sleep-单线程阻塞延时" class="headerlink" title="time.sleep 单线程阻塞延时"></a><code>time.sleep</code> 单线程阻塞延时</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">time_sleep</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span> i</span><br><span class="line">        time.sleep(<span class="number">1</span>)       <span class="comment"># delay 1s, not that accurate</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    time_sleep()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h2 id="time-time-单线程非阻塞延时-超时"><a href="#time-time-单线程非阻塞延时-超时" class="headerlink" title="time.time 单线程非阻塞延时/超时"></a><code>time.time</code> 单线程非阻塞延时/超时</h2><p>通过比较时间戳实现, 多用于循环中的延时/超时判断</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">time_compare</span>():</span></span><br><span class="line">    timeout = time.time() + <span class="number">10</span>  <span class="comment"># 10s delay</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        <span class="built_in">print</span> i</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> timeout &lt; time.time(): <span class="comment"># compare the timestamps</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;time out !&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    time_compare()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h2 id="threading-Timer-多线程非阻塞延时"><a href="#threading-Timer-多线程非阻塞延时" class="headerlink" title="threading.Timer 多线程非阻塞延时"></a><code>threading.Timer</code> 多线程非阻塞延时</h2><p>这个例子中, 会先执行完 <code>threading_main</code>. 5s后, 才会执行 <code>threading_sub</code><br>子线程函数可以带参 <code>threading.Timer(interval, function, args=[], kwargs=&#123;&#125;)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_main</span>():</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: start&quot;</span></span><br><span class="line">    thrd = threading.Timer(<span class="number">5.0</span>, threading_sub, args = [<span class="string">&quot;sub thread&quot;</span>])</span><br><span class="line">    thrd.start()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_sub</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span> name + <span class="string">&quot;: hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    threading_main()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h2 id="threading-Timer-threading-join-多线程阻塞延时"><a href="#threading-Timer-threading-join-多线程阻塞延时" class="headerlink" title="threading.Timer + threading.join 多线程阻塞延时"></a><code>threading.Timer</code> + <code>threading.join</code> 多线程阻塞延时</h2><p>使用 <code>join</code> 语句, 让主线程等待子线程完成后才继续执行<br>子线程函数可以带参 <code>threading.Timer(interval, function, args=[], kwargs=&#123;&#125;)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_main</span>():</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: start&quot;</span></span><br><span class="line">    thrd = threading.Timer(<span class="number">5.0</span>, threading_sub, args = [<span class="string">&quot;sub thread&quot;</span>])</span><br><span class="line">    thrd.start()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: wait&quot;</span></span><br><span class="line">    thrd.join()     <span class="comment"># add this line</span></span><br><span class="line">    <span class="comment"># thrd.join(timeout=2)  # just wait 2s then continue</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_sub</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span> name + <span class="string">&quot;: hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    threading_main()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h1 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h1><h2 id="装饰器-使用KThread-localtrace结束线程-通用性最好-性能较低"><a href="#装饰器-使用KThread-localtrace结束线程-通用性最好-性能较低" class="headerlink" title="装饰器, 使用KThread,.localtrace结束线程. (通用性最好, 性能较低)"></a>装饰器, 使用<code>KThread,.localtrace</code>结束线程. (通用性最好, 性能较低)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Timeout</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;function run timeout&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KThread</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        threading.Thread.__init__(self, *args, **kwargs)</span><br><span class="line">        self.killed = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Start the thread.&quot;&quot;&quot;</span></span><br><span class="line">        self.__run_backup = self.run</span><br><span class="line">        <span class="comment"># Force the Thread to install our trace.</span></span><br><span class="line">        self.run = self.__run</span><br><span class="line">        threading.Thread.start(self)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Hacked run function, which installs the trace.&quot;&quot;&quot;</span></span><br><span class="line">        sys.settrace(self.globaltrace)</span><br><span class="line">        self.__run_backup()</span><br><span class="line">        self.run = self.__run_backup</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">globaltrace</span>(<span class="params">self, frame, why, arg</span>):</span></span><br><span class="line">        <span class="keyword">if</span> why == <span class="string">&#x27;call&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.localtrace</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">localtrace</span>(<span class="params">self, frame, why, arg</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.killed:</span><br><span class="line">            <span class="keyword">if</span> why == <span class="string">&#x27;line&#x27;</span>:</span><br><span class="line">                <span class="keyword">raise</span> SystemExit()</span><br><span class="line">        <span class="keyword">return</span> self.localtrace</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kill</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.killed = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout</span>(<span class="params">timeout, default=<span class="literal">None</span>, try_except=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Timeout decorator, parameter in timeout.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">timeout_decorator</span>(<span class="params">func</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">new_func</span>(<span class="params">oldfunc, result, oldfunc_args, oldfunc_kwargs</span>):</span></span><br><span class="line">            result.append(oldfunc(*oldfunc_args, **oldfunc_kwargs))</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Wrap the original function.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func_wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            result = []</span><br><span class="line">            <span class="comment"># create new args for _new_func, because we want to get the func</span></span><br><span class="line">            <span class="comment"># return val to result list</span></span><br><span class="line">            new_kwargs = &#123;</span><br><span class="line">                <span class="string">&#x27;oldfunc&#x27;</span>: func,</span><br><span class="line">                <span class="string">&#x27;result&#x27;</span>: result,</span><br><span class="line">                <span class="string">&#x27;oldfunc_args&#x27;</span>: args,</span><br><span class="line">                <span class="string">&#x27;oldfunc_kwargs&#x27;</span>: kwargs</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            thd = KThread(target=new_func, args=(), kwargs=new_kwargs)</span><br><span class="line">            thd.start()</span><br><span class="line">            thd.join(timeout)</span><br><span class="line">            <span class="comment"># timeout or finished?</span></span><br><span class="line">            isAlive = thd.isAlive()</span><br><span class="line">            thd.kill()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> isAlive:</span><br><span class="line">                <span class="keyword">if</span> try_except <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">                    <span class="keyword">raise</span> Timeout(<span class="string">&quot;&#123;&#125; Timeout: &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(func, timeout))</span><br><span class="line">                <span class="keyword">return</span> default</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> result[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        func_wrapper.__name__ = func.__name__</span><br><span class="line">        func_wrapper.__doc__ = func.__doc__</span><br><span class="line">        <span class="keyword">return</span> func_wrapper</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> timeout_decorator</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">    @timeout(<span class="params"><span class="number">5</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">name</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            print(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, i))</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;finished&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span> count(<span class="string">&quot;thread1&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> count(<span class="string">&quot;thread2&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Timeout <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span> e</span><br></pre></td></tr></table></figure>

<p>将上面的例子, 改为函数调用模式, 这样timeout参数可灵活设置!</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Timeout</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;function run timeout&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KThread</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        threading.Thread.__init__(self, *args, **kwargs)</span><br><span class="line">        self.killed = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Start the thread.&quot;&quot;&quot;</span></span><br><span class="line">        self.__run_backup = self.run</span><br><span class="line">        <span class="comment"># Force the Thread to install our trace.</span></span><br><span class="line">        self.run = self.__run</span><br><span class="line">        threading.Thread.start(self)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Hacked run function, which installs the trace.&quot;&quot;&quot;</span></span><br><span class="line">        sys.settrace(self.globaltrace)</span><br><span class="line">        self.__run_backup()</span><br><span class="line">        self.run = self.__run_backup</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">globaltrace</span>(<span class="params">self, frame, why, arg</span>):</span></span><br><span class="line">        <span class="keyword">if</span> why == <span class="string">&#x27;call&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.localtrace</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">localtrace</span>(<span class="params">self, frame, why, arg</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.killed:</span><br><span class="line">            <span class="keyword">if</span> why == <span class="string">&#x27;line&#x27;</span>:</span><br><span class="line">                <span class="keyword">raise</span> SystemExit()</span><br><span class="line">        <span class="keyword">return</span> self.localtrace</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kill</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.killed = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout_call</span>(<span class="params">timeout, func, args=(<span class="params"></span>), kwargs=<span class="literal">None</span>, default=<span class="literal">None</span>, try_except=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_func</span>(<span class="params">oldfunc, result, oldfunc_args, oldfunc_kwargs</span>):</span></span><br><span class="line">            result.append(oldfunc(*oldfunc_args, **oldfunc_kwargs))</span><br><span class="line"></span><br><span class="line">    result = []</span><br><span class="line">    kwargs = &#123;&#125; <span class="keyword">if</span> kwargs <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> kwargs</span><br><span class="line">    <span class="comment"># create new args for _new_func, because we want to get the func</span></span><br><span class="line">    <span class="comment"># return val to result list</span></span><br><span class="line">    new_kwargs = &#123;</span><br><span class="line">        <span class="string">&#x27;oldfunc&#x27;</span>: func,</span><br><span class="line">        <span class="string">&#x27;result&#x27;</span>: result,</span><br><span class="line">        <span class="string">&#x27;oldfunc_args&#x27;</span>: args,</span><br><span class="line">        <span class="string">&#x27;oldfunc_kwargs&#x27;</span>: kwargs</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    thd = KThread(target=new_func, args=(), kwargs=new_kwargs)</span><br><span class="line">    thd.start()</span><br><span class="line">    thd.join(timeout)</span><br><span class="line">    <span class="comment"># timeout or finished?</span></span><br><span class="line">    isAlive = thd.isAlive()</span><br><span class="line">    thd.kill()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> isAlive:</span><br><span class="line">        <span class="keyword">if</span> try_except <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">raise</span> Timeout(<span class="string">&quot;&#123;&#125; Timeout: &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(func, timeout))</span><br><span class="line">        <span class="keyword">return</span> default</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">name</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            print(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, i))</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;finished&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span> timeout_call(<span class="number">5</span>, count, [<span class="string">&quot;thread1&quot;</span>])</span><br><span class="line">        <span class="built_in">print</span> timeout_call(<span class="number">5</span>, count, [<span class="string">&quot;thread2&quot;</span>])</span><br><span class="line">    <span class="keyword">except</span> Timeout <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span> e</span><br></pre></td></tr></table></figure>


<h2 id="装饰器-使用thread-interrupt-main-结束线程-仅可用于主线程"><a href="#装饰器-使用thread-interrupt-main-结束线程-仅可用于主线程" class="headerlink" title="装饰器, 使用thread.interrupt_main()结束线程. (仅可用于主线程)"></a>装饰器, 使用<code>thread.interrupt_main()</code>结束线程. (仅可用于主线程)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> thread</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout_quit</span>(<span class="params">fn_name</span>):</span></span><br><span class="line">    thread.interrupt_main()     <span class="comment"># raises KeyboardInterrupt</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    use as decorator to exit process if</span></span><br><span class="line"><span class="string">    function takes longer than s seconds</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">fn</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            timer = threading.Timer(s, timeout_quit, args=[fn.__name__])</span><br><span class="line">            timer.start()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result = fn(*args, **kwargs)</span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                timer.cancel()</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">return</span> inner</span><br><span class="line">    <span class="keyword">return</span> outer</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">    @timeout(<span class="params"><span class="number">5</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">processNum</span>(<span class="params">num</span>):</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span> processNum(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;timeout&quot;</span></span><br></pre></td></tr></table></figure>


<h1 id="学习过程中的例子"><a href="#学习过程中的例子" class="headerlink" title="学习过程中的例子"></a>学习过程中的例子</h1><h2 id="threading-Timer-threading-join-多线程阻塞延时-1"><a href="#threading-Timer-threading-join-多线程阻塞延时-1" class="headerlink" title="threading.Timer + threading.join 多线程阻塞延时"></a><code>threading.Timer</code> + <code>threading.join</code> 多线程阻塞延时</h2><p>使用 <code>join</code> 语句, 让主线程等待子线程完成后才继续执行<br>子线程函数可以带参 <code>threading.Timer(interval, function, args=[], kwargs=&#123;&#125;)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_main</span>():</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: start&quot;</span></span><br><span class="line">    thrd = threading.Timer(<span class="number">5.0</span>, threading_sub, args = [<span class="string">&quot;sub thread&quot;</span>])</span><br><span class="line">    thrd.start()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: wait&quot;</span></span><br><span class="line">    thrd.join()     <span class="comment"># add this line</span></span><br><span class="line">    <span class="comment"># thrd.join(timeout=2)  # just wait 2s then continue</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main thread: end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threading_sub</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span> name + <span class="string">&quot;: hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    threading_main()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h2 id="join-timeout-10-多进程超时判断"><a href="#join-timeout-10-多进程超时判断" class="headerlink" title="join(timeout=10) 多进程超时判断"></a><code>join(timeout=10)</code> 多进程超时判断</h2><p><code>multiprocessing</code>的本质是进程, 但是提供了类似于<code>threading</code>的一系列方法.<br>使用 <code>multiprocessing.terminate</code> 语句, 让主线程可以杀死子线程<br>子进程函数可以带参 multiprocessing.Process(group=None, target=None, name=None, args=(), kwargs={})<br>multiprocessing 没有 <code>Timer()</code> 方法的, 无法方便的延时执行.</p>
<p>注意, 这里没有办法使用 threading 类来实现. 因为没有 <code>terminate()</code> 方法,<br>而如果用<code>signal</code>方法来结束线程, 有两个限制. 1, windows不支持. 2, 子线程不支持</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">processing_main</span>():</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main process: start&quot;</span></span><br><span class="line">    prcs = multiprocessing.Process(</span><br><span class="line">        target=processing_sub, args=[<span class="string">&quot;sub process&quot;</span>])</span><br><span class="line">    prcs.start()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main process: wait&quot;</span></span><br><span class="line">    prcs.join(timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># If thread is still active</span></span><br><span class="line">    <span class="keyword">if</span> prcs.is_alive():</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;main process: kill&quot;</span></span><br><span class="line">        prcs.terminate()</span><br><span class="line">        prcs.join()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;main process: end&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">processing_sub</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="comment"># if use print, can not show immediately in the console.</span></span><br><span class="line">        logging.error(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, i))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    processing_main()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>


<h2 id="multiprocessing-pool-实现超时判断"><a href="#multiprocessing-pool-实现超时判断" class="headerlink" title="multiprocessing.pool 实现超时判断"></a><code>multiprocessing.pool</code> 实现超时判断</h2><p>说说python下的 thread 和 process.<br>thread, 提供了signal结束方式, 但是windows不支持, 仅主线程可用! 换句话说, 终止线程很繁琐<br>process, 提供了terminate结束方式, 但是参数传递限制条件很多, (必须可以是pickle的…)</p>
<p><strong>下面的代码是有问题的!!!</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing.pool</span><br><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout</span>(<span class="params">timeout, default=<span class="literal">None</span>, try_except=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Timeout decorator, parameter in seconds.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">timeout_decorator</span>(<span class="params">item</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Wrap the original function.&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">        @functools.wraps(<span class="params">item</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func_wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            <span class="string">&quot;&quot;&quot;Closure for function.&quot;&quot;&quot;</span></span><br><span class="line">            pool = multiprocessing.pool.ThreadPool(processes=<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># pool = multiprocessing.pool.Pool(processes=1) ## raise error about pickle problem!!!</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                async_result = pool.apply_async(item, args, kwargs)</span><br><span class="line">                val = async_result.get(timeout)</span><br><span class="line">            <span class="keyword">except</span> multiprocessing.TimeoutError:</span><br><span class="line">                pool.terminate() <span class="comment">## not work here, because it is acutally thread, not process!!!</span></span><br><span class="line">                val = default</span><br><span class="line">                <span class="keyword">if</span> try_except <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">                    <span class="keyword">raise</span> multiprocessing.TimeoutError</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pool.close()</span><br><span class="line">                pool.join()</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line">        <span class="keyword">return</span> func_wrapper</span><br><span class="line">    <span class="keyword">return</span> timeout_decorator</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">    @timeout(<span class="params"><span class="number">5</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">name</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            print(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, i))</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;finished&quot;</span></span><br><span class="line"></span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span> count(<span class="string">&quot;thread1&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span> count(<span class="string">&quot;thread2&quot;</span>)  <span class="comment">## you can find problem here, thread1 is still running...</span></span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout_call</span>(<span class="params">timeout, func, args=(<span class="params"></span>), kwargs=<span class="literal">None</span>, default=<span class="literal">None</span>, try_except=<span class="literal">False</span></span>):</span></span><br><span class="line">    kwargs = &#123;&#125; <span class="keyword">if</span> kwargs <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> kwargs</span><br><span class="line">    pool = multiprocessing.Pool(processes=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        async_result = pool.apply_async(func, args, kwargs)</span><br><span class="line">        val = async_result.get(timeout)</span><br><span class="line">    <span class="keyword">except</span> multiprocessing.TimeoutError:</span><br><span class="line">        pool.terminate()</span><br><span class="line">        val = default</span><br><span class="line">        <span class="keyword">if</span> try_except <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">raise</span> multiprocessing.TimeoutError</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pool.close()</span><br><span class="line">        pool.join()</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"><span class="comment">################### example ##########</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        logging.error(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, i))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;finished&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">## if count function is here, will raise error!!!</span></span><br><span class="line"></span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span> timeout_call(<span class="number">5</span>, count, [<span class="string">&quot;process1&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span> timeout_call(<span class="number">5</span>, count, [<span class="string">&quot;process2&quot;</span>])</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;run time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(end - start)</span><br></pre></td></tr></table></figure>

<h2 id="第三方方案"><a href="#第三方方案" class="headerlink" title="第三方方案"></a>第三方方案</h2><ul>
<li><a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/timeoutcontext/1.1.1">timeoutcontext 1.1.1</a><ul>
<li>基于signal实现, 不支持windows系统, 不支持子线程</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/timeout-decorator/0.3.2">timeout-decorator 0.3.2</a><ul>
<li>signal或Multithreading可选</li>
<li>使用signal时, 不支持windows, 不支持子线程</li>
<li>使用Multithreading时, 无法返回不能pickle的数据(因为需要通过pickle来跨进程交换数据)</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/stopit#stopit-threading-timeoutable">stopit 1.1.1</a><ul>
<li>threading或signal可选</li>
<li>计时误差太大, 不可接受(翻倍的误差)</li>
</ul>
</li>
</ul>
<h2 id="使用gevent协程"><a href="#使用gevent协程" class="headerlink" title="使用gevent协程"></a>使用gevent协程</h2><p>参考 <a target="_blank" rel="noopener" href="http://xlambda.com/gevent-tutorial/#_6">gevent程序员指南之超时</a><br>参考 <a target="_blank" rel="noopener" href="https://my.oschina.net/1123581321/blog/208671">gevent 延时、定时、超时、io等待、动态添加任务</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> Timeout</span><br><span class="line"></span><br><span class="line">time_to_wait = <span class="number">5</span> <span class="comment"># seconds</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TooLong</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Timeout(time_to_wait, TooLong):</span><br><span class="line">    gevent.sleep(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>




<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/492519/timeout-on-a-function-call">Timeout on a function call</a>, 关于此问题的讨论(signal / multiprocessing)</li>
<li><a target="_blank" rel="noopener" href="https://my.oschina.net/leejun2005/blog/607741">论 Python 装饰器控制函数 Timeout 的正确姿势</a>, 装饰器方式, 性能较低</li>
<li><a target="_blank" rel="noopener" href="http://xlambda.com/gevent-tutorial/">gevent程序员指南</a></li>
<li><a target="_blank" rel="noopener" href="https://my.oschina.net/1123581321/blog/208671">gevent 延时、定时、超时、io等待、动态添加任务</a></li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2016/11/28/1622-python-time/" data-id="cklzzbo9q001q3wqobygq5ouk" data-title="python 延时及超时" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/timeout/" rel="tag">timeout</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/Blog/page/9/">&laquo; Prev</a><a class="page-number" href="/Blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/Blog/page/8/">8</a><a class="page-number" href="/Blog/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/Blog/page/11/">11</a><a class="page-number" href="/Blog/page/12/">12</a><a class="page-number" href="/Blog/page/13/">13</a><a class="extend next" rel="next" href="/Blog/page/11/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/dao/">dao</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/embedded/">embedded</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/embedded-linux/">embedded linux</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/interview/">interview</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/qqiot/">qqiot</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/software/">software</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/thoughts/">thoughts</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/windows/">windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/AI-IoT-thoughts/" rel="tag">AI IoT thoughts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/AutoHotKey/" rel="tag">AutoHotKey</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/BLE/" rel="tag">BLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ConEmu/" rel="tag">ConEmu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Hyper-V/" rel="tag">Hyper-V</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Listary/" rel="tag">Listary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/NAS/" rel="tag">NAS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/NFS/" rel="tag">NFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Notepad/" rel="tag">Notepad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/TrueSTUIDO/" rel="tag">TrueSTUIDO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Typora/" rel="tag">Typora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/apt/" rel="tag">apt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/atom/" rel="tag">atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ble/" rel="tag">ble</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/c/" rel="tag">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cheat-sheet/" rel="tag">cheat sheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cli/" rel="tag">cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/collections/" rel="tag">collections</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/command/" rel="tag">command</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cygwin/" rel="tag">cygwin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/dao/" rel="tag">dao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/data-struct/" rel="tag">data struct</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/debug/" rel="tag">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/dict/" rel="tag">dict</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/driver/" rel="tag">driver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/drv/" rel="tag">drv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/eclipse/" rel="tag">eclipse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/embedded/" rel="tag">embedded</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/embedded-linux/" rel="tag">embedded linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/env/" rel="tag">env</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/environment/" rel="tag">environment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ezos/" rel="tag">ezos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/freefilesync/" rel="tag">freefilesync</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/fs/" rel="tag">fs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ide/" rel="tag">ide</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/interview/" rel="tag">interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ipc/" rel="tag">ipc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/jz2440/" rel="tag">jz2440</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/kernel/" rel="tag">kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/linuxembedded-linux/" rel="tag">linuxembedded linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/list/" rel="tag">list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/makefile/" rel="tag">makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/mingw/" rel="tag">mingw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/nfs/" rel="tag">nfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/notepad/" rel="tag">notepad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/other/" rel="tag">other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/path/" rel="tag">path</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pip/" rel="tag">pip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/process/" rel="tag">process</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/putty/" rel="tag">putty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pygatt/" rel="tag">pygatt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pyinstaller/" rel="tag">pyinstaller</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pyqt/" rel="tag">pyqt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/qqiot/" rel="tag">qqiot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/regular/" rel="tag">regular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/scrum/" rel="tag">scrum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/self-expression/" rel="tag">self-expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/set/" rel="tag">set</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/shortcut/" rel="tag">shortcut</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/software/" rel="tag">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/stm32/" rel="tag">stm32</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/string/" rel="tag">string</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/thoughts/" rel="tag">thoughts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/timeout/" rel="tag">timeout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/tuple/" rel="tag">tuple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/uboot/" rel="tag">uboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/utf-8/" rel="tag">utf-8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/yocto/" rel="tag">yocto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" rel="tag">线程同步</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/Blog/tags/AI-IoT-thoughts/" style="font-size: 10px;">AI IoT thoughts</a> <a href="/Blog/tags/AutoHotKey/" style="font-size: 10px;">AutoHotKey</a> <a href="/Blog/tags/BLE/" style="font-size: 10.77px;">BLE</a> <a href="/Blog/tags/ConEmu/" style="font-size: 10px;">ConEmu</a> <a href="/Blog/tags/Hyper-V/" style="font-size: 10px;">Hyper-V</a> <a href="/Blog/tags/Listary/" style="font-size: 10px;">Listary</a> <a href="/Blog/tags/NAS/" style="font-size: 10px;">NAS</a> <a href="/Blog/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/Blog/tags/Notepad/" style="font-size: 10px;">Notepad++</a> <a href="/Blog/tags/TrueSTUIDO/" style="font-size: 10px;">TrueSTUIDO</a> <a href="/Blog/tags/Typora/" style="font-size: 10px;">Typora</a> <a href="/Blog/tags/android/" style="font-size: 10px;">android</a> <a href="/Blog/tags/apt/" style="font-size: 10px;">apt</a> <a href="/Blog/tags/atom/" style="font-size: 11.54px;">atom</a> <a href="/Blog/tags/ble/" style="font-size: 10px;">ble</a> <a href="/Blog/tags/c/" style="font-size: 10.77px;">c</a> <a href="/Blog/tags/cheat-sheet/" style="font-size: 12.31px;">cheat sheet</a> <a href="/Blog/tags/cli/" style="font-size: 10px;">cli</a> <a href="/Blog/tags/collections/" style="font-size: 10px;">collections</a> <a href="/Blog/tags/command/" style="font-size: 11.54px;">command</a> <a href="/Blog/tags/cygwin/" style="font-size: 10px;">cygwin</a> <a href="/Blog/tags/dao/" style="font-size: 10.77px;">dao</a> <a href="/Blog/tags/data-struct/" style="font-size: 10px;">data struct</a> <a href="/Blog/tags/debug/" style="font-size: 10.77px;">debug</a> <a href="/Blog/tags/dict/" style="font-size: 10px;">dict</a> <a href="/Blog/tags/docker/" style="font-size: 10px;">docker</a> <a href="/Blog/tags/driver/" style="font-size: 16.92px;">driver</a> <a href="/Blog/tags/drv/" style="font-size: 14.62px;">drv</a> <a href="/Blog/tags/eclipse/" style="font-size: 10.77px;">eclipse</a> <a href="/Blog/tags/embedded/" style="font-size: 13.85px;">embedded</a> <a href="/Blog/tags/embedded-linux/" style="font-size: 20px;">embedded linux</a> <a href="/Blog/tags/env/" style="font-size: 10px;">env</a> <a href="/Blog/tags/environment/" style="font-size: 13.85px;">environment</a> <a href="/Blog/tags/error/" style="font-size: 10px;">error</a> <a href="/Blog/tags/ezos/" style="font-size: 10px;">ezos</a> <a href="/Blog/tags/freefilesync/" style="font-size: 10px;">freefilesync</a> <a href="/Blog/tags/fs/" style="font-size: 10.77px;">fs</a> <a href="/Blog/tags/git/" style="font-size: 10px;">git</a> <a href="/Blog/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/Blog/tags/ide/" style="font-size: 10px;">ide</a> <a href="/Blog/tags/interview/" style="font-size: 11.54px;">interview</a> <a href="/Blog/tags/ipc/" style="font-size: 10.77px;">ipc</a> <a href="/Blog/tags/jz2440/" style="font-size: 13.08px;">jz2440</a> <a href="/Blog/tags/kernel/" style="font-size: 11.54px;">kernel</a> <a href="/Blog/tags/linux/" style="font-size: 19.23px;">linux</a> <a href="/Blog/tags/linuxembedded-linux/" style="font-size: 16.15px;">linuxembedded linux</a> <a href="/Blog/tags/list/" style="font-size: 10px;">list</a> <a href="/Blog/tags/makefile/" style="font-size: 10px;">makefile</a> <a href="/Blog/tags/mingw/" style="font-size: 11.54px;">mingw</a> <a href="/Blog/tags/nfs/" style="font-size: 10px;">nfs</a> <a href="/Blog/tags/notepad/" style="font-size: 10px;">notepad++</a> <a href="/Blog/tags/other/" style="font-size: 10px;">other</a> <a href="/Blog/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/Blog/tags/path/" style="font-size: 10px;">path</a> <a href="/Blog/tags/pip/" style="font-size: 10px;">pip</a> <a href="/Blog/tags/process/" style="font-size: 10px;">process</a> <a href="/Blog/tags/putty/" style="font-size: 10px;">putty</a> <a href="/Blog/tags/pygatt/" style="font-size: 10px;">pygatt</a> <a href="/Blog/tags/pyinstaller/" style="font-size: 10px;">pyinstaller</a> <a href="/Blog/tags/pyqt/" style="font-size: 10.77px;">pyqt</a> <a href="/Blog/tags/python/" style="font-size: 18.46px;">python</a> <a href="/Blog/tags/qqiot/" style="font-size: 12.31px;">qqiot</a> <a href="/Blog/tags/regular/" style="font-size: 11.54px;">regular</a> <a href="/Blog/tags/scrum/" style="font-size: 10px;">scrum</a> <a href="/Blog/tags/self-expression/" style="font-size: 10px;">self-expression</a> <a href="/Blog/tags/set/" style="font-size: 10px;">set</a> <a href="/Blog/tags/shell/" style="font-size: 10px;">shell</a> <a href="/Blog/tags/shortcut/" style="font-size: 10px;">shortcut</a> <a href="/Blog/tags/software/" style="font-size: 11.54px;">software</a> <a href="/Blog/tags/stm32/" style="font-size: 10px;">stm32</a> <a href="/Blog/tags/string/" style="font-size: 10px;">string</a> <a href="/Blog/tags/thoughts/" style="font-size: 17.69px;">thoughts</a> <a href="/Blog/tags/timeout/" style="font-size: 10px;">timeout</a> <a href="/Blog/tags/tuple/" style="font-size: 10px;">tuple</a> <a href="/Blog/tags/uboot/" style="font-size: 12.31px;">uboot</a> <a href="/Blog/tags/utf-8/" style="font-size: 10px;">utf-8</a> <a href="/Blog/tags/vim/" style="font-size: 10px;">vim</a> <a href="/Blog/tags/windows/" style="font-size: 15.38px;">windows</a> <a href="/Blog/tags/yocto/" style="font-size: 10px;">yocto</a> <a href="/Blog/tags/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" style="font-size: 10px;">线程同步</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/09/">September 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/Blog/2021/03/05/2107-tuibeitu/">推背图, 马前课, 万年歌, 梅花诗</a>
          </li>
        
          <li>
            <a href="/Blog/2021/03/01/2106-dao-doubt/">修道之路-起疑</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/14/2105-dao-outline/">修道之路-总纲</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/13/2104-satori/">修行总领——明心见性</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/09/2102-intermittent/">一张简单图片演示的“甚深佛法”</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 draapho<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/Blog/" class="mobile-nav-link">Home</a>
  
    <a href="/Blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/Blog/js/jquery-3.4.1.min.js"></script>



  
<script src="/Blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/Blog/js/script.js"></script>





  </div>
</body>
</html>