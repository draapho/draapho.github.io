<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>fs之创建文件系统 | DRA&amp;PHO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="总览 嵌入式linux学习目录 fs之Busybox的编译与使用 fs之创建文件系统  本文使用 linux-2.6.22.6 内核, 使用jz2440开发板. 要构建一个最小的linux根文件系统 dev&#x2F;console, linux内核的标准IO接口 dev&#x2F;null, 相当于一个NULL文件 init进程, 即 bin&#x2F;busybox etc&#x2F;inittab 配置文件, (可以省略, bus">
<meta property="og:type" content="article">
<meta property="og:title" content="fs之创建文件系统">
<meta property="og:url" content="https://draapho.github.io/Blog/2017/11/03/1731-fs-build/index.html">
<meta property="og:site_name" content="DRA&amp;PHO">
<meta property="og:description" content="总览 嵌入式linux学习目录 fs之Busybox的编译与使用 fs之创建文件系统  本文使用 linux-2.6.22.6 内核, 使用jz2440开发板. 要构建一个最小的linux根文件系统 dev&#x2F;console, linux内核的标准IO接口 dev&#x2F;null, 相当于一个NULL文件 init进程, 即 bin&#x2F;busybox etc&#x2F;inittab 配置文件, (可以省略, bus">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-11-02T13:00:00.000Z">
<meta property="article:modified_time" content="2017-11-27T03:06:38.000Z">
<meta property="article:author" content="draapho">
<meta property="article:tag" content="embedded linux">
<meta property="article:tag" content="fs">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/Blog/atom.xml" title="DRA&PHO" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/Blog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/Blog/css/style.css">

  
    
<link rel="stylesheet" href="/Blog/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/Blog/" id="logo">DRA&amp;PHO</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/Blog/" id="subtitle">thinking &amp; logging</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/Blog/">Home</a>
        
          <a class="main-nav-link" href="/Blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/Blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://draapho.github.io/Blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-1731-fs-build" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/Blog/2017/11/03/1731-fs-build/" class="article-date">
  <time class="dt-published" datetime="2017-11-02T13:00:00.000Z" itemprop="datePublished">2017-11-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/Blog/categories/embedded-linux/">embedded linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      fs之创建文件系统
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h1><ul>
<li><a href="https://draapho.github.io/2017/11/23/1734-linux-content/">嵌入式linux学习目录</a></li>
<li><a href="https://draapho.github.io/2017/11/02/1730-fs-busybox/">fs之Busybox的编译与使用</a></li>
<li><a href="https://draapho.github.io/2017/11/03/1731-fs-build/">fs之创建文件系统</a></li>
</ul>
<p>本文使用 linux-2.6.22.6 内核, 使用jz2440开发板.</p>
<h1 id="要构建一个最小的linux根文件系统"><a href="#要构建一个最小的linux根文件系统" class="headerlink" title="要构建一个最小的linux根文件系统"></a>要构建一个最小的linux根文件系统</h1><ul>
<li><code>dev/console</code>, linux内核的标准IO接口</li>
<li><code>dev/null</code>, 相当于一个NULL文件</li>
<li>init进程, 即 <code>bin/busybox</code></li>
<li><code>etc/inittab</code> 配置文件, (可以省略, busybox会调用其默认值)</li>
<li>配置文件里指定的应用程序或脚本, 如 <code>/etc/init.d/rcS</code> <code>bin/sh</code></li>
<li>C语言库 <code>lib/</code></li>
</ul>
<p>在 <a href="https://draapho.github.io/2017/11/02/1730-fs-busybox/">fs之Busybox的编译与使用</a> 一文中,<br>已经将busybox安装到指定目录 <code>~/jz2440/fs_first/</code>,<br>接下来, 基于此目录, 继续完善嵌入式linux的最小文件系统</p>
<h2 id="创建-dev-console-dev-null-文件"><a href="#创建-dev-console-dev-null-文件" class="headerlink" title="创建 dev/console dev/null 文件"></a>创建 <code>dev/console</code> <code>dev/null</code> 文件</h2><p><code>dev/console</code> 用于标准输入输出<br><code>dev/null</code> 空设备, 用于丢弃不需要的输出流, 或提供空输入.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd = ~/jz2440/fs_first/</span></span><br><span class="line"></span><br><span class="line">$ ll /dev/console /dev/null</span><br><span class="line"><span class="comment"># 查看现有系统的这两个文件的详情</span></span><br><span class="line">crw------- 1 root root 5, 1 Sep  5 00:01 /dev/console</span><br><span class="line"><span class="comment"># c表示字符设备, 5为主设备号, 1为次设备号</span></span><br><span class="line">crw-rw-rw- 1 root root 1, 3 Sep  5 00:01 /dev/null</span><br><span class="line"><span class="comment"># c表示字符设备, 1为主设备号, 3为次设备号</span></span><br><span class="line"></span><br><span class="line">$ mkdir dev</span><br><span class="line">$ <span class="built_in">cd</span> dev        <span class="comment"># 进入 ~/jz2440/fs_first/dev/ 目录</span></span><br><span class="line"></span><br><span class="line">$ sudo mknod console c 5 1</span><br><span class="line">$ sudo mknod null c 1 3</span><br><span class="line"><span class="comment"># 仿照现有的文件系统内容, 创建 console 和 null 两个节点文件</span></span><br><span class="line"></span><br><span class="line">$ ll            <span class="comment"># pwd=~/jz2440/fs_first/dev/</span></span><br><span class="line">drwxrwxr-x 2 draapho draapho 4096 Nov  3 11:01 ./</span><br><span class="line">drwxrwxr-x 6 draapho draapho 4096 Nov  3 11:00 ../</span><br><span class="line">crw-r--r-- 1 root    root    5, 1 Nov  3 11:00 console</span><br><span class="line">crw-r--r-- 1 root    root    1, 3 Nov  3 11:01 null</span><br><span class="line"></span><br><span class="line"><span class="comment"># 至此, 创建 /dev/console 以及 /dev/null 完成.</span></span><br></pre></td></tr></table></figure>

<h2 id="创建-etc-inittab-文件"><a href="#创建-etc-inittab-文件" class="headerlink" title="创建 etc/inittab 文件"></a>创建 <code>etc/inittab</code> 文件</h2><p><code>etc/inittab</code> 供busybox初始化时调用的配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd = ~/jz2440/fs_first/</span></span><br><span class="line"></span><br><span class="line">$ mkdir etc</span><br><span class="line">$ vim etc/inittab</span><br><span class="line"><span class="comment"># 输入 &quot;console::askfirst:-/bin/sh&quot;, 保存退出</span></span><br><span class="line">$ cat etc/inittab</span><br><span class="line">console::askfirst:-/bin/sh</span><br><span class="line"><span class="comment"># &quot;-/bin/sh&quot; 前面的-, 提示让busybox开启一个账户登陆终端.</span></span><br><span class="line"><span class="comment"># 由源码函数 ash_main() 代码可知当检测到 - 时, 赋值isloginsh = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 至此, 创建 etc/inittab 完成.</span></span><br></pre></td></tr></table></figure>

<h2 id="安装C库"><a href="#安装C库" class="headerlink" title="安装C库"></a>安装C库</h2><p>务必使用 <code>gcc-3.4.5-glibc-2.3.6</code> 这个版本的C库<br>在 <a href="https://draapho.github.io/2017/02/20/1706-linux-ubuntu16/">嵌入式linux环境搭建3-Ubuntu16.04</a> 中,<br>已经将这个库安装到了 <code>/usr/local/</code> 目录下.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/gcc-3.4.5-glibc-2.3.6/arm-linux/lib</span><br><span class="line">$ ll</span><br><span class="line"><span class="comment"># 查看解压后的库文件, 针对 arm-linux的库</span></span><br><span class="line">...</span><br><span class="line">-rwxr-xr-x  1 draapho draapho  112886 Jan 22  2008 ld-2.3.6.so*</span><br><span class="line">lrwxrwxrwx  1 draapho draapho      11 Jan 22  2008 ld-linux.so.2 -&gt; ld-2.3.6.so*</span><br><span class="line">drwxr-xr-x  2 draapho draapho    4096 Jan 22  2008 ldscripts/</span><br><span class="line">-rwxr-xr-x  1 draapho draapho   17586 Jan 22  2008 libanl-2.3.6.so*</span><br><span class="line">-rw-r--r--  1 draapho draapho   13094 Jan 22  2008 libanl.a</span><br><span class="line">lrwxrwxrwx  1 draapho draapho      11 Jan 22  2008 libanl.so -&gt; libanl.so.1*</span><br><span class="line">lrwxrwxrwx  1 draapho draapho      15 Jan 22  2008 libanl.so.1 -&gt; libanl-2.3.6.so*</span><br><span class="line">...</span><br><span class="line"><span class="comment"># &quot;.a&quot; 表示静态库, &quot;.so&quot;表示动态库, 还有很多动态库的软连接.</span></span><br><span class="line"><span class="comment"># 我们只需要拷贝动态库和动态库的软连接即可.</span></span><br><span class="line"></span><br><span class="line">$ mkdir ~/jz2440/fs_first/lib</span><br><span class="line">$ cp *.so* ~/jz2440/fs_first/lib/ -d</span><br><span class="line"><span class="comment"># 拷贝动态库到最小文件系统下面. &quot;-d&quot; 表示只需要拷贝连接. cp指令默认会拷贝连接到的内容.</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> ~/jz2440/fs_first/</span><br><span class="line">$ ll lib</span><br><span class="line"><span class="comment"># 查看一下拷贝结果.</span></span><br><span class="line"><span class="comment"># 至此, 创建 lib/ C库完成.</span></span><br></pre></td></tr></table></figure>

<h1 id="制作并烧录yaffs2映像文件"><a href="#制作并烧录yaffs2映像文件" class="headerlink" title="制作并烧录yaffs2映像文件"></a>制作并烧录yaffs2映像文件</h1><p>直接说结论, 一般文件系统都会放到 nand flash 里,<br>所以会使用 mkyaffs2image 工具将目录文件生成为 yaffs2 格式文件系统,<br>最后烧录进 nand flash 的 root 分区即可.</p>
<p>linux下的大多数工具都需要下载源码再自己编译, 譬如这里的 mkyaffs2image.<br>对于这类软件的安装, 我一般归到环境搭建里面去.<br>可以参考 <a href="https://draapho.github.io/2017/02/20/1706-linux-ubuntu16/">嵌嵌入式linux环境搭建3-Ubuntu16.04</a></p>
<h2 id="flash和文件系统比较"><a href="#flash和文件系统比较" class="headerlink" title="flash和文件系统比较"></a>flash和文件系统比较</h2><ul>
<li>jffs2: Journalling Flash FileSystem V2<ul>
<li>主要用于<strong>NOR FLASH</strong>, 基于MTD驱动层.</li>
<li>缺点是当文件系统已满或接近满时，因为垃圾收集的关系而使jffs2的运行速度大大放慢</li>
<li>jffs不适合用于NAND闪存</li>
</ul>
</li>
<li>yaffs： Yet Another Flash File System<ul>
<li>针对<strong>NAND FLASH</strong>而设计的一种日志型文件系统. 直接提供了API对FLASH进行操作.</li>
<li>与jffs2相比, 减少了数据压缩等功能, 所以速度更快, 挂载时间更短, 内存占用较小.</li>
<li>yaffs 仅支持小页(512 Bytes), yaffs2 可支持大页(2KB)的NAND闪存. yaffs2也优化了性能.</li>
<li>大多数情况, 嵌入式系统推荐使用 yaffs2</li>
</ul>
</li>
<li>Cramfs: Compressed ROM File System<ul>
<li>一种<strong>只读</strong>的压缩文件系统。它也基于MTD驱动程序.</li>
<li>按页单独压缩, 可以随机页访问. 高压缩比, 可节省Flash空间.</li>
<li>速度快，效率高，其只读的特点有利于保护文件系统免受破坏，提高了系统的可靠性.</li>
</ul>
</li>
<li>NOR FLASH vs NAND FLASH</li>
</ul>
<table>
<thead>
<tr>
<th>NOR FLASH</th>
<th>NAND FLASH</th>
</tr>
</thead>
<tbody><tr>
<td>接口时序同SRAM,易使用</td>
<td>地址/数据线复用，数据位较窄</td>
</tr>
<tr>
<td>读取速度较快</td>
<td>读取速度较慢</td>
</tr>
<tr>
<td>擦除速度慢，以64-128KB的块为单位</td>
<td>擦除速度快，以8－32KB的块为单位</td>
</tr>
<tr>
<td>写入速度慢</td>
<td>写入速度快</td>
</tr>
<tr>
<td>随机存取速度较快，支持XIP(eXecute In Place，芯片内执行)，适用于代码存储。在嵌入式系统中，常用于存放引导程序、根文件系统等。</td>
<td>顺序读取速度较快，随机存取速度慢，适用于数据存储(如大容量的多媒体应用)。在嵌入式系统中，常用于存放用户文件系统等。</td>
</tr>
<tr>
<td>单片容量较小，1-32MB</td>
<td>单片容量较大，8-128MB，提高了单元密度</td>
</tr>
<tr>
<td>最大擦写次数10万次</td>
<td>最大擦写次数100万次</td>
</tr>
</tbody></table>
<h2 id="制作yaffs2映像文件"><a href="#制作yaffs2映像文件" class="headerlink" title="制作yaffs2映像文件"></a>制作yaffs2映像文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/jz2440/</span><br><span class="line">$ mkyaffs2image fs_first fs_first.yaffs2</span><br><span class="line"><span class="comment"># 进入文件系统所在的上级目录, 然后制作镜像</span></span><br><span class="line"></span><br><span class="line">$ ll</span><br><span class="line">-rw------- 1 draapho draapho 8750016 Nov  3 12:23 fs_first.yaffs2</span><br><span class="line"><span class="comment"># 查看制作结果</span></span><br></pre></td></tr></table></figure>

<h2 id="烧录yaffs2映像文件"><a href="#烧录yaffs2映像文件" class="headerlink" title="烧录yaffs2映像文件"></a>烧录yaffs2映像文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发板 uboot</span></span><br><span class="line"><span class="comment"># 打开 jz2440 开发板串口终端, 启动时输入空格键, 进入如下菜单</span></span><br><span class="line"><span class="comment">##### 100ask Bootloader for OpenJTAG #####</span></span><br><span class="line">...</span><br><span class="line">[y] Download root_yaffs image</span><br><span class="line">...</span><br><span class="line">Enter your selection: y                     <span class="comment"># 输入k, 烧录 root_yaffs</span></span><br><span class="line">USB host is connected. Waiting a download.  <span class="comment"># 提示连接成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到 Ubuntu 终端, 输入</span></span><br><span class="line"><span class="built_in">cd</span> ~/jz2440/</span><br><span class="line">sudo dnw fs_first.yaffs2                    <span class="comment"># 输入dnw指令, 指明烧录文件</span></span><br><span class="line"><span class="comment"># DNW usb device found!                     # 开始烧录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 开发板重启后, 就能启动终端输入指令操作了.</span></span><br></pre></td></tr></table></figure>

<h1 id="进一步完善linux根文件系统"><a href="#进一步完善linux根文件系统" class="headerlink" title="进一步完善linux根文件系统"></a>进一步完善linux根文件系统</h1><p>上面只是完成了linux文件系统的基础功能.<br>要实现更高级的功能, 我们需要更为复杂全面的文件系统.</p>
<h2 id="创建-proc-文件"><a href="#创建-proc-文件" class="headerlink" title="创建 proc 文件"></a>创建 <code>proc</code> 文件</h2><p>proc目录即process的简写, 可以让ps指令查看linux的进程.<br>知道 <code>/proc</code> 的基本作用和使用方法以后, 我们需要把这些功能整合到文件系统里面.<br>为了循序渐进的说明, 下面展示了三种方法, 常用的就是第三种.</p>
<h3 id="开发板人工实现"><a href="#开发板人工实现" class="headerlink" title="开发板人工实现"></a><del>开发板人工实现</del></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发板终端</span></span><br><span class="line"></span><br><span class="line">$ ps</span><br><span class="line">PID  Uid        VSZ Stat Command</span><br><span class="line">ps: can<span class="string">&#x27;t open &#x27;</span>/proc<span class="string">&#x27;: No such file or directory</span></span><br><span class="line"><span class="string"># 譬如执行ps指令, 就会提示没有找到 /proc 目录</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 我们先手工实现一下</span></span><br><span class="line"><span class="string"># pwd=/</span></span><br><span class="line"><span class="string">$ mkdir proc</span></span><br><span class="line"><span class="string">$ mount -t proc none /proc</span></span><br><span class="line"><span class="string"># 创建 proc 目录, 并挂载到此目录. -t 为指定挂载类型为 proc.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ ps</span></span><br><span class="line"><span class="string">  PID  Uid        VSZ Stat Command</span></span><br><span class="line"><span class="string">    1 0          3088 S   init</span></span><br><span class="line"><span class="string">  ...</span></span><br><span class="line"><span class="string"># 这样, ps指令就能看到进程了.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ cd /proc</span></span><br><span class="line"><span class="string">$ ls</span></span><br><span class="line"><span class="string">1              745            diskstats      locks          sys</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">$ cd 1          # 进入目录1</span></span><br><span class="line"><span class="string">$ ls -l fd      # 查看目录fd (file descriptor)</span></span><br><span class="line"><span class="string">lrwx------    1 0        0              64 Jan  1 00:10 0 -&gt; /dev/console</span></span><br><span class="line"><span class="string">lrwx------    1 0        0              64 Jan  1 00:10 1 -&gt; /dev/console</span></span><br><span class="line"><span class="string">lrwx------    1 0        0              64 Jan  1 00:10 2 -&gt; /dev/console</span></span><br><span class="line"><span class="string"># 可以看到init进程的三个文件描述符, 分别对应了 标准输入, 标准输出, 标准错误.</span></span><br></pre></td></tr></table></figure>


<h3 id="集成到文件系统-直接-mount"><a href="#集成到文件系统-直接-mount" class="headerlink" title="~~集成到文件系统, 直接 mount ~~"></a>~~集成到文件系统, 直接 mount ~~</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux主机, Ubuntu终端</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 proc 文件</span></span><br><span class="line">$ <span class="built_in">cd</span> ~/jz2440/fs_first/</span><br><span class="line">$ mkdir proc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加初始化脚本</span></span><br><span class="line">$ vim etc/inittab</span><br><span class="line"><span class="comment"># 新增一行 &quot;::sysinit:/etc/init.d/rcS&quot; 用作运行脚本</span></span><br><span class="line">$ cat etc/inittab</span><br><span class="line">console::askfirst:-/bin/sh</span><br><span class="line">::sysinit:/etc/init.d/rcS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建脚本, 执行挂载指令</span></span><br><span class="line">$ mkdir etc/init.d</span><br><span class="line">$ vim etc/init.d/rcS</span><br><span class="line"><span class="comment"># 加入脚本语句 &quot;mount -t proc none /proc&quot; 挂载proc目录</span></span><br><span class="line">$ cat etc/init.d/rcS</span><br><span class="line">mount -t proc none /proc</span><br><span class="line">$ chmod +x etc/init.d/rcS</span><br><span class="line"><span class="comment"># 加上可执行的权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样, 嵌入式linux完成启动后, 会运行init进程.</span></span><br><span class="line"><span class="comment"># - init进程运行 /etc/inittab 内的指令</span></span><br><span class="line"><span class="comment"># - 就会运行 /etc/init.d/rcS 脚本</span></span><br><span class="line"><span class="comment"># - 最终运行 mount -t proc none /proc 指令</span></span><br></pre></td></tr></table></figure>

<h3 id="集成到文件系统-使用-mount-a"><a href="#集成到文件系统-使用-mount-a" class="headerlink" title="集成到文件系统, 使用 mount -a"></a>集成到文件系统, 使用 <code>mount -a</code></h3><p>一般的, linux需要mount多个文件, 因此使用更为通用的 <code>mount -a</code> 指令,<br>然后去读取 <code>/etc/fstab</code> 文件内的配置项.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux主机, Ubuntu终端</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 proc 文件, tmp 文件</span></span><br><span class="line">$ <span class="built_in">cd</span> ~/jz2440/fs_first/</span><br><span class="line">$ mkdir proc</span><br><span class="line">$ mkdir tmp         <span class="comment"># 临时文件目录, 顺便一起做掉</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加初始化脚本</span></span><br><span class="line">$ vim etc/inittab</span><br><span class="line"><span class="comment"># 新增一行 &quot;::sysinit:/etc/init.d/rcS&quot; 用作运行脚本</span></span><br><span class="line">$ cat etc/inittab</span><br><span class="line">console::askfirst:-/bin/sh</span><br><span class="line">::sysinit:/etc/init.d/rcS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建脚本, 执行挂载指令</span></span><br><span class="line">$ mkdir etc/init.d</span><br><span class="line">$ vim etc/init.d/rcS</span><br><span class="line"><span class="comment"># 加入脚本语句 &quot;mount -a&quot; 挂载proc目录</span></span><br><span class="line">$ cat etc/init.d/rcS</span><br><span class="line">mount -a</span><br><span class="line">$ chmod +x etc/init.d/rcS</span><br><span class="line"><span class="comment"># 加上可执行的权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建挂载指令的配置文件</span></span><br><span class="line">$ vim etc/fstab</span><br><span class="line"><span class="comment"># 创建 fstab 配置文件, 输入必要的内容, 见cat的结果</span></span><br><span class="line">$ cat etc/fstab</span><br><span class="line"><span class="comment">#dev    dir     type    options         dump    fsck</span></span><br><span class="line">proc    /proc   proc    defaults        0       0</span><br><span class="line">tmpfs   /tmp    tmpfs   defaults        0       0</span><br><span class="line"><span class="comment"># 这里加载proc, 顺便把临时文件的加载也做了</span></span><br></pre></td></tr></table></figure>

<p>此时. 可以使用 mkyaffs2image 生成镜像文件并烧录, 测试一下.</p>
<h3 id="fstab文件的简单说明"><a href="#fstab文件的简单说明" class="headerlink" title="fstab文件的简单说明"></a>fstab文件的简单说明</h3><ul>
<li>dev, 要挂接的设备<ul>
<li>譬如: <code>/dev/hd2</code> <code>/dev/mtdblock1</code></li>
<li>对于 proc, 直接忽略此字段. 可以是任意值</li>
<li>对于NFS文件系统, 此字段为 <code>&lt;host&gt;:&lt;dir&gt;</code></li>
</ul>
</li>
<li>mount-point, 挂载点, 即一个目录文件</li>
<li>type, 文件系统类型<ul>
<li>如 jffs, yaffs, ext2, nfs</li>
<li>也可以是auto, 对DVD, usb等设备会非常有用</li>
<li>proc, tmpfs 等是特殊的文件类型, 都有特定功能.</li>
</ul>
</li>
<li>options, 挂接参数.<ul>
<li>一般用 defaults 就行</li>
<li>参考<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Fstab_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">fstab (简体中文)</a></li>
</ul>
</li>
<li>dump和fsck, 文件系统的备份和检查<ul>
<li>嵌入式系统一般都禁用, 设置为0</li>
</ul>
</li>
</ul>
<h2 id="使用-mdev-自动生成文件"><a href="#使用-mdev-自动生成文件" class="headerlink" title="使用 mdev 自动生成文件"></a>使用 mdev 自动生成文件</h2><p>udev是Linux的设备管理器。它主要的功能是管理/dev目录底下的设备节点<br>busybox提供了udev的简化版本mdev, 其作用是在系统启动或动态加载驱动时, 自动生成节点文件.</p>
<p>在busybox源码里, 可以找到 <code>busybox-1.7.0\docs\mdev.txt</code>. 关键步骤如下:</p>
<ul>
<li><code>mount -t sysfs sysfs /sys</code></li>
<li><code>echo /bin/mdev &gt; /proc/sys/kernel/hotplug</code></li>
<li><code>mdev -s</code></li>
<li><code>mount -t tmpfs mdev /dev</code></li>
<li><code>mkdir /dev/pts</code></li>
<li><code>mount -t devpts devpts /dev/pts</code></li>
</ul>
<p>由于我们使用的是 <code>mount -a</code>, 因此具体步骤稍有修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux主机, Ubuntu终端</span></span><br><span class="line"><span class="comment"># pwd = ~/jz2440/fs_first/</span></span><br><span class="line"></span><br><span class="line">$ mkdir sys</span><br><span class="line">$ vim etc/fstab</span><br><span class="line"><span class="comment"># 修改fstab, 按要求增加 /sys /dev.</span></span><br><span class="line">$ cat etc/fstab</span><br><span class="line"><span class="comment">#dev    dir     type    options         dump    fsck</span></span><br><span class="line">proc    /proc   proc    defaults        0       0</span><br><span class="line">tmpfs   /tmp    tmpfs   defaults        0       0</span><br><span class="line">sysfs   /sys    sysfs   defaults        0       0</span><br><span class="line">tmpfs   /dev    tmpfs   defaults        0       0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加初始化指令到 etc/init.d/rcS</span></span><br><span class="line">$ vim etc/init.d/rcS</span><br><span class="line"><span class="comment"># 修改rcS, mdev的要求增加指令</span></span><br><span class="line">$ cat etc/init.d/rcS</span><br><span class="line">mount -a</span><br><span class="line">mkdir /dev/pts</span><br><span class="line">mount -t devpts devpts /dev/pts</span><br><span class="line"><span class="built_in">echo</span> /sbin/mdev &gt; /proc/sys/kernel/hotplug</span><br><span class="line">mdev -s</span><br><span class="line"><span class="comment"># 不存在 /bin/mdev, busybox实际把它放在了 /sbin/mdev 下面.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样, 嵌入式linux完成启动后, 会运行init进程.</span></span><br><span class="line"><span class="comment"># - init进程运行 /etc/inittab 内的指令</span></span><br><span class="line"><span class="comment"># - 然后调用 /etc/init.d/rcS 脚本</span></span><br><span class="line"><span class="comment"># - 依次执行rcS脚本内的指令, </span></span><br><span class="line"><span class="comment"># - 执行&quot;mount -a&quot;时, 会根据 /etc/fstab 的配置挂载文件系统.</span></span><br></pre></td></tr></table></figure>

<p>完成烧录后, 使用 <code>ls /dev</code>, 就会看到自动生成了非常多的设备文件.<br>至此, 一个最小linux文件系统制作完成了.</p>
<h1 id="制作-jffs2-映像文件"><a href="#制作-jffs2-映像文件" class="headerlink" title="制作 jffs2 映像文件"></a>制作 jffs2 映像文件</h1><p>jffs2 是一个压缩的文件系统, 所以体积几乎比yaffs2小一半.<br>多用于 NOR FLASH</p>
<h2 id="生成-jffs2-工具"><a href="#生成-jffs2-工具" class="headerlink" title="生成 jffs2 工具"></a>生成 jffs2 工具</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mtd-utils-05.07.23.tar.bz2 可生成jffs2工具</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先需要压缩库zlib-1.2.3的支持</span></span><br><span class="line">$ tar xzf zlib-1.2.3.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> zlib-1.2.3</span><br><span class="line">$ ./configure --shared --prefix=/usr </span><br><span class="line"><span class="comment"># 配置为动态库, 放入/usr目录下</span></span><br><span class="line">$ make</span><br><span class="line">$ sudo make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后编译 mkfs.jffs2</span></span><br><span class="line">$ tar xjf mtd-utils-05.07.23.tar.bz2</span><br><span class="line">$ <span class="built_in">cd</span> mtd-utils-05.07.23/util</span><br><span class="line">$ make</span><br><span class="line">$ sudo make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试一下是否装好了</span></span><br><span class="line">$ mkfs.jffs</span><br></pre></td></tr></table></figure>

<h2 id="制作-jffs2-映像文件-1"><a href="#制作-jffs2-映像文件-1" class="headerlink" title="制作 jffs2 映像文件"></a>制作 jffs2 映像文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/jz2440/</span><br><span class="line">$ mkfs.jffs -n -s 2048 -e 128KiB -d fs_first -o fs_first.jffs2</span><br><span class="line"><span class="comment"># -n            不要再每个擦除块上都加上清除标记</span></span><br><span class="line"><span class="comment"># -s 2048       指定Flash页大小</span></span><br><span class="line"><span class="comment"># -e 128KiB     指定Flash块大小(最小擦除单位)</span></span><br><span class="line"><span class="comment"># -d fs_first   文件系统目录</span></span><br><span class="line"><span class="comment"># -0 fs_first.jffs2 目标文件</span></span><br></pre></td></tr></table></figure>

<p>至此, jffs2 格式的映像文件制作完成.</p>
<h2 id="烧录-jffs2-映像文件"><a href="#烧录-jffs2-映像文件" class="headerlink" title="烧录 jffs2 映像文件"></a>烧录 jffs2 映像文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开发板 uboot</span></span><br><span class="line"><span class="comment"># 打开 jz2440 开发板串口终端, 启动时输入空格键, 进入如下菜单</span></span><br><span class="line"><span class="comment">##### 100ask Bootloader for OpenJTAG #####</span></span><br><span class="line">...</span><br><span class="line">[j] Download root_jffs2 image</span><br><span class="line">...</span><br><span class="line">Enter your selection: j                     <span class="comment"># 输入k, 烧录 root_jffs2</span></span><br><span class="line">USB host is connected. Waiting a download.  <span class="comment"># 提示连接成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到 Ubuntu 终端, 输入</span></span><br><span class="line"><span class="built_in">cd</span> ~/jz2440/</span><br><span class="line">sudo dnw fs_first.yaffs2                    <span class="comment"># 输入dnw指令, 指明烧录文件</span></span><br><span class="line"><span class="comment"># DNW usb device found!                     # 开始烧录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到, 开发板 uboot, q退出菜单进入命令行模式</span></span><br><span class="line"><span class="comment"># 由于linux会自动识别为yaffs2格式, 因此还需要设置一下uboot环境变量, 指定文件系统的类型.</span></span><br><span class="line">$ <span class="built_in">set</span> bootargs noinitrd console=ttySAC0 root=/dev/mtdblock3 rootfstype=jffs2 init=/linuxrc</span><br><span class="line">$ saveenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开发板重启后, 就能启动终端输入指令操作了.</span></span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/zelos/archive/2011/03/27/1996766.html">嵌入式系统文件系统比较 jffs2, yaffs, cramfs, romfs, ramdisk, ramfs/tmpfs （转）</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/daofengdeba/article/details/7721340">Cramfs、JFFS2、YAFFS2的全面对比</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Fstab_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">fstab (简体中文)</a></li>
</ul>
<hr>
<p><em><strong>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://draapho.github.io/Blog/2017/11/03/1731-fs-build/" data-id="cklzxufin005em8qod19e7eeg" data-title="fs之创建文件系统" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/embedded-linux/" rel="tag">embedded linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Blog/tags/fs/" rel="tag">fs</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/Blog/2017/11/13/1732-python-pip/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Python2和Python3共存时, pip的使用
        
      </div>
    </a>
  
  
    <a href="/Blog/2017/11/02/1730-fs-busybox/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">fs之BusyBox的使用与编译</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/dao/">dao</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/embedded/">embedded</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/embedded-linux/">embedded linux</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/interview/">interview</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/qqiot/">qqiot</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/software/">software</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/thoughts/">thoughts</a></li><li class="category-list-item"><a class="category-list-link" href="/Blog/categories/windows/">windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/AI-IoT-thoughts/" rel="tag">AI IoT thoughts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/AutoHotKey/" rel="tag">AutoHotKey</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/BLE/" rel="tag">BLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ConEmu/" rel="tag">ConEmu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Hyper-V/" rel="tag">Hyper-V</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Listary/" rel="tag">Listary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/NAS/" rel="tag">NAS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/NFS/" rel="tag">NFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Notepad/" rel="tag">Notepad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/TrueSTUIDO/" rel="tag">TrueSTUIDO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/Typora/" rel="tag">Typora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/apt/" rel="tag">apt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/atom/" rel="tag">atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ble/" rel="tag">ble</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/c/" rel="tag">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cheat-sheet/" rel="tag">cheat sheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cli/" rel="tag">cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/collections/" rel="tag">collections</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/command/" rel="tag">command</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/cygwin/" rel="tag">cygwin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/dao/" rel="tag">dao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/data-struct/" rel="tag">data struct</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/debug/" rel="tag">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/dict/" rel="tag">dict</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/driver/" rel="tag">driver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/drv/" rel="tag">drv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/eclipse/" rel="tag">eclipse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/embedded/" rel="tag">embedded</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/embedded-linux/" rel="tag">embedded linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/env/" rel="tag">env</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/environment/" rel="tag">environment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ezos/" rel="tag">ezos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/freefilesync/" rel="tag">freefilesync</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/fs/" rel="tag">fs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ide/" rel="tag">ide</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/interview/" rel="tag">interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/ipc/" rel="tag">ipc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/jz2440/" rel="tag">jz2440</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/kernel/" rel="tag">kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/linuxembedded-linux/" rel="tag">linuxembedded linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/list/" rel="tag">list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/makefile/" rel="tag">makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/mingw/" rel="tag">mingw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/nfs/" rel="tag">nfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/notepad/" rel="tag">notepad++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/other/" rel="tag">other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/path/" rel="tag">path</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pip/" rel="tag">pip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/process/" rel="tag">process</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/putty/" rel="tag">putty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pygatt/" rel="tag">pygatt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pyinstaller/" rel="tag">pyinstaller</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/pyqt/" rel="tag">pyqt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/qqiot/" rel="tag">qqiot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/regular/" rel="tag">regular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/scrum/" rel="tag">scrum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/self-expression/" rel="tag">self-expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/set/" rel="tag">set</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/shortcut/" rel="tag">shortcut</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/software/" rel="tag">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/stm32/" rel="tag">stm32</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/string/" rel="tag">string</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/thoughts/" rel="tag">thoughts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/timeout/" rel="tag">timeout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/tuple/" rel="tag">tuple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/uboot/" rel="tag">uboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/utf-8/" rel="tag">utf-8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/yocto/" rel="tag">yocto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Blog/tags/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" rel="tag">线程同步</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/Blog/tags/AI-IoT-thoughts/" style="font-size: 10px;">AI IoT thoughts</a> <a href="/Blog/tags/AutoHotKey/" style="font-size: 10px;">AutoHotKey</a> <a href="/Blog/tags/BLE/" style="font-size: 10.77px;">BLE</a> <a href="/Blog/tags/ConEmu/" style="font-size: 10px;">ConEmu</a> <a href="/Blog/tags/Hyper-V/" style="font-size: 10px;">Hyper-V</a> <a href="/Blog/tags/Listary/" style="font-size: 10px;">Listary</a> <a href="/Blog/tags/NAS/" style="font-size: 10px;">NAS</a> <a href="/Blog/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/Blog/tags/Notepad/" style="font-size: 10px;">Notepad++</a> <a href="/Blog/tags/TrueSTUIDO/" style="font-size: 10px;">TrueSTUIDO</a> <a href="/Blog/tags/Typora/" style="font-size: 10px;">Typora</a> <a href="/Blog/tags/android/" style="font-size: 10px;">android</a> <a href="/Blog/tags/apt/" style="font-size: 10px;">apt</a> <a href="/Blog/tags/atom/" style="font-size: 11.54px;">atom</a> <a href="/Blog/tags/ble/" style="font-size: 10px;">ble</a> <a href="/Blog/tags/c/" style="font-size: 10.77px;">c</a> <a href="/Blog/tags/cheat-sheet/" style="font-size: 12.31px;">cheat sheet</a> <a href="/Blog/tags/cli/" style="font-size: 10px;">cli</a> <a href="/Blog/tags/collections/" style="font-size: 10px;">collections</a> <a href="/Blog/tags/command/" style="font-size: 11.54px;">command</a> <a href="/Blog/tags/cygwin/" style="font-size: 10px;">cygwin</a> <a href="/Blog/tags/dao/" style="font-size: 10.77px;">dao</a> <a href="/Blog/tags/data-struct/" style="font-size: 10px;">data struct</a> <a href="/Blog/tags/debug/" style="font-size: 10.77px;">debug</a> <a href="/Blog/tags/dict/" style="font-size: 10px;">dict</a> <a href="/Blog/tags/docker/" style="font-size: 10px;">docker</a> <a href="/Blog/tags/driver/" style="font-size: 16.92px;">driver</a> <a href="/Blog/tags/drv/" style="font-size: 14.62px;">drv</a> <a href="/Blog/tags/eclipse/" style="font-size: 10.77px;">eclipse</a> <a href="/Blog/tags/embedded/" style="font-size: 13.85px;">embedded</a> <a href="/Blog/tags/embedded-linux/" style="font-size: 20px;">embedded linux</a> <a href="/Blog/tags/env/" style="font-size: 10px;">env</a> <a href="/Blog/tags/environment/" style="font-size: 13.85px;">environment</a> <a href="/Blog/tags/error/" style="font-size: 10px;">error</a> <a href="/Blog/tags/ezos/" style="font-size: 10px;">ezos</a> <a href="/Blog/tags/freefilesync/" style="font-size: 10px;">freefilesync</a> <a href="/Blog/tags/fs/" style="font-size: 10.77px;">fs</a> <a href="/Blog/tags/git/" style="font-size: 10px;">git</a> <a href="/Blog/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/Blog/tags/ide/" style="font-size: 10px;">ide</a> <a href="/Blog/tags/interview/" style="font-size: 11.54px;">interview</a> <a href="/Blog/tags/ipc/" style="font-size: 10.77px;">ipc</a> <a href="/Blog/tags/jz2440/" style="font-size: 13.08px;">jz2440</a> <a href="/Blog/tags/kernel/" style="font-size: 11.54px;">kernel</a> <a href="/Blog/tags/linux/" style="font-size: 19.23px;">linux</a> <a href="/Blog/tags/linuxembedded-linux/" style="font-size: 16.15px;">linuxembedded linux</a> <a href="/Blog/tags/list/" style="font-size: 10px;">list</a> <a href="/Blog/tags/makefile/" style="font-size: 10px;">makefile</a> <a href="/Blog/tags/mingw/" style="font-size: 11.54px;">mingw</a> <a href="/Blog/tags/nfs/" style="font-size: 10px;">nfs</a> <a href="/Blog/tags/notepad/" style="font-size: 10px;">notepad++</a> <a href="/Blog/tags/other/" style="font-size: 10px;">other</a> <a href="/Blog/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/Blog/tags/path/" style="font-size: 10px;">path</a> <a href="/Blog/tags/pip/" style="font-size: 10px;">pip</a> <a href="/Blog/tags/process/" style="font-size: 10px;">process</a> <a href="/Blog/tags/putty/" style="font-size: 10px;">putty</a> <a href="/Blog/tags/pygatt/" style="font-size: 10px;">pygatt</a> <a href="/Blog/tags/pyinstaller/" style="font-size: 10px;">pyinstaller</a> <a href="/Blog/tags/pyqt/" style="font-size: 10.77px;">pyqt</a> <a href="/Blog/tags/python/" style="font-size: 18.46px;">python</a> <a href="/Blog/tags/qqiot/" style="font-size: 12.31px;">qqiot</a> <a href="/Blog/tags/regular/" style="font-size: 11.54px;">regular</a> <a href="/Blog/tags/scrum/" style="font-size: 10px;">scrum</a> <a href="/Blog/tags/self-expression/" style="font-size: 10px;">self-expression</a> <a href="/Blog/tags/set/" style="font-size: 10px;">set</a> <a href="/Blog/tags/shell/" style="font-size: 10px;">shell</a> <a href="/Blog/tags/shortcut/" style="font-size: 10px;">shortcut</a> <a href="/Blog/tags/software/" style="font-size: 11.54px;">software</a> <a href="/Blog/tags/stm32/" style="font-size: 10px;">stm32</a> <a href="/Blog/tags/string/" style="font-size: 10px;">string</a> <a href="/Blog/tags/thoughts/" style="font-size: 17.69px;">thoughts</a> <a href="/Blog/tags/timeout/" style="font-size: 10px;">timeout</a> <a href="/Blog/tags/tuple/" style="font-size: 10px;">tuple</a> <a href="/Blog/tags/uboot/" style="font-size: 12.31px;">uboot</a> <a href="/Blog/tags/utf-8/" style="font-size: 10px;">utf-8</a> <a href="/Blog/tags/vim/" style="font-size: 10px;">vim</a> <a href="/Blog/tags/windows/" style="font-size: 15.38px;">windows</a> <a href="/Blog/tags/yocto/" style="font-size: 10px;">yocto</a> <a href="/Blog/tags/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" style="font-size: 10px;">线程同步</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/Blog/archives/2016/09/">September 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/Blog/2021/03/05/2107-tuibeitu/">推背图, 马前课, 万年歌, 梅花诗</a>
          </li>
        
          <li>
            <a href="/Blog/2021/03/01/2106-dao-doubt/">修道之路-起疑</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/14/2105-dao-outline/">修道之路-总纲</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/13/2104-satori/">修行总领——明心见性</a>
          </li>
        
          <li>
            <a href="/Blog/2021/02/09/2102-intermittent/">一张简单图片演示的“甚深佛法”</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 draapho<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/Blog/" class="mobile-nav-link">Home</a>
  
    <a href="/Blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/Blog/js/jquery-3.4.1.min.js"></script>



  
<script src="/Blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/Blog/js/script.js"></script>





  </div>
</body>
</html>